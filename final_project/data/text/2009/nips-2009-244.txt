Noise Characterization, Modeling, and Reduction for
In Vivo Neural Recording

Zhi Yang1 , Qi Zhao2 , Edward Keefer3,4 , and Wentai Liu1
1 University of California at Santa Cruz, 2 California Institute of Technology
3 UT Southwestern Medical Center, 4 Plexon Inc
yangzhi@soe.ucsc.edu

Abstract

Studying signal and noise properties of recorded neural data is critical in devel-
oping more efﬁcient algorithms to recover the encoded information. Important
issues exist in this research including the variant spectrum spans of neural spikes
that make it difﬁcult to choose a globally optimal bandpass ﬁlter. Also, multiple
sources produce aggregated noise that deviates from the conventional white Gaus-
sian noise. In this work, the spectrum variability of spikes is addressed, based on
which the concept of adaptive bandpass ﬁlter that ﬁts the spectrum of individual
spikes is proposed. Multiple noise sources have been studied through analytical
models as well as empirical measurements. The dominant noise source is identi-
ﬁed as neuron noise followed by interface noise of the electrode. This suggests
that major efforts to reduce noise from electronics are not well spent. The mea-
sured noise from in vivo experiments shows a family of 1/f x spectrum that can
be reduced using noise shaping techniques. In summary, the methods of adaptive
bandpass ﬁltering and noise shaping together result in several dB signal-to-noise
ratio (SNR) enhancement.

1 Introduction

Neurons in the brain communicate through the ﬁring of action potentials. This process induces brief
“voltage” spikes in the surrounding environment that can be recorded by electrodes. The recorded
neural signal may come from single, or multiple neurons. While single neurons only require a
detection algorithm to identify the ﬁrings, multiple neurons require the separation of superimposed
activities to obtain individual neuron ﬁrings. This procedure, also known as spike sorting, is more
complex than what is required for single neurons.
Spike sorting has acquired general attention. Many algorithms have been reported in the litera-
ture [1–7], with each claiming an improved performance based on different data. Comparisons
among different algorithms can be subjective and difﬁcult. For example, benchmarks of in vivo
recordings that thoroughly evaluate the performance of algorithms are unavailable. Also, syn-
thesized sequences with benchmarks obtained through neuron models [8], isolated single neuron
recordings [2], or simultaneous intra- and extra- cellular recordings [9] lack the in vivo recording
environment. As a result, synthesized data provide useful but limited feedback on algorithms.
This paper discusses a noise study, based on which SNR enhancement techniques are proposed.
These techniques are applicable to an unspeciﬁed spike sorting algorithm. Speciﬁcally, a proce-
dure of online estimating both individual spike and noise spectrum is ﬁrst applied. Based on the
estimation, a bandpass ﬁlter that ﬁts the spectrum of the underlying spike is selected. This max-
imally reduces the broad band noise without sacriﬁcing the signal integrity. In addition, a com-
prehensive study of multiple noise sources are performed through lumped circuit model as well
as measurements. Experiments suggest that the dominant noise is not from recording electronics,

1

Figure 1: Block diagram of the proposed noise reduction procedures.

thus de-emphasize the importance of low noise hardware design. More importantly, the measured
noise generally shows a family of 1/f x spectrum, which can be reduced by using noise shaping
techniques [10, 11]. Figure 1 shows the proposed noise reduction procedures.
The rest of this paper is organized as follows. Section 2 focuses on noise sources. Section 3 gives
a Wiener kernel based adaptive bandpass ﬁlter. Section 4 describes a noise shaping technique that
uses fractional order differentiation. Section 5 reports experiment results. Section 6 gives concluding
remarks.

2 Noise Spectrum and Noise Model

Recorded neural spikes are superimposed with noise that exhibit non-Gaussian characteristics and
can be approximated as 1/f x noise. The frequency dependency of noise is contributed by multi-
ple sources. Identiﬁed noise sources include 1/f α−neuron noise [12–14] (notations of 1/f x and
1/f α represent frequency dependencies of the total noise and neuron noise respectively), electrode-
electrolyte interface noise [15], tissue thermal noise, and electronic noise, which are illustrated in
Figure 2 using a lumped circuit model. Except electrolyte bulk noise (4kT Rb in Figure 2) that has
a ﬂattened spectrum, the rest show frequency dependency. Speciﬁcally, 1/f α−neuron noise is in-
duced from distant neurons [12–14]. Numeric simulations based on simpliﬁed neuron models [12]
suggest that α can vary a wide range depending on the parameters. For the electrode-electrolyte
interface noise, non-faradaic type in particular, an effective resistance (Ree ) is deﬁned for model-
ing purposes. Ree generates noise that is attenuated quadratically to frequency in high frequency
region by the interface capacitance (Cee ). Electronic noise consists of two major components: ther-
mal noise (∼ kT /gm [16]) and ﬂicker noise (or 1/f noise [16]). Flicker noise dominates at lower
frequency range and is fabrication process dependent. Next, we will address the noise model that
will later be used to develop noise removal techniques in Section 3 and Section 4, and veriﬁed by
experiment results in section 5.
2.1 1/f α−Neuron Noise

Vneu =

Background spiking activities of the vast distant neurons (e.g. spike, synaptic release [17–19])
(cid:88)
(cid:88)
overlap the spectrum of the recorded spike signal. They usually have small magnitudes and are
noisily aggregated. Analytically, the background activities are described as
vi.neu (t − ti,k ),
i
k
where Vneu represents the superimposed background activities of distant neurons; i and ti,k repre-
sent the object identiﬁcation and its activation time respectively, and vi.neu is the spiking activity
(cid:88)
(cid:88)
template of the ith object. Based on Eq. 1, the power spectrum of Vneu is
|Xi (f )|2 fi
P {Vneu } =
< e2πj f (ti,k1+k−ti,k1 ) >,
2
i
k
where < > represents the average over the ensemble and over k1 , P {} is the spectrum operation,
Xi (f ) is the fourier transform of vi.neu , and fi is the frequency of spiking activity vi.neu (the
number of activations divided by a period of time). The spectrum of a delta function spike pulse

(1)

(2)

2

Figure 2: Noise illustration for extracellular spikes.

(cid:80)
k < e2πj f (tk1+k−tk1 ) >), according to [12], features a lower frequency and exhibits a
train (
1/f α frequency dependency. As this term multiplies |Xi (f )|2 , the unresolved spiking activities of
distant neurons contribute a spectrum of 1/f x within the signal spectrum.

2.2 Electrode Noise

Assume the electrode-electrolyte interface is the non-faradaic type where charges such as electrons
and ions, can not pass across the interface. In a typical in vivo recording environment that involves
several different ionic particles, e.g. Na+, K+, ..., the current ﬂux of any ith charged particle Ji (x)
at location x assuming spatial concentration ni (x) is described by Nernst equation
Dini∇Φ(x),
Ji (x) = −Di∇ni (x) + ni (x)υ − zi q
(3)
kT
where Di is the diffusion coefﬁcient, Φ electrical potential, zi charge of the particle, q the charge of
one electron, k the Boltzmann constant, T the temperature, and υ the convection coefﬁcient. In a
steady state, Ji (x) is zero with the boundary condition of maintaining about 1V voltage drop from
metal to electrolyte. In such a case, the electrode interface can be modeled as a lumped resistor Ree
in parallel with a lumped capacitor Cee . This naturally forms a lowpass ﬁlter for the interface noise.
As a result, the induced noise from Ree at the input of the ampliﬁer is
4kT
1
4kT
(Ree ||jωCee ||(Rb + jωCi ))2 =
|
Ne.e =
)
1/Ree + jωCee + 1/(Rb + 1
Ree
Ree
jωCi
(cid:90) fc2
(cid:90) fc2
Referring to the hypothesis that the ampliﬁer input capacitance (Ci ) is sufﬁciently small, introducing
negligible waveform distortion, the integrated noise by electrode interface satisﬁes
2kT
4kT Ree
Ne.edf ≈
tan−1 2πReeCee f |f =fc2
kT
|1 + 2πj f ReeCee |2 df =
f =fc1 <
Cee
πCee
fc1
fc1
Equation 5 suggests reducing electrode interface noise by increasing double layer capacitance (Cee ).
Without increasing the size of electrodes, carbon-nanotube (CNT) coating [20] can dramatically in-
crease electrode surface area, thus, reducing the interface noise. Section 5 will compare conventional
electrodes and CNT coated electrodes from a noise point of view.
In regions away from the interface boundary, ∇ni (x) = 0 results in a ﬂattened noise spectrum. Here
we use a lumped bulk resistance Rb in series with the double-layer interface for modeling noise
ρtissue
Ne.b = 4kT Rb = 4kT χ
πrs
where Rb is the bulk resistance, ρtissue is the electrolyte resistivity, rs is the radius of the electrode,
and χ is a constant that relates to the electrode geometry. As given in [21], χ ≈ 0.5 for a plate
electrode.

|2 .

(6)

.

(5)

(4)

,

2.3 Electronic Noise

Noise generated by electronics can be predicted by circuit design tools and validated through mea-
surements. At the frequency of interest, there are two major components: thermal noise of transistors
and ﬂicker noise

Nelectronic = Nc.thermal + Nc.f licker = γ

3

4kT
gm

+ K
CoxW L

1
f

,

(7)

where Nc.thermal is the circuit thermal noise, Nc.f licker the ﬂicker noise, gm the transconductance
of the ampliﬁer (∂ iout/∂ vin ), γ a circuit architecture dependent constant on the order of O(1), K
a process-dependent constant on the order of 10−25V 2F [16], Cox the transistor gate capacitance
density, and W and L the transistor width and length respectively.
Given a design schematic, circuit thermal noise can be reduced by increasing transconductance (gm ),
which is to the ﬁrst order linear to bias current thus power consumption. Flicker noise can be reduced
using design techniques such as large size input transistors and chopper modulations [22]. By using
advanced semiconductor technologies, also, power and area trade off to noise [16], and elegant de-
sign techniques like chopper modulation, current feedback [23], the state-of-the-art low noise neural
ampliﬁer can provide less than 2µV total noise [24]. Such design costs can be necessary and useful
if electronics noise contributes signiﬁcantly to the total noise. Otherwise, the over-designed noise
speciﬁcation may be used to trade off other speciﬁcations and potentially result in overall improved
performance of the system. Section 5 will present experiments of evaluating noise contribution from
different sources, which show that electronics are not the dominant noise source in our experiments.

2.4 Total Noise

The noise sources as shown in Figure 2 include unresolved neuron activities (Nneu ), electrode-
electrolyte interface noise (Ne.e ), thermal noise from the electrolyte bulk (Ne.b ) and active circuitry
(Nc.thermal ), and ﬂicker noise (Nc.f licker ). The noise spectrum is empirically ﬁtted by
N (f ) = Nneu + Ne.e + Ne.b + Nc.thermal + Nc.f licker ≈ N1
f x + N0 ,
where N1 /f x and N0 represent the frequency dependent and ﬂat terms, respectively. Equation 8
describes a combination of both colored noise (1/f x ) and broad band noise, which can be reduced
by using noise removal techniques. Section 3 presents an adaptive ﬁltering scheme used to optimally
attenuate the broad band noise. Section 4 presents a noise shaping technique used to improve the
differentiation between signals and noise within the passband.

(8)

3 Adaptive Bandpass Filtering

SNR is calculated by integrating both signal and noise spectrum. Intuitively, a passband, either too
narrow or wide, introduces signal distortion or unwanted noise. Figure 5(b) plots the detected spikes
from one single electrode with different widths and shows the difﬁculty of optimally sizing the
passband. While a passband that only ﬁts one spike template may introduce waveform distortion to
spikes of other templates, a passband that covers every template will introduce more noise to spikes
of every template. A possible solution is to adaptively assign a passband to each spike waveform
such that each span will be just wide enough to cover the underlying waveform. This section presents
the steps used in order to achieve this solution and includes spike detection, spectrum estimation,
and ﬁlter generation.

3.1 Spike Detection

In this work, spike detection is performed using a nonlinear energy operator (NEO) [25] that captures
instantaneous high frequency and high magnitude activities. With a discrete time signal xi , i =
...1, 2, 3..., NEO outputs
i − xi+1xi−1 .
(cid:90)
ψ(xi ) = x2
The usefulness of NEO for spike detection can be explored by taking the expectation of Eq. 9
P (f , i)(1 − cos4πf (cid:52) T )df ,
ψ(xi ) = Rx (0) − Rx (2 (cid:52) T ) ≈
(10)
where Rx is the auto correlation function, (cid:52)T is the sampling interval, and P (f , i) is the estimated
power spectrum density with window centered at sample xi . When the frequency of interest is much
lower than the sampling frequency, 1 − cos2πf τ is approximately 2π2 f 2 τ 2 . This emphasizes the
high frequency power spectrum. Because spikes are high frequency activities by deﬁnition, NEO
outputs a larger score when spikes are present. An example of NEO based spike detection is shown
in Figure 4, where NEO improves the separation between spikes and the background activity.

(9)

4

(a)

(b)

Figure 3: Spike sequence and its corresponding NEO output. (a) Raw sequence of one channel. (b)
The corresponding NEO output of the raw sequence in (a).

3.2 Corner Frequency Estimation

Spectrum estimation of individual spikes is performed to select a corresponding bandpass ﬁlter that
balances the spectrum distortion and noise. Knowing its ability to separate bandlimited signals from
broad band noise, a Weiner ﬁlter [26] is used here to size the signal passband. In the frequency
domain, denoting PXX and PN N as the signal and noise spectra, Weiner ﬁlter is
= SN R(f )
PXX (f )
SN R(f ) + 1 .
PXX (f ) + PN N (f )
Implementing a precise Weiner ﬁlter for each detected spike requires considerable computation, as
(cid:90)
well as a reliable estimation of the signal spectrum. In this work, we are interested in using one of a
series of prepared bandpass ﬁlters Hi (i = 1, 2...n) that better matches the solved “optimal” Weiner
ﬁlter
(cid:82)
|Hi (f ) − W (f )|2df ,

W (f ) =

(11)

(12)

arg min
i
[Hi (f ) − W (f )]df = 0.

subjected to

4 Noise Shaping

The adaptive scheme presented in Section 3 tacitly assigns a matched frequency mask to individual
spikes and balances noise and spectrum integrity. The remaining noise exhibits 1/f x frequency
dependency according to Section 2. In this section, we focus on noise shaping techniques to further
distinguish signal from noise.
The fundamentals of noise shaping are straightforward. Instead of equally amplifying the spectrum,
a noise shaping ﬁlter allocates more weight to high SNR regions while reducing weight at low SNR
regions. This results in an increased ratio of the integrated signal power over the noise power. In
general, there are a variety of noise shaping ﬁlters that can improve the integrated SNR [10]. In this
work, we use a series of fractional derivative operation for noise shaping
D(h(x)) = dph(x)
dxp
where h(x) is a general function, p is a positive number (can be integer or non-integer) that adjusts
the degree of noise shaping; the larger the p, the more emphasis on high frequency spectrum. In Z
∞(cid:88)
∞(cid:88)
domain, the realization of fractional derivative operation can be done using binomial series [27]
(−1)n p(p − 1)...(p − n + 1)
H (z ) = (1 − z−1 )p =
h(n)z−k = 1 − pz−1 +
z−n ,
n!
n=0
n=2
where h(n) are the fractional derivative ﬁlter coefﬁcients that converge to zero.
(cid:82)
(cid:82)
(cid:82)
(cid:82)
The SNR gain in applying a fractional derivative ﬁlter H (f ) is
Ispike (f )|H (f )|2df
− 10log
Inoise (f )|H (f )|2df

Ispike (f )df
Inoise (f )df

SN Rgain = 10log

(13)

(14)

(15)

,

,

5

051015x 105−1.5−1−0.500.511.522.5x 104051015x 105−2−101234x 107(a)

(c)

(b)

(d)

Figure 4: In vivo recording for identifying noise sources. (a) 5-minute recording segment capturing
the decay of background activities. (b) Traces of the estimated noise vs. time are plotted. Black (cid:165)
curve represents the noise recorded from a custom tungsten electrode; red (cid:78) curve represents the
noise recorded from a CNT coated electrodes with the same size. (c), (d) Noise power spectrums es-
timated at the 0, 15, 30, 45 minutes after the drug injection. In (c) a conventional tungsten electrode
is used. In (d), a CNT coated tungsten electrode of equal size is used for comparison.

where Ispike (f ) and Inoise (f ) are power spectrums of spike and noise respectively. Numeric values
of SNR gain depend on both data and p (the degree of noise shaping).
In our experiments, we
empirically choose p in a range of 0.5 to 2.5, where numerically calculated SNR gains using Eq. 15
of in vivo recordings are typically more than 3dB, which is consistent with [10].

5 Experiment

To verify the noise analysis presented in Section 2, an in vivo experiment is performed that uses two
sharp tungsten electrodes separated by 125 µm to record the hippocampus neuronal activities of a
rat. One of the electrodes is coated with carbon-nanotube (CNT), while the other is uncoated. After
the electrodes have been placed, a euthanizing drug is injected. After 5 seconds of drug injection,
the recording of the two electrodes start and last until to the time of death. The noise analysis
results are summarized and presented in Figure 4. In Figure 4(a), a 5-minute segment that captures
the decaying of background activities is plotted. In Figure 4(b), the estimated noise from 600H z to
6KH z for both recording sites are plotted, where noise dramatically reduces (> 80%) after the drug
takes effect. Initially, the CNT electrode records a comparatively larger noise (697µV 2 ) compared
with the uncoated electrode (610µV 2 ). After a few minutes, the background noise recorded by
the CNT electrode quickly reduces eventually reaching 37µV 2 that is about 1/3 of noise recorded
by its counterpart (112µV 2 ), suggesting the noise ﬂoor of using the uncoated tungsten electrode
(112µV 2 ) is set by the electrode. From these two plots, we can estimate that the neuron noise is
around 500 ∼ 600µV 2 , electrode interface noise is ∼ 80µV , while the sum of electronic noise
and electrolyte bulk noise is less than 37µV 2 (only ∼ 5% of the total noise). Figure 4(c) displays
the 1/f x noise spectrum recorded from the uncoated tungsten electrode (x = 1.8, 1.4, 1.0, 0.9,
estimated at 0, 15, 30, 45 minutes after drug injection). Figure 4(d) displays 1/f x noise spectrum
recorded from the CNT coated electrode (x = 2.1, 1.3, 0.9, 0.8, estimated at 0, 15, 30, 45 minutes
after drug injection).

6

012345−2.5−1.2501.252.5Time, unit minuteRecording, unit mV0102030405060101102103Time, unit minuteNoise power, unit (uV)2  Noise measured using conventinal electrodeNoise measured using CNT coated electrode11.522.533.544.555.56−50510152025Frequency (kHz)Power/frequency (dB/Hz)  0 minute15 minute30 minute45 minute11.522.533.544.555.56−50510152025Frequency (kHz)Power/frequency (dB/Hz)  0 minute15 minute30 minute45 minuteTable 1: Statistics of 1/f x noise spectrum from in vivo preparations.
x ≥ 2
1.5 ≤ x < 2
1 ≤ x < 1.5
1/f x
Number of Recordings
38
23
11

x < 1
5

(a)

(b)

(c)

(d)

Figure 5: In vivo experiment of evaluating the proposed adaptive bandpass ﬁlter.
(a) Detected
spikes are aligned and superimposed. (b) Example waveforms that have distinguished widths are
plotted. (c) Feature extraction results using PCA with a global bandpass ﬁlter (400H z to 5KH z )
are displayed. (d) Feature extraction results using PCA with adaptive bandpass ﬁlters are displayed
showing a much improved cluster isolation compared to (c).

In the second experiment, 77 recordings of in vivo preparations are used to explore the stochas-
tic distribution of 1/f x noise spectrum. “x” is averaged at 1.5 with a standard deviation of 0.5
(1/f 1.5±0.5 ). The results are summarized in Table 1.
The third experiment uses an in vivo recording from a behaving cat. This recording is used to
compare the feature extraction results produced by a global bandpass ﬁlter (conventional one) and
the proposed adaptive bandpass ﬁlter, discussed in Section 3. In Figure 5(a), detected spikes are
superimposed, where “a thick waveform bundle” is observed. In Figure 5(b), example waveforms
in Figure 5(a) that have different widths are shown. Clearly, these waveforms have noticeably dif-
ferent spectrum spans. In Figure 5(c), feature extraction results using PCA (a widely used feature
extraction algorithm in spike sorting applications) with a global bandpass ﬁlter are displayed. As
a comparison, feature extraction results using PCA with adaptive bandpass ﬁlters are displayed in
Figure 5(d), where multiple clusters are differentiable in the feature space.
In the fourth experiment, earth mover’s distance (EMD), as a cross-bin similarity measure that is
robust to waveform misalignment [28], is applied to synthesized data for evaluation of the spike
waveform separation before and after noise shaping. Assume VA (i), i = 1, 2..., VB (i), i = 1, 2...
to be the spike waveform bundles from candidate neuron A and B . To estimate the spike variation
of a candidate neuron, two waveforms are randomly picked from a same waveform bundle, and
the distance between them is calculated using EMD. After repeating the procedure many times,
the results are plotted as the black (waveforms from VA ) and blue (waveforms from VA ) traces in
Figure 6. The x-axis indexes the trial and the y -axis is the EMD score. Black/blue traces describe
the intra-cluster waveform variations of the two neurons under testing. To estimate the separation
between candidate neuron A and B , we randomly pick two waveforms, one from VA and the other
from VB , then compute the EMD between them. This procedure is repeated many times and the
EMD vs.
trial index is plotted as the red curve in Figure 6. Four pairs of candidate neurons are
tested and shown in Figure 6(a)-(d). It can be observed from Figure 6 that the red curves are not well
differentiated from the black/blue ones, which indicate that candidate neurons are not well separated.
In Figure 6(e)-(h), we apply a similar procedure on the same four pairs of candidate neurons. The
only difference from plots shown in Figure 6(a)-(d) is that the waveforms after noise shaping are
used rather than their original counterparts. In Figure 6(e)-(h), the red curves separate from the
black/blue traces, suggesting that the noise shaping ﬁlter improves waveform differentiations.
In the ﬁfth experiment, we apply different orders of noise shaping ﬁlters and the same feature extrac-
tion algorithm to evaluate the feature extraction results. The noise shaping technique is developed
as a general tool that can be incorporated into an unspeciﬁed feature extraction algorithm. Here, we
use PCA as an example. In Figure 7, 8 ﬁgures in the same row are results of the same sequence.
Figures from left to right display the feature extraction results with different orders of noise shaping;
from 0 (no noise shaping) to 3.5, and stepped by 0.5. All the tests are obtained after adaptive band-

7

0510152025303540−0.1−0.0500.050.10.150.20.250510152025303540−0.1−0.0500.050.10.150.20.25−0.6−0.5−0.4−0.3−0.2−0.100.10.20.3−0.25−0.2−0.15−0.1−0.0500.050.10.150.20.25−0.5−0.4−0.3−0.2−0.100.10.2−0.35−0.3−0.25−0.2−0.15−0.1−0.0500.050.10.15(a)

(e)

(b)

(f)

(c)

(g)

(d)

(h)

Figure 6: EMD vs. trial index. Black and blue trace: EMDs for intra-cluster waveforms; red trace:
EMDs for inter-cluster waveforms. (a)-(d) and (e)-(h) are results of 4 different pairs of neurons
before and after noise shaping respectively. Traces in (a)-(d) and (e)-(h) have one-to-one correspon-
dence. Noise level increases from (a) to (d).

(a)

(b)

(c)

(d)

(e)

(f)

(g)

(h)

(i)

(j)

(k)

(l)

(m)

(n)

(o)

(p)

Figure 7: Feature extraction results using PCA with different orders of noise shaping. Each row
represents a different sequence. Each column represents a different order of noise shaping (p in
dp f (x)
dxp ), sweeping from 0 (without noise shaping) to 3.5 , stepped by 0.5. (a)-(h) are results of a
synthesized sequence. (i)-(p) are results of an in vivo preparation. Clearly, (f) is better than (a); (m)
is better than (i).

pass ﬁltering. The ﬁrst sequence (a)-(h) is a synthesized one from public data base [2], the second
sequence is recorded from an in vivo preparation. For both sequences, increased numbers of isolated
clusters can be obtained by appropriately choosing the order of the noise shaping ﬁlter.

6 Conclusion

In this paper, a study of multiple noise sources for in vivo neural recording is carried out. The
dominant noise source is identiﬁed to be neuron noise followed by interface noise of the electrode.
Overall, the noise exhibits a family of 1/f x spectrum. The concept of adaptive bandpass ﬁlter is pro-
posed to reduce noise because it maintains the signal spectrum integrity while maximally reducing
the broad band noise. To reduce the noise within the signal passband and improve waveform sepa-
ration, a series of fractional order differentiator based noise shaping ﬁlters are proposed. The pro-
posed noise removal techniques are generally applicable to an unspeciﬁed spike sorting algorithm.
Experiment results from in vivo preparations, synthesized sequences, and comparative recordings
using both conventional and CNT coated electrodes are reported, which verify the noise model and
demonstrate the usefulness of the proposed noise removal techniques.

8

050100150200250300051015202530  IntraCluster1 DistanceIntraCluster2 DistanceInterCluster1to2 Distance050100150200250300024681012141618  IntraCluster1 DistanceIntraCluster2 DistanceInterCluster1to2 Distance0501001502002503000246810121416  IntraCluster1 DistanceIntraCluster2 DistanceInterCluster1to2 Distance050100150200250300024681012  IntraCluster1 DistanceIntraCluster2 DistanceInterCluster1to2 Distance050100150200250300012345678910  IntraCluster1 DistanceIntraCluster2 DistanceInterCluster1to2 Distance050100150200250300012345678910  IntraCluster1 DistanceIntraCluster2 DistanceInterCluster1to2 Distance0501001502002503000123456  IntraCluster1 Distance IntraCluster2 DistanceInterClster1to2 Distance0501001502002503000123456  IntraCluster1 DistanceIntraCluster2 DistanceInterCluster1to2 Distance00.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.9100.20.40.60.8100.10.20.30.40.50.60.70.80.91References
[1] Lewicki MS. A review of methods for spike sorting: the detection and classiﬁcation of neural action
potentials. Network Comput Neural Syst. 1998;9:53–78.
[2] Quian Quiroga R, Nadasdy Z, Ben-Shaul Y. Unsupervised spike detection and sorting with wavelets and
superparamagnetic clustering. Neural Computation. 2004 Aug;16(8):1661–1687.
[3] Bar-Hillel A, Spiro A, Stark E. Spike sorting: Bayesian clustering of non-stationary data. Advances in
Neural Information Processing Systems 17. 2005;p. 105–112.
[4] Zumsteg ZS, Kemere C, O’Driscoll S, Santhanam G, Ahmed RE, Shenoy KV, et al. Power feasibility of
implantable digital spike sorting circuits for neural prosthetic systems. IEEE Trans Neural Syst Rehabil
Eng. 2005 Sep;13(3):272–279.
[5] Vargas-Irwin C, Donoghue JP. Automated spike sorting using density grid contour clustering and sub-
tractive waveform decomposition. J Neurosci Methods. 2007;164(1).
[6] Yang Z, Zhao Q, Liu W. Neural signal classiﬁcation using a simpliﬁed feature set with nonparametric
clustering. Neurocomputing, doi:101016/jneucom200907013, in press;.
[7] Gasthaus J, Wood F, Dilan G, Teh YW. Dependent dirichlet process spike sorting. Advances in Neural
Information Processing Systems 21. 2009;p. 497–504.
[8] Smith LS, Mtetwa N. A tool for synthesizing spike trains with realistic interference. J Neurosci Methods.
2007 Jan;159(1):170–180.
[9] Harris KD, Henze DA, Csicsvari J, Hirase H, Buzsaki G. Accuracy of tetrode spike separation as deter-
mined by simultaneous intracellular and extracellular measurements. J Neurophysiol. 2000;84:401–414.
[10] Yang Z, Zhao Q, Liu W. Spike feature extraction using informative samples. Advances in Neural Infor-
mation Processing Systems 21. 2009;p. 1865–1872.
[11] Yang Z, Zhao Q, Liu W. Improving Spike Separation Using Waveform Derivative. Journal of Neural
Engineering, doi: 101088/1741-2560/6/4/046006. 2009 Aug;6(4).
[12] Davidsen J, Schuster HZ. Simple model for 1/f α noise. Phys Rev Lett 65, 026120(1)-026120(4). 2002;.
[13] Yu Y, Romero R, Lee TS. Preference of sensory neural coding for 1/f signals. Phys Rev Lett 94,
108103(1)-108103(4). 2005;.
[14] Bedard C, Kroger H, Destexhe A. Does the 1/f frequency scaling of brain reﬂect self-organized critical
states? Phys Rev Lett 97, 118102(1)-118102(4). 2006;.
[15] Hassibi A, Navid R, Dutton RW, Lee TH. Comprehensive study of noise processes in electrode electrolyte
interfaces. J Appl Phys. 2004 July;96(2):1074–1082.
[16] Razavi B. Design of Analog CMOS Integrated Circuits. Boston, MA:McGraw-Hill; 2001.
[17] Keener J, Sneyd J. Mathematical Physiology. New York: Springer Verlag; 1998.
[18] Manwani A, N Steinmetz P, Koch C. Channel noise in excitable neural membranes. Advances in Neural
Information Processing Systems 12. 2000;p. 142–149.
[19] Fall C, Marland E, Wagner J, Tyson J. Computational Cell Biology. New York: Springer Verlag; 2002.
[20] Keefer EW, Botterman BR, Romero MI, Rossi AF, Gross GW. Carbon nanotube-coated electrodes im-
prove brain readouts. Nat Nanotech. 2008;3:434–439.
[21] Wiley JD, Webster JG. Analysis and control of the current distribution under circular dispersive. IEEE
Trans Biomed Eng. 1982;29:381–385.
√
[22] Denison T, Consoer K, Kelly A, Hachenburg A, Santa W. A 2.2µW 94nV /
H z , chopper-stabilized
instrumentation ampliﬁer for EEG detection in chronic implants. IEEE ISSCC Dig Tech Papers. 2007
Feb;8(6).
[23] Ferrari G, Gozzini F, Sampietro M. A current-sensitive front-end ampliﬁer for nano biosensors with a
2MHz BW. IEEE ISSCC Dig Tech Papers. 2007 Feb;8(7).
[24] Harrison RR. The design of integrated circuits to observe brain activity. Proc IEEE. 2008 July;96:1203–
1216.
[25] Kaiser JF. On a simple algorithm to calculate the energy of a signal. In Proc IEEE Int Conf Acoustic
Speech and Signal Processing. 1990;p. 381–384.
[26] Vaseghi SV. Advanced Digital Signal Processing and Noise Reduction. Wiley-Teubner; 1996.
[27] Hosking J. Fractional differencing. Biometrika. 1981 Jan;68:165–176.
[28] Rubner Y. Perceptual metrics for image database navigation. In: Ph.D. dissertation, Stanford University;
1999. .

9

