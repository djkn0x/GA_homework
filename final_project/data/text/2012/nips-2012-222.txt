A   m e c h a n i s t i c   m o d e l   o f   e a r l y   s e n s o r y  
p r o c e s s i n g   b a s e d   o n   s u b t r a c t i n g   s p a r s e  
r e p r e s e n t a t i o n s    

             Shau l  Druckmann*                                                  Tao  Hu*                                                    Dm itr i  B .  Chk lovsk i i  
 
                                                                                             *  -  Equa l  con tr ibu t ion  
                                                                                           Jane l ia  Farm  Research  Campus  
                                                                         {druckmanns ,  hu t ,  m i tya}@ jane l ia .hhm i .org  

Abstract 
Ear ly   s tages   of   sensory   sys tems   face   the   cha l lenge   of   compress ing  
in fo rma t ion   from   numerous   recep to rs   on to   a   much   sma l ler   number   o f  
p ro jec t ion   neu rons ,   a   so   ca l led   commun ica t ion   bo t t leneck .   To   make   mo re  
eff ic ien t   use   o f   l im i ted   bandw id th ,   comp ress ion   may   be   ach ieved   us ing  
p red ic t ive   cod ing ,   whereby   p red ic tab le ,   o r   redundan t ,   componen ts   o f   the  
s t imu lus   are   removed .   In   the   case   o f   the   re t ina ,   S r in ivasan   e t   a l .   (1982 )  
sugges ted   tha t   feed fo rward   inh ib i to ry   connec t ions   sub trac ting   a   l inear  
p red ic t ion   genera ted   f rom   nearby   recep to rs   imp lemen t   such   comp ress ion ,  
resu l t ing   in   b iphas ic   cen ter-su rround   recep t ive   f ie lds .   However ,   feedback  
inh ib i to ry   c ircu i ts   are   common   in   ear ly   senso ry   c ircu i ts   and   fu r thermo re  
the ir   dynam ics   may   be   non l inear .   Can   such   c ircu i ts   imp lemen t  p red ic t ive  
cod ing  as  we l l?  Here ,  so lv ing   the   trans ien t  dynam ics  of  non l inear  rec iproca l  
feedback   c ircu i ts   th rough   ana logy   to   a   s igna l-p rocess ing   a lgo r i thm   ca l led  
l inear ized   B regman   i tera t ion   we   show   tha t   non l inear   p red ic t ive   cod ing   can  
be   imp lemen ted   in   an   inh ib i to ry   feedback   c ircu i t .   In   response   to   a   s tep  
s t imu lus ,   in terneu ron   ac t iv i ty   in   t ime   cons truc ts   p rog ress ive ly   less   sparse  
bu t   mo re   accu ra te   rep resen ta t ions   o f   the   s t imu lus ,   a   tempo ra l ly   evo lv ing  
p red ic t ion .   Th is   ana lys is   p rov ides   a   powerfu l   theo re t ica l   framewo rk   to  
in terp re t   and   unders tand   the   dynam ics   o f   ear ly   senso ry   p rocess ing   in   a  
var ie ty   o f   phys io log ica l   exper imen ts   and   y ie lds   nove l   p red ic t ions   regard ing  
the  re la t ion  be tween  ac t iv i ty  and  s t imu lus  s ta t is t ics . 
 
1     I n t r o d u c t i o n  
Recep tor   neurons   in   ear ly   senso ry   sys tems   are   mo re   numerous   than   the   p ro jec t ion  
neu rons   tha t   transm i t   senso ry   in fo rma t ion   to   h igher   b ra in   areas ,   imp ly ing   tha t   senso ry  
s igna ls   mus t   be   comp ressed   to   pass   th rough   a   l im i ted   bandw id th   channe l   known   as  
“Bar low ’s   bo t t leneck”   [1 ] .   S ince   na tu ra l   s igna ls   ar ise   from   phys ica l   ob jec ts ,   wh ich   are  
con t iguous   in   space   and   t ime ,   they   are  h igh ly   spa t ia l ly   and   tempo ra l ly   co rre la ted   [2 -4 ] .  Such  
s igna ls   are   idea l ly   su i ted   fo r   p red ic t ive   cod ing ,   a   comp ress ion   s tra tegy   bo rrowed   from  
eng ineer ing   whereby   redundan t ,   o r   p red ic tab le   componen ts   o f   the   s igna l   are   sub trac ted   and  
on ly   the  res idua l   is   transm i t ted   [5 ] .  
Cons ider ,   for   examp le ,   the   process ing   of   na tura l   images   in   the   re t ina .   Ins tead   of  
transm i t t ing   pho to recep to r   s igna ls ,   wh ich   are   h igh ly   co rre la ted   in   space   and   t ime ,   gang l ion  
ce l ls   can   transm i t   d ifferences   in   s igna l   be tween   nearby   p ixe ls   o r   consecu t ive   t ime   po in ts .  
The   sem ina l   work   of   S r in ivasan   e t   a l .   in troduced   pred ic t ive   cod ing   to   neurosc ience ,  
p ropos ing   tha t   feed fo rward   inh ib i t ion   cou ld   imp lemen t   p red ic t ive   cod ing   by   sub trac t ing   a  
p red ic t ion   fo r   the   ac t iv i ty   o f   a   g iven   pho to recep to r   genera ted   from   the   ac t iv i ty   o f   nearby  
recep to rs   [6 ] .   Indeed ,   the   we l l   known   cen ter   su rround   spa t ia l   recep t ive   f ie lds   o r   b iphas ic  
tempo ra l   recep t ive   f ie lds   o f   gang l ion   ce l ls   [7 ]   may   be   v iewed   as   ev idence   o f   p red ic t ive  
cod ing   because   they   effec t ive ly   code   such   d ifferences   [6 ,   8 -10 ] .   A l though   the   S r in ivasan   e t  

 

 

 

       

a l .   mode l   cap tu red   the   essence   o f   p red ic t ive   cod ing   i t   does   no t   ref lec t   two   impo r tan t  
b io log ica l   fac ts .   F irs t ,   in   the   re t ina ,   and   o ther   ear ly   senso ry   sys tems ,   inh ib i t ion   has   a  
s ign if ican t   feedback   componen t   [11 -13 ] .   Second ,   in terneu ron   transfer   func t ions   are   o f ten  
non - l inear  [14 -16 ] .  
Here ,   we   demons tra te   tha t   feedback   c ircu i ts   can   be   v iewed   as   imp lemen t ing   pred ic t ive  
cod ing .   Surprisingly,  by  taking  advantage  of  recent  developments  in  applied  mathematics  and 
signal  processing  we  are  able  to  solve  the  non-linear  recurrent  dynamics  of  such  a  circuit,  for  an 
arbitrary number of  sensory  channels  and  interneurons,  allowing us  to  address  in detail  the  circuit 
dynamics and consequently the temporal and stimulus dependencies. Moreover ,   in troduc ing  non -
l inear   feedback   d rama t ica l ly   changes   the   na tu re   o f   p red ic t ions .   Ins tead   o f   a   s ta t ic   re la t ion  
be tween   s t imu lus  and  p red ic t ion ,  we   f ind   tha t   the  p red ic t ion  becomes  bo th   s t imu lus  and   t ime  
dependen t .    
2     M o d e l  
2 . 1   D y n a m i c s   o f   t h e   l i n e a r   s i n g l e - c h a n n e l   f e e d b a c k   c i r c u i t  
We  start  by  considering  predictive  coding  in  feedback  circuits,  where  principal  neurons  are 
reciprocally connected with  inhibitory  interneuron  forming a negative  feedback  loop. Much of  the 
intuition  can  be  developed  from  linear  circuits  and  we  start  from  this  point.  Consider  a  negative 
!!! !"!" = −!!! !(!) + !!! !(!) − !"(!) ,
feedback  circuit  composed  of  a  single  principal  neuron,  p,  and  a  single  interneuron,  n  (Fig.  1a). 
Assuming that both types of neurons are linear first-order elements, their dynamics are given by: 
!!! !"!" = −!!! ! ! + !!! !" !                                         
where  gm  is  the  membrane  conductance  (inverse  of  membrane  resistance),  Cm  the  membrane 
capacitance,  gs  synaptic  conductance  and  the  subscript  designates  the  neuron  class  (principal  and 
interneuron)  and  w  in  the  second  equation  is  the weight  of  the  synapse  from  the  principal  neuron 
to the interneuron. For simplicity, we assumed that the weight of the synapse from the interneuron 
to  the  principal  neuron  is  the  same  in  magnitude  but  with  negative  sign,  -w.  Although  we  do  not 
input to the interneurons, !"(!), and the output of the interneurons, !(! + !). Given that feedback 
necessarily  expect  the  brain  to  fully  reconstruct  the  stimulus  on  the  receiving  side,  we  must  still 
ensure  that  the  transmitted  signal  is  decodable.  To  guarantee  that  this  is  the  case,  the  prediction 
analytical solutions below, we assume that ! → 0 to avoid clutter and do not explicitly indicate the 
made by the interneuron must be strictly causal. In other words, there must be a delay between the 
requires  signals  passing  through  a  synapse,  such  delay  is  biologically  plausible. When  discussing 
      !! !"!" = −! + !!! !!! ! − !" ,  
                    !! !"!" = −! + !!! !!! !" 
time dependence of the vectors p, s, and n. By rearranging the terms in Eq. 1 we obtain: 
 
 
 
                        (2)  
 
   
 
 
where  τ=RC    is  the  membrane  time  constant.  Since  principal  neurons  should  be  able  to  transmit 
      ! = ! ! − !"  
fast  changes  in  the  stimuli,  we  assume  that  the  time  constant  of  the  principal  cells  is  small 
compared  to  that  of  the  interneurons.  Therefore,  we  can  assume  that  the  first  equation  reaches 
      !! !"!" = −! + !!! !!! !" ,  
equilibrium instantaneously: 
where  we  defined ! = !!! !!! .  As  the  purpose  of  interneuron  integration  will  be  to  construct 
 
 
 
                                      (3) 
 
 
 
 
stimulus  representation,  the  integration  time  should be on  the order of  the auto-correlation  time  in 
the  stimulus.  Since  here  we  study  the  simplified  case  of  the  semi-infinite  step-stimulus,  the  time 
constant of the neuron should approach infinity. We assume this occurs by the interneurons having 
a  very  large  membrane  resistance  (or  correspondingly  a  very  small  conductance)  and  moderate 
capacitance. Therefore, the leakage term, -n, which is the only term in the second line of Eq. 3 that 

         (1) 

 

! = ! ! − !"  
doesn’t grow with  the membrane  resistance, can be neglected  in  the dynamics of  interneurons. By 
!! !!!" = !!! !!! !" ! − !" . 
this assumption and substituting the first equation into the second, we find: 
Defining the effective time constant ! = !!!!!! !  we have: 
 
 
 
 
! = ! ! − !"
 
 
 
 
 
 
         (4) 
! !!!" = !"                      
In  response  to a  step  stimulus: !(!)    = ! ! ! , where !(!) is  the Heavyside  function,  the dynamics 
         (5) 
 
 
 
 
 
 
 
            
! ! =    !!   θ !    1  –   exp −! ! !! !
      
of equation 5 are straightforward to solve, yielding:  
! ! = !"   θ ! exp −! ! !! !                                        
         (6) 
 
           
 
 
 
The  interneuron’s  activity,  n(t),  grows  with  time  as  it  integrates  the  output  of  the  principal 
neuron,  p(t),  Fig.  1a.  In  turn,  the  principal  neuron’s  output,  p(t),  is  the  difference  between  the 
incoming stimulus and the interneuron’s activity, n(t), i.e. a residual, which decays with time from 
the  onset  of  the  stimulus.  In  the  limit  considered  here  (infinite  interneuron  time  constant),  the 
interneuron’s  feedback  will  approach  the  incoming  stimulus  and  the  residual  will  decay  to  zero. 
To  summarize,  one  can  view  the  interneuron’s  activity  as  a  series  of  progressively more  accurate 
predictions of the stimulus. The principal neuron subtracts these predictions and sends the series of 
residuals to higher brain areas, a more efficient approach than direct transmission (Fig. 1a). 
a
b
Direct transmission
Negative feedback circuit
(cid:54)(cid:72)(cid:81)(cid:86)(cid:82)(cid:85)(cid:92)(cid:3)(cid:76)(cid:81)(cid:83)(cid:88)(cid:87)(cid:3)(cid:239)(cid:3)(cid:86)(cid:3)
(cid:54)(cid:72)(cid:81)(cid:86)(cid:82)(cid:85)(cid:92)(cid:3)(cid:76)(cid:81)(cid:83)(cid:88)(cid:87)(cid:3)(cid:239)(cid:3)(cid:86)(cid:3)

Coding
w

Interneuron, n 
δ
α

Principal neuron, p 

p

nnn

w
Transmission channel
w

p
p

nnnn
n

Output

Principal neuron, p 

Transmission channel

Output

p

p
p

Time

w
Time
Time
Decoding
                          
 
Figure  1  Schematic  view  of  early  processing  in  a  single  sensory  channel  in  response  to  a 
step  stimulus.  a.  A  predictive  coding  model  consists  of  a  coding  circuit,  transmission  channel 
and,  for  theoretical  analysis  only,  a  virtual  decoding  circuit.  Coding  is  performed  in  a  negative 
feedback  circuit  containing  a  principal  neuron,  p,  and  an  inhibitory  interneuron,  n.  In  response 
to  a  step-stimulus  (top  left)  the  interneuron  charges  up  with  time  (top  right)  till  it  reaches  the 
value  of  the  stimulus.  Principal  neuron  (middle  left)  transmits  the  difference  between  the 
interneuron activity and the stimulus, resulting in a transient signal. b. Direct transmission. 
The  transient  response  to  a  step  stimulus  (Fig.  1a  left)  is  consistent with  electrophysiological 
measurements  from  principal  neurons  in  invertebrate  and  vertebrate  retina  [10,  17].  For  example, 
in  flies,  cells  post-synaptic  to  photoreceptors  (the  LMCs)  have  graded  potential  response 
consistent  with  Equation  5.  In  the  vertebrate  retina,  most  recordings  are  performed  on  ganglion 
cells,  which  read  out  signals  from  bipolar  cells.  In  response  to  a  step-stimulus  the  firing  rate  of 
ganglion cells is consistent with Equation 6 [17]. 
2 . 2   D y n a m i c s   o f   t h e   l i n e a r   m u l t i - c h a n n e l   f e e d b a c k   c i r c u i t  
In  most  sensory  systems,  stimuli  are  transmitted  along  multiple  parallel  sensory  channels, 
such  as  mitral  cells  in  the  olfactory  bulb,  or  bipolar  cells  in  the  retina.  Although  a  circuit  could 
implement  predictive  coding  by  replicating  the  negative  feedback  loop  in  each  channel,  this 

solution  is  likely  suboptimal  due  to  the  contiguous  nature  of  objects  in  space, which  often  results 
in  stimuli  correlated  across  different  channels. Therefore,  interneurons  that  combine  inputs  across 
! = ! − !"
channels may generate an accurate prediction more rapidly. The dynamics of a multichannel linear 
! !!!" = !!! ,          
negative feedback circuit are given by: 
where  boldface  lowercase  letters  are  column  vectors  representing  stimulus,   ! = (!! , !! , !! , … )! ,   
                       (7) 
 
 
 
 
 
 
activity of principal neurons, !, and  interneurons,   !, Fig. 2a. Boldface uppercase  letters designate 
synaptic  weight  matrices.  Synaptic  weights  from  principal  neurons  to  interneurons  are !! ,  and 
negative  sign,  −! .  Such  symmetry  was  suggested  for  olfactory  bulb,  considering  dendro-
dendritic  synapses  [18].  Each  column  of ! contains  the  weights  of  synapses  from  correlated 
synaptic weights from interneurons to principal neurons are, for simplicity, symmetric but with the 
principal neurons to a given interneuron, thus defining that interneuron’s feature vector (Fig. 2b). 
! = (!!!)!!    1  –   exp −!!! !! ! !! !                                            
Linear  dynamics  of  the  feedback  circuit  in  response  to  a multi-dimensional  step  stimulus  can 
be solved in the standard manner similarly to equation 6:  
! = !   ! − !(!!!)!!    1  –   exp −!!! !! ! !! !             (8) 
provided !!! is  invertible. When  the matrix !!! is not  full  rank,  for  instance  if  the number of 
                                         
! = !! (!!! )!!    1  –   exp −!!! !! !
!
interneurons exceeds the number of sensory channels, the solution of Equation 7 is given by: 
! = !exp −!!! !! ! !                                                                            
         (9) 
 
    
 
 
 
of  progressively  more  accurate  stimulus  predictions, ! = !".  The  principal  neuron  sends  the 
series of residuals of these predictions, ! = ! − !, to higher brain areas, and the dynamics result in 
Recapitulating  the equations  in words, as above one can view  the  interneurons’ activity as a series 
the transmitted residual decreasing in time [19-22] (Fig. 2c,d). 
2 . 3   D y n a m i c s   o f   t h e   n o n - l i n e a r   m u l t i - c h a n n e l   f e e d b a c k   c i r c u i t  
Our  solution of  the circuit dynamics  in  the previous  sub-section  relied on  the assumption  that 
neurons  act  as  linear  elements,  which  in  view  of  non-linearities  in  real  neurons,  represents  a 
drastic  simplification.  We  now  extend  this  analysis  to  the  non-linear  circuit.  A  typical  neural 
response  non-linearity  is  the  existence  of  a  non-zero  input  threshold  below which  neurons  do  not 
      Thresh ! = ! − ! , ! > !
respond. A pair of such on- and off- neurons is described by a threshold function (Fig. 2e) that has 
0, ! ≤ !
a “gap” or “deadzone” around zero activity and is not equivalent to a linear neuron: 
! + ! , ! < −!  
! = ! − !"              
! !!!" = !!!                
Accordingly, the dynamics are given by: 
! = Thresh! (!),     
The  central  contribution of  this paper  is  an  analysis of predictive  coding  in  a  feedback  circuit 
with  threshold-linear  interneurons  inspired  by  the  equivalence  of  the  network  dynamics  to  a 
signal-processing  algorithm  called  linearized  Bregman  iteration  [23,  24].  Before  showing  the 
equivalence,  we  first  describe  linearized  Bregman  iteration.  This  algorithm  constructs  a  faithful 
representation  of  an  input  as  a  linear  sum  over  dictionary  elements  while  minimizing  the  L1-L2 
norm of the representation [25]. Formally, the problem is defined as follows:  

       (10) 

       (11) 

      

 

 

 

 

 

 

 

 

 

 

 

 

 

              for  ! ! ≡ ! |! |! + !!! | !| !! , min! !(!)   ! . ! . !" = !. 
 
 
       (12) 
!!!! = !! + !!! ! − !!!
Remarkably,  this  high-dimensional  non-linear  optimization  problem  can  be  solved  by  a  simple 
!!!! = Thresh! !!!!                        , 
iterative scheme (see Appendix): 
 
       (13) 
 
 
 
 
 
combining  a  linear  step,  which  looks  like  gradient  descent  on  the  representation  error,  and  a 
component-wise threshold-linear step. 
Eq.  11,  the  network  dynamics,  is  the  continuous  version  of  linearized Bregman  iteration,  Eq. 
13.  Intuitively  speaking,  the  dynamics  of  the  network  play  the  role  of  the  iterations  in  the 
algorithm. Having  identified  this equivalence, we are able  to both  solve and  interpret  the  transient 
non-linear  dynamics  (see  supplementary  materials  for  further  details).  The  analytical  solution 
allows us a deeper understanding, for instance of the convergence of the algorithm. We note that if 
the  interneuron  feature  vectors  span  the  stimulus  space  the  steady-state  activity  will  be  zero  for 
any  stimulus  and  thus  non-informative.  Therefore,  solving  the  transient  dynamics,  as  opposed  to 
just the steady-state activity [18, 19, 21, 26], was particularly crucial in this case. 
Next,  we  describe  in  words  the  mathematical  expressions  for  the  response  of  the  feedback 
of  the sensory stimulus on  their  feature vectors, !!!. With  time,  interneurons cross  threshold and 
circuit  to  a  step-stimulus  (see Supplement  for  dynamics  equations), Fig.  2f-g. Unlike  in  the  linear 
circuit,  interneurons  do  not  inhibit  principal  neurons  until  their  internal  activity  crosses  threshold, 
Fig.  2f.  Therefore,  their  internal  activity  initially  grows  with  a  rate  proportional  to  the  projection 
of the sensory stimulus on its feature vector, !!! is highest. As its contribution is subtracted from 
the  activity  of  the  principal  neurons,  the  driving  force  on  other  interneurons !! (! − !") 
contribute  to  the  stimulus  representation,  thereby  constructing  a  more  accurate  representation  of 
the  stimulus, Fig.  2f,g. The  first  interneuron  to  cross  threshold  is  the  one  for which  the  projection 
changes.  Therefore,  the  order  by  which  interneurons  cross  threshold  depends  also  on  the 
correlation between the feature vectors, Fig. 2b,f. 
a
c
Sensory Input
Linear negative feedback circ.

Linear negative feedback circ.

0.3

d
y
t
i
v
i
t
c
a
 
n
o
r
u
e
n
 
l
a
p
i
c
n
i
r
P

h

g

p#

T
W

e

λ
λ
0
0
-λ
λ

-λ

λ

n!

n$

0.2

0.1

0

−0.1

p"

p!

n#

n"

W

External activity, a

Internal
activity
n

y
t
i
v
i
t
c
a
 
n
o
r
u
e
n
r
e
t
n
I

Output to higher brain areas
b
Feature vectors
Stimulus

-5
20
50
40
30
10
0
Time
Thresh-linear negative feedback circuit

0.12
0.1
0.08
0.06
0.04
0.02
0
-5
20
50
40
30
10
0
Time
Thresh-linear negative feedback circ.
0.14
0.12
0.1
0.08
0.06
0.04
0.02
0
20
-5
50
40
30
20
10
0
 
Time
Time
Figure  2.  Predictive  coding  in  a  feedback  circuit  in  response  to  a  step  stimulus  at  time 
zero.  a.  Circuit  diagram  for  feedback  circuit.  b.  Stimulus  (grayscale  in  black  box  left)  and  a 
subset  of  interneuron’s  feature  vector  (grayscale  in  boxes).  c-d.  Response  of  linear  feedback 
circuit to a step stimulus at time zero in interneurons (c) and principal neurons (d). e. Threshold-
linear  transfer  function  relating  internal, n, and external, a, activity of  interneurons. Dashed  line 
shows  diagonal.  Firing  rates  cannot  be  negative  and  therefore  the  threshold-linear  function 

0.4
0.3
0.2
0.1
0
−0.1
−0.2
−0.3
-5

y
t
i
v
i
t
c
a
 
n
o
r
u
e
n
 
l
a
p
i
c
n
i
r
P

Expanded view of early time

a
 
,
y
t
i
v
i
t
c
a
 
l
a
n
r
e
t
x
E

f
n
 
,
.
t
c
a
 
l
a
n
r
e
t
n
I

T
min(λ /δ W s)

30

40

50

0

10

should  be  thought  as  combining  a  pair  of  on  and  off-cells.  f-h.  Response  of  interneurons  (f-g) 
and principal neurons to a step stimulus at time zero. f. Expanded view of internal activity of the 
interneurons  (only  some  are  shown,  see  grayscale  in  boxes  color  coded  to  match  b)  at  early 
times. g. External activity of a larger subset of interneurons over a longer time period. Grayscale 
boxes  show  the  stimulus  represented  by  the  interneuron  layer  at  various  times  marked  by 
arrows.  h.  Principal  neuron  activity  as  a  function  of  time.  As  interneurons  cross  threshold  they 
more  closely  represent  the  stimulus  and  cancel  out  more  of  the  principal  cell  activity. 
Eventually,  the  interneuron representation (right box  in g)  is nearly  identical  to  the stimulus and 
the principal neurons’ activity drops almost to zero. 
their  activity, ! = !",  and  will  fully  subtract  it  from  the  principal  cells’  activity,  resulting  in  no 
Collectively  the  representation  progresses  from  sparse  to  dense,  but  individual  interneurons  may 
first be active  then become silent. Eventually  interneurons will accurately  represent  the  input with 
further excitation to the interneurons, Fig. 2g,h. 
However,  this  description  leads  to  an  immediate  puzzle.  Namely,  the  algorithm  builds  a 
representation  of  the  stimulus  by  the  activity  of  interneurons.  Yet,  interneurons  are  local  circuit 
elements whose activity is not transmitted outside the circuit. Why would a representation be built 
if  it  is  available  only  locally within  the  neural  circuit?  The  answer  to  this  conundrum  is  found  by 
considering  the  notion  of  predictive  coding  in  early  sensory  circuits  presented  in  the  introduction. 
the  prediction, ! = !" ,  which  was  constructed  in  the  interneurons  from  previous  incoming 
The interneurons serve as the predictor and the principal neurons transmit a prediction residual. 
! = ! − !, to higher brain areas. We note that initially the interneurons are silent and the principal 
As expected by the framework of predictive coding, at each point in time, the circuit subtracts 
sensory  signals,  from  the  current  sensory  stimulus  and  the principal neurons  transmit  the  residual, 
neurons  transmit  the  stimulus  directly.  If  there  were  no  bandwidth  limitation,  the  stimulus  could 
be decoded just from this initial transmission. However, the bandwidth limitation results in coarse, 
or noisy, principal neuron transmission, an issue we will return to later.  
3   R e s u l t s  
In  neuroscience,  the  predictive  coding  strategy  was  originally  suggested  to  allow  efficient 
transmission  through  a  limited bandwidth  channel  (Srinivasan  et  al., 1982). Our main  result  is  the 
solution  of  the  transient  dynamics  given  in  the  section  above. Understanding  circuit  dynamics  in 
the  predictive  coding  framework  allows  us  to make  a  prediction  regarding  the  length  of  transient 
activity  for  different  types  of  stimuli.  Recall  that  the  time  from  stimulus  onset  to  cancellation  of 
the  stimulus  depends  on  the  rate  of  the  interneurons’  activation,  which  in  turn  is  proportional  to 
the projection of the stimulus on the interneurons’ feature vectors. Presumably, interneuron feature 
vectors  are  adapted  to  the  most  common  stimuli,  e.g.  natural  images  in  the  case  of  the  retina, 
therefore  this  type  of  stimulus  should  be  relatively  quickly  cancelled  out.  In  contrast,  non-natural 
stimuli,  like  white  noise  patterns,  will  be  less  well  captured  by  interneuron  receptive  fields  and 
their  activation will  occur  after  a  longer  delay. Accordingly,  it will  take  longer  to  cancel  out  non-
natural stimuli, leading to longer principal neuron transients. 
Below,  we  show  that  the  feedback  circuit  with  threshold-linear  neurons  is  indeed  more 
efficient  than  the  existing  alternatives. We  first  consider  a  scenario  in  which  effective  bandwidth 
limitation  is  imposed  through  addition  of  noise.  Secondly,  we  consider  a  more  biologically 
relevant model, where transmission bandwidth is set by the discreteness of Poisson neural activity.  
We find  that  threshold  linear  interneurons achieve more accurate predictions when faced with 
stimulus  corrupted  with  i.i.d  Gaussian  noise.  The  intuition  behind  this  result  is  that  of  sparse 
denoising  [23].  Namely,  if  the  signal  can  be  expressed  as  a  sparse  sum  of  strong  activation  of 
dictionary elements, whereas  the noise requires a  large number of weakly activated elements,  then 
thresholding  the  elements  will  suppress  the  noise  more  than  the  signal,  yielding  denoising.  We 
note  that  this  fact  alone  does  not  in  itself  argue  for  the  biological  plausibility  of  this  network,  but 
threshold-linear dynamics are a common approximation in neural networks. 
 

Figure 3. Predictions by negative feedback circuit. Left: Relative prediction error ( ! − ! !/
! ! ),  where ! = !",  as  a  function  of  time  for  a  stimulus  consisting  of  an  image  patch 
 
corrupted by  i.i.d Gaussian noise at every  time point. Right: An  image  is sent  through principal 
neurons  that  transmit  Poisson.  The  reconstruction  error  as  a  function  of  time  following  the 
presentation  of  stimulus  is  shown  for  the  full  non-linear  negative  feedback  circuit  (black),  for  a 
linear  negative  feedback  circuit  (red),  for  a  direct  transmission  circuit  (blue),  and  for  a  circuit 
where  the  sparse approximation  itself  is  transmitted  instead of  the  residual  (green). Time on  the 
x-axis  is measured  in units of  the  time  length  in which a  single noisy  transmission occurs.  Inset 
shows log-log plot. 
In  addition  to  considering  transmission  of  stimuli  corrupted  by  Gaussian  noise,  we  also 
studied  a  different  model  where  bandwidth  limitation  is  set  by  the  discreteness  of  spiking, 
modeled  by  a  Poisson  process.  Although  the  discreteness  of  transmission  can  be  overcome  by 
averaging  over  time,  this  comes  at  the  cost  of  longer  perceptual  delays,  or  lower  transmission 
rates,  as  longer  integration  takes  place.  Therefore,  we  characterize  transmission  efficiency  by 
reconstruction error as a function of time, Fig. 3. We find that, for Poisson transmission, predictive 
coding  provides  more  accurate  stimulus  reconstruction  than  direct  transmission  for  all  times  but 
the brief interval until the first interneuron has crossed threshold (Fig. 3). 
4   D i s c u s s i o n  
By   so lv ing   the   dynam ics   o f   the   nega t ive   feedback   c ircu i t   th rough   equ iva lence   to  
l inear ized   B regman   i tera t ion  we   have   shown   tha t   the   deve lopmen t   o f   ac t iv i ty   in   a   s imp l if ied  
ear ly   senso ry   c ircu i t   can   be   v iewed   as   imp lemen t ing   an   eff ic ien t ,   non- l inear ,   in tr ins ica l ly  
para l le l   a lgo r i thm   fo r   p red ic t ive   cod ing .   Ou r   s tudy   maps   the   s teps   o f   the   a lgo r i thm   on to  
spec if ic   neu rona l   subs tra tes ,   p rov id ing   a   so l id   theo re t ica l   framewo rk   fo r   unders tand ing  
phys io log ica l   exper imen ts   on   ear ly   senso ry   p rocess ing   as   we l l   as   exper imen ta l ly   tes t ing  
p red ic t ive  cod ing   ideas  on  a  f iner ,  mo re  quan t i ta t ive   leve l .  
Recen t ly ,   sparse   represen ta t ions   were   s tud ied   in   a   s ing le- layer   c ircu i t   w i th   la tera l  
inh ib i to ry  connec t ions  p roposed  as  a  mode l  o f  a  d ifferen t  b ra in  area ,  name ly  p r imary  co r t ica l  
areas .  The  c ircu i t  cons truc ts   the  s t imu lus   rep resen ta t ion   in   the  p ro jec t ion  neu rons   themse lves  
and   d irec t ly   transm i ts   i t   downs tream   [27 ,   28 ] .   We   be l ieve   i t   does   no t   mode l   ear ly   senso ry  
sys tems   as   we l l   as   the   nega t ive   feedback   c ircu i t   fo r   a   number   o f   reasons .   F irs t ,   ana tom ica l  
da ta   is   mo re   cons is ten t   w i th   the   rec ip roca l ly   connec ted   in terneu ron   layer   than   la tera l  
connec t ions   be tween   p r inc ipa l   neu rons   [11 ,   13 ] .   Second ,   d irec t   transm iss ion   o f   the  
rep resen ta t ion   wou ld   resu l t   in   g rea ter   percep tua l   de lays   af ter   s t imu lus   onse t   s ince   no  
in fo rma t ion   is   transm i t ted   wh i le   the   rep resen ta t ion   is   be ing   bu i l t   up   in   the   sub - th resho ld  
range .   In   con tras t ,   in   the   p red ic t ive   cod ing  mode l   the   p ro jec t ion   neu rons   pass   fo r th   (a   coarse  
and   poss ib ly   no isy   vers ion   o f)   the   inpu t   s t imu lus   from   the   very   beg inn ing .   We   no te   tha t  
add ing  a  non l inear i ty  on   the  p r inc ipa l  neu rons  wou ld   resu l t   in  a  de lay   in   transm iss ion   in  bo th  
mode ls .   A l though   there   is   no   b io log ica l   jus t if ica t ion   for   in troduc ing   a   th resho ld   to  
in terneu rons  on ly ,   the  ava i lab i l i ty  o f  an  ana ly t ica l ly   so lvab le  mode l   jus t if ies  th is  abs trac t ion .  
Dynam ics  o f  a  c ircu i t  w i th   th resho ld  on  p r inc ipa l  neu rons  w i l l  be  exp lo red  e lsewhere .  
F rom   a   compu ta t iona l   po in t   o f   v iew  
to  
th ree   ma in   advan tages  
there   are  
overcomp le teness   in   the   nega t ive   feedback   c ircu i t .   F irs t ,   the   de lay   un t i l   sub trac t ion   o f  

p red ic t ion ,   wh ich   occu rs   when   the   f irs t   in terneuron   crosses   thresho ld ,   w i l l   be   br iefer   as   the  
number   o f   fea ture   vec tors   g rows   s ince   the   max ima l   p ro jec t ion   o f   the   s t imu lus   on   the  
in terneu rons’   fea ture  vec to rs  w i l l  be  h igher .  Second ,   the   larger   the  number  o f  fea ture  vec to rs  
the   fewer   the   number   o f   in terneu rons   w i th   sup ra- th resho ld   ac t iv i ty ,   wh ich   may   be  
energe t ica l ly   mo re   eff ic ien t .   Th ird ,   if   s t imu l i   come   from   d ifferen t   s ta t is t ica l   ensemb les ,   i t  
cou ld   be   advan tageous   to   have   fea ture   vec tors   ta i lo red   to   the   d ifferen t   s t imu lus   ensemb les ,  
wh ich  may  resu l t   in  more   fea tu re  vec tors ,   i .e . ,   in terneu rons   than  p r inc ip le  neu rons . 
Ou r   s tudy   cons idered   responses   to   s tep - l ike   s t imu l i .   If   the   senso ry   env ironmen t   changes  
on   s low   t ime   sca les ,   a   ser ies   o f   s tep - l ike   responses  may   be   taken   as   an   app rox ima t ion   to   the  
true   s igna l .   Na tu ra l ly ,   the   ex tens ion   o f   ou r   framewo rk   to   fu l ly   t ime-vary ing   s t imu l i   is   an  
impo r tan t  research  d irec t ion . 
 
Acknow ledgemen ts  
We   thank   S .   Baccus ,   A .   Genk in ,   V .   Goya l ,   A .   Kou lakov ,   M .   Me is ter ,   G .   Murphy ,   D .  
R inberg ,  and  R .  W i lson  fo r  va luab le  d iscuss ions  and   the ir   inpu t .  
For  ! ! ≡ ! |! |! + !!! | !| !! , min! !(!)   ! . ! . !" = !.    
 
The idea behind linearized Bregman iteration, is to start with !! = 0 and, at each iteration, to seek 
Append ix :  Der iva t ion  o f   l inear ized  Bregman   itera t ion  
Here, inspired by [22,23], we solve the following basis pursuit-like optimization problem: 
      (A1) 
 
 
 
!!!! = argmin! !!!! !, !! + !! | ! − !" |!  
to update a so as to minimize the square error plus the distance from the previous value of a. Thus, 
where we used a notation !!! !, !  for the Bregman divergence [29] between the two points a and 
we perform the following update: 
                     (A2) 
 
 
 
expression:  !!! !, ! = ! ! − ! ! − !, ! − ! ,  where  ! ∈ !"(!)  is  an  element  of 
b  induced  by  the  convex  function  J.  The  Bregman  divergence  is  an  appropriate measure  for  such 
problems  that  can  handle  the  non-differentiable  nature  of  the  cost.  It  is  defined  by  the  following 
the 
!!! (!, !! ) = ! | !| ! − ! |!! |! + !!! |! |!! − !!! !! |!! −    !, ! − !! ,            
subgradient of J at the point b. 
where ! is a subgradient of J at ak . The condition for the minimum in Eq. A2 is: 
The Bregman divergence for the elastic net cost function J defined in Eq. A1 is: 
! ! |!!!! |! + !!! !!!! |!! ∋ !! + !! ! − !!! ,   
      (A3) 
            
where !  [.]  designates  a  subdifferential.  Consistency  of  the  iteration  scheme  requires  that  the 
update !!!!   be a subgradient of J as well: 
 
 
                     (A4) 
! ! |!!!! |! + !!! !!!! |!! ∋ !!!! . 
!!!! = !! + !! ! − !!! . 
      (A5) 
 
 
 
 
 
By combining Eqs. A4,A5 we set: 
!!!! = argmin! ! ! ! + !!! | ! − !!!!! |! , 
 
       
 
 
                                   (A6) 
By substituting Eq. A6 into Eq. A4 and simplifying we get: 
!!!! = Thresh!" (!!!!! )  
                     (A7) 
 
 
 
By defining  !! = !!!  and expressing it in Eqs. A6,A8 with substitution ! = !"  we get: 
which has the explicit solution: 
!!!! = !! + !!! ! − !!!
 
 
 
         
                                   (A8) 
!!!! = Thresh! !!!!                         
      (A9) 
 
 
 
 
 
 
Eq. A9  is  the  linearized Bregman  iteration  algorithm  (main  text Eq. 13),  thereby  showing  that  the 
iterative  scheme  indeed  finds  a  minimum  of  Eq.  A2  at  every  time  point.  The  sequence 
convergence proof [23, 24] is beyond the scope of this paper. 

4 .  

18 .  

19 .  

20 .  

21 .  

14 .  

15 .  

16 .  

13 .  

10 .  

11 .  

12 .  

7 .  

8 .  

9 .  

2 .  

3 .  

5 .  
6 .  

R e f e r e n c e s  
Ba r low ,   H .B .   and   W .R .   Lev ick ,   Thresho ld   se t t ing   by   the   surround   o f   ca t   re t ina l   gang l ion  
1 .  
ce l ls .  The  Jou rna l  o f  phys io logy ,  1976 .  259 (3 ) :  p .  737 -57 .  
Dong ,   D .W .   and   J .J .   A t ick ,   S ta t is t ics  o f  na tura l   t ime -vary ing   images .   Ne two rk :   Compu ta t ion  
in  Neu ra l  Sys tems ,  1995 .  6 (3 ) :  p .  345 --358 .  
F ie ld ,   D .J . ,   Re la t ions   be tween   the   s ta t is t ics   o f   na tura l   images   and   the   response   proper t ies   o f  
cor t ica l  ce l ls .   Jou rna l   o f   the  Op t ica l   Soc ie ty   o f  Amer ica .  A ,  Op t ics   and   image   sc ience ,   1987 .  
4 (12 ) :  p .  2379 -94 .  
Rude rman ,   D .L .   and   W .   B ia lek ,   S ta t is t ics   o f   na tura l   images :   Sca l ing   in   the   woods .  Phys ica l  
rev iew   le t te rs ,  1994 .  73 (6 ) :  p .  814 -817 .  
E l ias ,  P . ,  Pred ic t ive  cod ing .  In fo rma t ion  Theo ry ,  IRE  T ransac t ions  on ,  1955 .  1 (1 ) :  p .  16 --24 .  
S r in ivasan ,   M .V . ,   S .B .   Laugh l in ,   and   A .   Dubs ,   Pred ic t ive   cod ing :   a   fresh   v iew   o f   inh ib i t ion  
in   the  re t ina ,   in  Proc  R  Soc  Lond ,  B ,  B io l  Sc i1982 .  p .  427 -59 .  
V ic to r ,   J .D . ,   Tempora l   aspec ts   o f   neura l   cod ing   in   the   re t ina   and   la tera l   gen icu la te .  
Ne two rk -Compu ta t ion   in  Neu ra l  Sys tems ,  1999 .  10 (4 ) :  p .  R1 -R66 .  
Hosoya ,   T . ,   S .A .   Baccus ,   and   M .   Me is te r ,   Dynam ic   pred ic t ive   cod ing   by   the   re t ina .   Na tu re ,  
2005 .  436 (7047 ) :  p .  71 -7 .  
Huang ,   Y .   and   R .P .N .   Rao ,   Pred ic t ive   cod ing .   W i ley   In te rd isc ip l ina ry   Rev iews :   Cogn i t ive  
Sc ience ,  2011 .  2 (5 ) :  p .  580 -593 .  
Laugh l in ,   S . ,   A   s imp le   cod ing   procedure   enhances   a   neuron 's   in forma t ion   capac i ty .  
Ze i tsch r if t  fu r  Na tu rfo rschung .  Sec t ion  C :  B iosc iences ,  1981 .  36 (9 -10 ) :  p .  910 -2 .  
Mas land ,   R .H . ,   The   fundamen ta l  p lan  o f   the  re t ina .   Na tu re   neu rosc ience ,   2001 .   4 (9 ) :   p .   877 -
86 .  
O lsen ,   S .R . ,   V .   Bhandawa t ,   and   R .I .   W i lson ,   D iv is ive   norma l iza t ion   in   o l fac tory   popu la t ion  
codes .  Neu ron ,  2010 .  66 (2 ) :  p .  287 -99 .  
Shephe rd ,   G .M . ,   e t   a l . ,   The   o l fac tory   granu le   ce l l:   from   c lass ica l   en igma   to   cen tra l   ro le   in  
o l fac tory  process ing .  B ra in  resea rch  rev iews ,  2007 .  55 (2 ) :  p .  373 -82 .  
A rev ian ,   A .C . ,   V .   Kapoo r ,   and   N .N .   U rban ,   Ac t iv i ty -dependen t  ga t ing  o f   la tera l  inh ib i t ion   in  
the  mouse  o l fac tory  bu lb .  Na tu re  neu rosc ience ,  2008 .  11 (1 ) :  p .  80 -7 .  
Baccus ,   S .A . ,   T im ing   and   compu ta t ion   in   inner   re t ina l   c ircu i try .   Annu   Rev   Phys io l ,   2007 .  
69 :  p .  271 -90 .  
R ieke ,   F .   and   G .   Schwa r tz ,   Non l inear   spa t ia l   encod ing   by   re t ina l   gang l ion   ce l ls :   when   1+1  
no t  equa l  2 .  Jou rna l  o f  Gene ra l  Phys io logy ,  2011 .  138 (3 ) :  p .  283 -290 .  
Shap ley ,   R .M .   and   J .D .   V ic to r ,   The  e f fec t  o f  con tras t  on   the   trans fer  proper t ies  o f  ca t  re t ina l  
gang l ion  ce l ls .  The  Jou rna l  o f  phys io logy ,  1978 .  285 :  p .  275 -98 .  
Kou lakov ,   A .A .   and   D .   R inbe rg ,   Sparse   Incomp le te   Represen ta t ions :   A   Po ten t ia l   Ro le   o f  
O l fac tory  Granu le  Ce l ls .  Neu ron ,  2011 .  72 (1 ) :  p .  124 -136 .  
Lee ,   D .D .   and   H .S .   Seung ,   Unsuperv ised   learn ing   by   convex   and   con ic   cod ing .  Advances   in  
Neu ra l  In fo rma t ion  P rocess ing  Sys tems ,  1997 :  p .  515--521 .  
Lochmann ,   T .   and   S .   Deneve ,   Neura l   process ing   as   causa l   in ference .   Cu rr   Op in   Neu rob io l ,  
2011 .  
O lshausen ,   B .A .   and   D .J .   F ie ld ,   Sparse   cod ing   w i th   an   overcomp le te   bas is   se t:   a   s tra tegy  
emp loyed  by  V1?  V is ion  resea rch ,  1997 .  37 (23 ) :  p .  3311 -25 .  
Rao ,   R .P .N .   and   D .H .   Ba l la rd ,   Pred ic t ive   cod ing   in   the   v isua l   cor tex :   a   func t iona l  
in terpre ta t ion  o f  some  ex tra -c lass ica l  recep t ive - f ie ld  e f fec ts .   na tu re   neu rosc ience ,   1999 .   2 :   p .  
79 --87 .  
Oshe r ,   S . ,   e t   a l . ,   Fas t   l inear ized   Bregman   i tera t ion   for   compress ive   sens ing   and   sparse  
deno is ing .  Commun ica t ions   in  Ma thema t ica l  Sc iences ,  2009 .  
Y in ,   W . ,   e t   a l . ,   Bregman   i tera t ive   a lgor i thms   for   l1 -m in im iza t ion   w i th   app l ica t ions   to  
compressed  sens ing .  S IAM  Jou rna l  on  Imag ing  Sc iences ,  2008 .  1 (1 ) :  p .  143 --168 .  
Zou ,   H .   and   T .   Has t ie ,   Regu lar iza t ion   and   var iab le   se lec t ion   v ia   the   e las t ic   ne t .   Jou rna l   o f  
the  Roya l  S ta t is t ica l  Soc ie ty :  Se r ies  B  (S ta t is t ica l  Me thodo logy ) ,  2005 .  67 (2 ) :  p .  301 --320 .  
Dayan ,   P . ,   Recurren t  samp l ing  mode ls   for   the  He lmho l tz  mach ine .  Neu ra l   compu ta t ion ,   1999 .  
11 (3 ) :  p .  653 -78 .  
Rehn ,   M .   and   F .T .   Somme r ,   A   ne twork   tha t   uses   few   ac t ive   neurones   to   code   v isua l   inpu t  
pred ic ts  
the   d iverse   shapes   o f   cor t ica l   recep t ive  
f ie lds .  Jou rna l   o f   compu ta t iona l  
neu rosc ience ,  2007 .  22 (2 ) :  p .  135 -46 .  
Roze l l ,   C .J . ,   e t   a l . ,   Sparse   cod ing   v ia   thresho ld ing   and   loca l   compe t i t ion   in   neura l   c ircu i ts .  
Neu ra l  compu ta t ion ,  2008 .  20 (10 ) :  p .  2526 -63 .  
B regman ,   L .M . ,   The   re laxa t ion   me thod   o f   f ind ing   the   common   po in t   o f   convex   se ts   and   i ts  
app l ica t ion   to   the   so lu t ion   o f   prob lems   in   convex   programm ing*   1 .   USSR   compu ta t iona l  
ma thema t ics  and  ma thema t ica l  phys ics ,  1967 .  7 (3 ) :  p .  200 --217 .    

29 .  

23 .  

24 .  

25 .  

26 .  

27 .  

28 .  

17 .  

22 .  

