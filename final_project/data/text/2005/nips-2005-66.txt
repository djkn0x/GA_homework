Non-iterative Estimation with Perturbed
Gaussian Markov Processes

Yunsong Huang
B. Keith Jenkins
Signal and Image Processing Institute
Department of Electrical Engineering-Systems
University of Southern California
Los Angeles, CA 90089-2564
{yunsongh,jenkins}@sipi.usc.edu

Abstract

We develop an approach for estimation with Gaussian Markov processes
that imposes a smoothness prior while allowing for discontinuities. In-
stead of propagating information laterally between neighboring nodes
in a graph, we study the posterior distribution of the hidden nodes as a
whole—how it is perturbed by invoking discontinuities, or weakening
the edges, in the graph. We show that the resulting computation amounts
to feed-forward fan-in operations reminiscent of V1 neurons. Moreover,
using suitable matrix preconditioners, the incurred matrix inverse and
determinant can be approximated, without iteration, in the same compu-
tational style. Simulation results illustrate the merits of this approach.

1 Introduction

Two issues, (i) efﬁcient representation, and (ii) efﬁcient inference, are of central importance
in the area of statistical modeling of vision problems. For generative models, often the ease
of generation and the ease of inference are two con ﬂicting features. Factor Analysis [1]
and its variants, for example, model the input as a linear superposition of basis functions.
While the generation, or synthesis, of the input is immediate, the inference part is usually
not. One may apply a set of ﬁlters,
e.g., Gabor ﬁlters, to the input image. In so doing,
however, the statistical modeling is only deferred, and further steps, either implicit or ex-
plicit, are needed to capture the ‘code’ carried by those ﬁlter responses. By characterizing
mutual dependencies among adjacent nodes, Markov Random Field (MRF) [2] and graph-
ical models [3] are other powerful ways for modeling the input, which, when continuous,
is often conveniently assumed to be Gaussian. In vision applications, it’s suitable to em-
ploy smoothness priors admitting discontinuities [4]. Examples include weak membranes
and plates [5], formulated in the context of variational energy minimization. Typically, the
inference for MRF or graphical models would incur lateral propagation of information be-
tween neighboring units [6]. This is appealing in the sense that it consists of only simple,
local operations carried out in parallel. However, the resulting latency could undermine the
plausibility that such algorithms are employed in human early vision inference tasks [7].

In this paper we take the weak membrane and plate as instances of Gaussian processes
(GP). We show that the effect of marking each discontinuity (hereafter termed as “bond-

breaking ”) is to perturb the inverse of covariance matrix of the hidden nodes x by a matrix
of rank 1. When multiple bonds are broken, the computation of the posterior mean and
covariance of x would involve the inversion of a matrix, which typically has large con-
dition number, implying very slow convergence in straight-forward iterative approaches.
We show that there exists a family of preconditioners that can bring the condition number
close to 1, thereby greatly speeding up the iteration —to the extent that a single step would
sufﬁce in practice. Therefore, the predominant computation employed in our approach is
noniterative, of fan-in and fan-out style. We also devise ways to learn the parameters re-
garding state and observation noise non-iteratively. Finally, we report experimental results
of applying the proposed algorithm to image-denoising.

2 Perturbing a Gaussian Markov Process (GMP)
Consider a spatially invariant GMP de ﬁned on a torus, x ∼ N (0, Q0 ), whose energy —
de ﬁned as xT Q−1
0 x—is the sum of energies of all edges
1 in the graph, due to the Markovian
property. In what follows, we perturb the potential matrix Q−1
0 by reducing the coupling
energy of certain bonds2 . This relieves the smoothness constraint on the nodes connected
via those bonds.
Suppose the energy reduction of a bond connecting node i and j (whose state vectors are xi
and xj , respectively) can be expressed as (xT
i fi + xT
j fj )2 , where fi and fj are coefﬁcient
vectors. This becomes (xT f )2 , if f is constructed to be a vector of same size as x, with the
only non-zero entries fi and fj corresponding to node i and j . This manipulation can be
0 − f f T , which is equivalent
1 ← Q−1
identi ﬁed with a rank-1 perturbation of Q−1
0 , as Q−1
1 x ← xT Q−1
0 x − (xT f )2 , ∀x. We call this an elementary perturbation of Q−1
to xT Q−1
0 ,
and f an elementary perturbation vector associated with the particular bond.
When L such perturbations have taken place (cf. Fig. 1), we form the L perturbation vectors
into a matrix F1 = [f 1 , . . . , f L ], and then the collective perturbations yield
0 − F1F T
Q−1
= Q−1
1
1
Q1 = Q0 + Q0F1 (I − F T
1 Q0F1 )−1F T
1 Q0 ,
which follows from the Sherman-Morrison-Woodbury Formula (SMWF).

and thus

(1)
(2)

2.1 Perturbing a membrane and a plate

In a membrane model [5], xi is scalar and the energy of the bond connecting xi and xj is
(xi − xj )2/q , where q is a parameter denoting the variance of state noise. Upon perturba-
tion, this energy is reduced to η2 (xi − xj )2 /q , where 0 < η (cid:28) 1 ensures positivity of the
(cid:112)
energy. Then, the energy reduction is (1 − η2 )(xi − xj )2/q , from which we can identify
(1 − η2 )/q and fj = −fi .
fi =
In the case of a plate [5], xi = [ui , uh i , uv i ]T , in which ui represents the intensity, while
uh i and uv i represent its gradient in the horizontal and vertical direction, respectively.
We de ﬁne the energy of a horizontal bond connecting node j and i as E (−,i)
= (uv i −
(cid:21)
(cid:20)
(cid:21)
(cid:21) (cid:20)
(cid:21)
(cid:20)
(cid:20)
0
uv j )2/q + d(−,i) T O−1 d(−,i) , where
1 1
−
d(−,i) =
ui
0 1
uh i

1/3 1/2
1/2
1

and O = q

uj
uh j

,

1Henceforth called bonds, as edge will refer to intensity discontinuity in an image.
2The bond energy remains positive. This ensures the positive deﬁniteness of the potential matrix.

the superscript (−, i) representing horizontal bond to the left of node i. The ﬁrst and sec-
ond term of E (−,i) would correspond to (∂ 2u(h, v)/∂ h∂ v)2/q and (∂ 2u(h, v)/∂ h2)2 /q ,
If E (−,i)
respectively, if u(h, v) is a continuous function of h and v (cf. [5]).
is re-
0
= [(uv i − uv j )2 + (uh i − uh j )2 ]/q , i.e., coupling between node i
duced to E (−,i)
1
(cid:112)
and j exists only through their gradient values, one can show that the energy reduction
= [ui − uj − (uh i + uh j )/2]2 · 12/q . Taking the actual energy reduction to
− E (−,i)
E (−,i)
(cid:112)
0
1
− E (−,i)
12(1 − η2 )/q [1, −1/2, 0]T
be (1 − η2 )(E (−,i)
(−,i) =
), we can identify fi
1
0
12(1 − η2 )/q [−1, −1/2, 0]T , where 0 < η (cid:28) 1 ensures the posi-
(−,i) =
and fj
(cid:112)
tive de ﬁniteness of the resulting potential matrix. A similar procedure can be applied
to a vertical bond in the plate, producing a perturbation vector f (|,i) , whose compo-
(cid:112)
12(1 − η2 )/q[1, 0, −1/2]T and fj
(|,i) =
(|,i) =
nents are zero everywhere except for fi
12(1 − η2 )/q [−1, 0, −1/2]T , for which node j is the lower neighbor of node i.
One can verify that xT f = 0 when the plate assumes the shape of a linear slope, mean-
ing that this perturbation produces no energy difference in such a case. (xT f )2 becomes
signiﬁcant when the perturbed, or broken, bond associated with f straddles across a step
discontinuity of the image. Such an f is thus related to edge detection.

(3)

(6)

where

(4)
(5)

2.2 Hidden state estimation
Standard formulae exist for the posterior covariance K and mean ˆx of x, given a noisy
observation3 y = C x + n, where n ∼ N (0, rI ).
and Kα = [Q−1
α + C T C/r]−1 ,
ˆxα = KαC T y/r,
for either the unperturbed (α = 0) or perturbed (α = 1) process. Thus,
0 + C T C/r − F1F T
K1 = [Q−1
1 ]−1 ,
following Eq. 3 and 1
0 − F1F T
= [K −1
1 ]−1 ,
= K0 + W1H −1
1 W T
applying SMWF,
1 ,
where H1 (cid:44) I − F T
and W1 (cid:44) K0F1
1 K0F1 ,
∴ ˆx1 = K1C T y/r
= K0C T y/r + W1H −1
1 C T y/r = ˆx0 + ˆxc ,
1 W T
ˆxc (cid:44) W1H −1
1 W T
1 C T y/r,
= W1H −1
z 1 = W T
1 z 1 , where
1 C T y/r
(7)
On a digital computer, the above computation can be efﬁciently implemented in the Fourier
domain, despite the huge size of Kα and Qα . For example, K1 equals K0 —a circulant
matrix —plus a rank- L perturbation (cf. Eq. 4). Since each column of W1 is a spatially
shifted copy of a prototypical vector, arising from breaking either a horizontal or a vertical
1 C T y . The computation of H −1
bond, convolution can be utilized in computing W T
is
1
deferred to Section 3. On a neural substrate, however, the computation can be implemented
by inner-products in parallel. For instance, z 1 r is the result of inner-products between
the input y and the feed-forward fan-in weights CW , coded by the dendrites of identical
neurons, each situated at a broken bond. Let v1 = H −1
1 z 1 be the responses of another layer
of neurons. Then C ˆxc = CW v1 amounts to the back-projection of layer v1 to the input
plane with fan-out weights identical to the fan-in counterpart.
We can also apply the above procedure incrementally4, i.e., apply F1 and then F2 , both
consisting of a set of perturbation vectors. Quantities resulting from the α’th perturba-
3The observation matrix C = I for a membrane, and C = I ⊗ [1, 0, 0] for a plate.
4Latency considerations, however, preclude the practicability of fully incremental computation.

0.01

0.005
e
u
l
a
v
 
t
h
g
i
e
W
−0.005

0

−0.01

(a)

(b)

10

15

(c)

20

25

Figure 1: A portion of
MRF. Solid and broken
lines denote intact and
broken bonds, respec-
tively. Open circles de-
note hidden nodes xi
and ﬁlled circles denote
observed nodes yi .

Figure 2: The resulting receptive ﬁeld of the edge detector pro-
duced by breaking the shaded bond shown in Fig. 1. The central
vertical dashed line in (a) and (b) marks the location of the ver-
tical streak of bonds shown as broken in Fig. 1. In (a), those
bonds are not actually broken; in (b), they are. In (c), a central
horizontal slice of (a) is plotted as a solid curve and the coun-
terpart of (b) as a dashed curve.

y, ˆx1
ˆxc
ˆx0

Figure 3: Estimation of x given input y . ˆx0 : by unperturbed rod; ˆx1 : coinciding per-
fectly with y , is obtained by a rod whose two bonds at the step edges of y are broken; ˆxc :
correction term, engendered by the perturbed rod.

tion step can be obtained from those of the (α − 1)’th step, simply by replacing the sub-
script/superscript ‘1’ and ‘0’ with α and α − 1, respectively, in Eqs. 1 to 6. In particular,
(cid:124) (cid:123)(cid:122) (cid:125)
(cid:123)(cid:122)
(cid:124)
(cid:125)
+ W1H −1
W2 = K1F2 = K0F2
1 W T
,
1 F2
(8)
where (cid:102)W2 refers to the weights due to F2 in the absence of perturbation F1 , which, when
g
δW2
W2
indeed existent, would exert a contextual effect on F2 , thereby contributing to the term
δW2 .
membrane model, wherein ‘receptive ﬁeld’ refers to (cid:102)W2 and W2 in the case of panel (a)
Figure 2 illustrates this effect on one perturbation vector (termed ‘edge detector’) in a
and (b), respectively. Evidently, the receptive ﬁeld of W2 across the contextual boundary
is pinched off. Figure 3 shows the estimation of x, cf. Eq. 6 and 7, using a 1D plate, i.e.,
rod. We stress that once the relevant edges are detected, ˆxc is computed almost instantly,
without the need of iterative re ﬁnement via lateral propagation. This could be related to the
brightness ﬁlling-in signal[8].

2.3 Parameter estimation

As edge inference/detection is outside the scope of this paper, we limit our attention to
ﬁnding optimal values for the parameters r and q . Although the EM algorithm is possible

−1

y )/r)/2

for that purpose, we strive for a non-iterative alternative. To that end, we reparameterize r
we have y ∼ N (0, Sα ), where Sα = rI + CQαC T . Note that (cid:102)Sα (cid:44) Sα/r does not
and q into r and  = q/r. Given a possibly perturbed model Mα , in which x ∼ N (0, Qα ),
depend on r when  is ﬁxed, as Qα ∝ q ∝ r =⇒ Sα ∝ r. Next, we aim to maximize the
log-probability of y , which is a vector of N components (or pixels).
˜Jα (cid:44) Lnp(y |Mα ) = −(N Ln(2π) + Ln|Sα | + yT Sα
−1y )/2
= −(N Ln(2π) + N Lnr + Ln|(cid:102)Sα | + (yT (cid:102)Sα
Setting ∂ ˜Jα/∂ r = 0 ⇒ ˆr = Eα/N , where Eα (cid:44) yT (cid:102)Sα
−1
J (cid:44) N LnEα + Ln|(cid:102)Sα | = const. − 2 ˜Jα |ˆr
y
(9)
De ﬁne
(10)
J is a function of  only, and we locate the ˆ that minimizes J as follows. Prompted by the
fact that  governs the spatial scale of the process [5] and scale channels exist in primate
visual system, we compute J () for a preselected set of , corresponding to spatial scales
half-octave apart, and then ﬁt the resulting J ’s with a cubic polynomial, whose location of
minimum suggests ˆ. We use this approach in Section 4.
Computing J in Eq. 10 needs two identities, which are included here without proof (the
second can be proven by using SMWF and its associated determinant identity): Eα =
yT (y − C ˆxα ) (cf. Appendix A of [5]), and |S0 |/|Sα | = |Bα |/|Hα |, where
Hα = I − Fα
and Bα (cid:44) I − Fα
is, Eα can be readily obtained once ˆxα has been estimated, and |(cid:102)Sα | =
T K0Fα ,
T Q0Fα
(11)
|(cid:102)S0 ||Hα |/|Bα |, in which |(cid:102)S0 | can be calculated in the spectral domain, as S0 is circulant.
That
The computation of |Hα | and |Bα | is dealt with in the next section.

3 Matrix Preconditioning

Some of the foregoing computation necessitates matrix determinant and matrix inverse,
e.g., H −1 z 1 (cf. Eq. 7). Because H is typically poorly conditioned, plain iterative means to
evaluate H −1 z a would converge very slowly. Methods exist in the literature for ﬁnding a
matrix P ([9] and references therein) satisfying the following two criteria: (1) inverting P
is easy; (2) the condition number κ(P −1H ) approaches 1. Ideally, κ(P −1H ) = 1 implies
P = H . Here we summarize our ﬁndings regarding the best class of preconditioners when
H arises from some prototypical con ﬁgurations of bond breaking. We call the following
procedure Approximate Diagonalization (AD).

(1) ‘DFT’. When a streak of broken bonds forms a closed contour, with a consistent polarity
convention (e.g., the excitatory region of the receptive ﬁeld of the edge detector associated
with each bond lies inside the enclosed region), H and B (cf. Eq. 11) are approximately cir-
ii , then (cid:101)H = X ΛH X †
culant. Let X be the unitary Fourier matrix of same size as H , then H e = X †H X would
(cid:81)
be approximately diagonal. Let ΛH be diagonal: ΛH ij = δij H e
is
i ΛH ii approximates |H |; X ΛH
−1X †
a circulant matrix approximating H ;
approx-
−1X †z 1 , which
imates H −1 . In this way, a computation such as H −1 z 1 becomes X ΛH
weight vector. The quality of this preconditioner (cid:101)H can be evaluated by both the condition
amounts to simple fan-in and fan-out operations, if we regard each column of X as a fan-in
number κ( (cid:101)H −1H ) and the relative error between the inverse matrices:
 (cid:44) k (cid:101)H −1 − H −1kF /kH −1kF ,
(12)
where k (cid:5) kF denotes Frobenius norm. The same X can approximately diagonalize B , and
the product of the diagonal elements of the resulting matrix approximates |B |.

(2) ‘DCST’. One end of the streak of broken bonds (target contour) abuts another contour,
and the other end is open (i.e., line-end). Imagine a vibrational mode of the membrane/plate
given the con ﬁguration of broken bonds. The vibrational contrast of the nodes across the
broken bond at a line-end has to be small, since in the immediate vicinity there exist paths
of intact bonds linking the two nodes. This suggests a Dirichlet boundary condition at
the line-end. At the abutting end (i.e., a T-junction), however, the vibrational contrast can
be large, since the nodes on different sides of the contour are practically decoupled. This
suggests a von Neumann boundary condition. This analysis leads to using a transform
(termed ‘HSWA’ in [10]) which we call ‘DCST’, denoting sine phase at the open end and
√
cosine phase at the abutting end. The unitary transform matrix X is given by: Xi,j =
2L + 1 cos(π(i − 1/2)(j − 1/2)/(L + 1/2)), 1 ≤ i, j ≤ L, where L is the number of
2
broken bonds in the target contour.
(cid:112)
(3) ‘DST’. When the streak of broken bonds form an open-ended contour, H can be approx-
imately diagonalized by Sine Transform (cf. the intuitive rationale stated in case (2)), of
which the unitary transform matrix X is given by: Xi,j =
2/(L + 1) sin(πij /(L + 1)),
1 ≤ i, j ≤ L.
For a ‘clean’ prototypical contour, the performance of such preconditioners is remarkable,
typically producing 1 ≤ κ < 1.2 and  < 0.05. When contours in the image are intercon-
nected in a complex way, we ﬁrst parse the image domain into non-overlapping enclosed
regions, and then treat each region independently. A contour segment dividing two re-
gions is shared between them, and thus would contribute two copies, each belonging to one
region[11].

4 Experiment

We test our approach on a real image (Fig. 4a), which is corrupted with three increasing
levels of white Gaussian noise: SNR = 4.79db (Fig. 4b), 3.52db, and 2.34db. Our task is to
estimate the original image, along with ﬁnding optimal q and r. We used both membrane
and plate models, and in each case we used both the ‘direct’ method, which directly com-
putes H −1 in Eq. 7 and |H |/|B | required in Eq. 10, and the ‘AD’ method, as described in
Section 3, to compute those quantities in approximation.

We ﬁrst apply a Canny detector to generate an edge map (Fig. 4g) for each noisy image,
which is then converted to broken bonds. The large number (over 104 ) of broken bonds
makes the direct method impractical. In order to attain a ‘direct’ result, we partition the
image domain into a 5 × 5 array of blocks (one such block is delineated by the inner
square in Fig. 4g), and focus on each of them in turn by retaining edges not more than 10
pixels from the target block (this block’s outer scope is delineated with the outer square in
Fig. 4g). When ˆx is inferred given this partial edge map, only its pixels within the block
are considered valid and are retained. We mosaic up ˆx from all those blocks to get the
complete inferred image. In ‘AD’, we parse the contours in each block and apply different
diagonalizers accordingly, as summarized in Section 3. The performance of the three types
of AD is plotted in Fig. 5, from which it is evident that in majority of cases κ < 1.5 and
 ≤ 10%. Fig. 4e and f illustrate the procedure to ﬁnd optimal q/r for a membrane and a
plate, respectively, as explained in Section 2.3. Note how good the cubic polynomial ﬁt is,
and that the results of AD do not deviate much from those of the direct (rigorous) method.
Fig. 4c and 4d show ˆx by a perturbed and intact membrane model, respectively. Notice that
the edges, for instance around Lena’s shoulder and her hat, in Fig. 4d are more smeared
than those in Fig. 4c (cf. Fig. 3). Table 1 summarizes the value of optimal q/r and Mean-
Squared-Error (MSE). Our results compare favorably with those listed in the last column
of the table, which is excerpted from [12].

(a)

(d)

direct
cubic fit
AD
cubic fit
extremum

(b)

x 104

5

4.8

4.6

J

4.4

4.2

4

3.8

0.1

q/r
(e)

(c)

x 104

5.5

5

J

4.5

4

1

0.01

0.1

1

q/r
(f)

Figure 4: (a) Original image, (b) noisy image. Estimation by (c) a
perturbed membrane, and (d) an intact membrane. The criterion func-
tion of varying q/r for (e) perturbed membrane, and (f) perturbed plate,
which shares the same legend as in (e). (g) Canny edge map.

(g)

κ

2.2

2

1.8

1.6

1.4

0.2

0.15

0

20

40

200

400

2

1.5

1

0

0.2

0.15

0.1

0.05



0.1

0.05

0

0

10

20

30

0

0

(a)
DFT

200

100
(b)
DST

3

2.5

2

1.5

1

0

0.25

0.2

0.15

0.1

0.05

0

0

Figure 5: Histograms
of condition number
κ
after
precondi-
tioning, and relative
error  as de ﬁned in
illustrating
Eq. 12,
performance
the
preconditioners,
of
DFT,
DST,
and
DCST, on their
re-
spective
datasets.
Horizontal axes in-
dicate the number of
occurrences in each
bin.

50

100

100

50
(c)
DCST

Table 1: Optimal q/r and MSE.
plate model
membrane model
direct
direct
AD
q/r
q/r
MSE
MSE
0.456
92
0.067
100
111
0.044
104
0.299
0.217
115
0.033
119

q/r
0.444
0.311
0.233

MSE
92
104
115

AD

q/r
0.075
0.049
0.031

Improved
Entropic [12]
MSE
121
138
166

MSE
98
108
121

SNR

4.79
3.52
2.34

5 Conclusions

We have shown how the estimation with perturbed Gaussian Markov processes—hidden
state and parameter estimation —can be carried out in non-iterative way. We have adopted
a holistic viewpoint. Instead of focusing on each individual hidden node, we have taken
each process as an entity under scrutiny. This paradigm shift changes the way information
is stored and represented —from the scenario where the global pattern of the process is
embodied entirely by local couplings to the scenario where fan-in and fan-out weigths, in
addition to local couplings, re ﬂect the patterns of larger scales.

Although edge detection has not been treated in this paper, our formulation is capable of
doing so, and our preliminary results are encouraging. It may be premature at this stage to
translate the operations of our model to neural substrate; we speculate nevertheless that our
approach may have relevance to understanding biological visual systems.

Acknowledgments

This work was supported in part by the TRW Foundation, ARO (Grant Nos. DAAG55-98-
1-0293 and DAAD19-99-1-0057), and DARPA (Grant No. DAAD19-0010356).
References
[1] Z. Ghahramani and M.J. Beal. Variational inference for Bayesian mixtures of factor analysers.
In Advances in Neural Information Processing Systems, volume 12. MIT Press, 2000.
[2] S.Z. Li. Markov Random Field Modeling in Computer Vision. Springer-Verlag, 1995.
[3] M.I. Jordan, Z. Ghahramani, T.S. Jaakkola, and L.K. Saul. An introduction to variational meth-
ods for graphical models. Machine Learning, 37:183–233, 1999.
[4] F. C. Jeng and J. W. Woods. Compound Gauss-Markov random ﬁelds for image estimation.
IEEE Trans. on Signal Processing , 39(3):683–697, 1991.
[5] A. Blake and A. Zisserman. Visual Reconstruction. MIT Press, 1987.
[6] J.S. Yedidia, W.T. Freeman, and Y. Weiss. Bethe free energy, kikuchi approximations, and
belief propagation algorithms. Technical Report TR2001-16, MERL, May 2001.
[7] S. Thorpe, D. Fize, and C. Marlot. Speed of processing in the human visual system. Nature,
381:520–522, 1996.
[8] L. Pessoa and P. De Weerd, editors. Filling-in: From Perceptual Completion to Cortical Reor-
ganization. Oxford: Oxford University Press, 2003.
[9] R. Chan, M. Ng, and C. Wong. Sine transform based preconditioners for symmetric toeplitz
systems. Linear Algebra and its Applications, 232:237–259, 1996.
[10] S. A. Martucci. Symmetric convolution and the discrete sine and cosine transforms.
Trans. on Signal Processing, 42(5):1038–1051, May 1994.
[11] H. Zhou, H. Friedman, and R. von der Heydt. Coding of border ownership in monkey visual
cortex. J. Neuroscience, 20(17):6594–6611, 2000.
[12] A. Ben Hamza, H. Krim, and G. B. Unal. Unifying probabilistic and variational estimation.
IEEE Signal Processing Magazine, pages 37–47, September 2002.

IEEE

