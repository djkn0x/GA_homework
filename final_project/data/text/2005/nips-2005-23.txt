Gradient Flow Independent Component
Analysis in Micropower VLSI

Abdullah Celik, Milutin Stanacevic and Gert Cauwenberghs
Johns Hopkins University, Baltimore, MD 21218
{acelik,miki,gert}@jhu.edu

Abstract

We present micropower mixed-signal VLSI hardware for real-time blind
separation and localization of acoustic sources. Gradient ﬂow represen-
tation of the traveling wave signals acquired over a miniature (1cm di-
ameter) array of four microphones yields linearly mixed instantaneous
observations of the time-differentiated sources, separated and localized
by independent component analysis (ICA). The gradient ﬂow and ICA
processors each measure 3mm × 3mm in 0.5 µm CMOS, and consume
54 µW and 180 µW power, respectively, from a 3 V supply at 16 ks/s
sampling rate. Experiments demonstrate perceptually clear (12dB) sep-
aration and precise localization of two speech sources presented through
speakers positioned at 1.5m from the array on a conference room table.
Analysis of the multipath residuals shows that they are spectrally diffuse,
and void of the direct path.

1 Introduction

Time lags in acoustic wave propagation provide cues to localize an acoustic source from
observations across an array. The time lags also complicate the task of separating multiple
co-existing sources using independent component analysis (ICA), which conventionally
assumes instantaneous mixture observations.
Inspiration from biology suggests that for very small aperture (spacing between acoustic
sensors i.e., tympanal membranes), small differences (gradients) in sound pressure level
are more effective in resolving source direction than actual (microsecond scale) time dif-
ferences. The remarkable auditory localization capability of certain insects at a small (1%)
fraction of the wavelength of the source owes to highly sensitive differential processing
of sound pressure through inter-tympanal mechanical coupling [1] or inter-aural coupled
neural circuits [2].
We present a mixed-signal VLSI system that operates on spatial and temporal differences
(gradients) of the acoustic ﬁeld at very small aperture to separate and localize mixtures of
traveling wave sources. The real-time performance of the system is characterized through
experiments with speech sources presented through speakers in a conference room setting.

Figure 1: (a) Gradient ﬂow principle. At low aperture, interaural level differences (ILD)
and interaural time differences (ITD) are directly related, scaled by the temporal derivative
of the signal.
(b) 3-D localization (azimuth θ and elevation φ) of an acoustic source using
a planar geometry of four microphones.

2 Gradient Flow Independent Component Analysis

Gradient ﬂow [3, 4] is a signal conditioning technique for source separation and localization
suited for arrays of very small aperture, i.e., of dimensions signiﬁcantly smaller than the
shortest wavelength in the sources. The principle is illustrated in Figure 1 (a). Consider a
traveling acoustic wave impinging on an array of four microphones, in the conﬁguration of
Figure 1 (b). The 3-D direction cosines of the traveling wave u are implied by propagation
delays τ1 and τ2 in the source along directions p and q in the sensor plane. Direct measure-
ment of these delays is problematic as they require sampling in excess of the bandwidth
of the signal, increasing noise ﬂoor and power requirements. However, indirect estimates
of the delays are obtained, to ﬁrst order, by relating spatial and temporal derivatives of the
acoustic ﬁeld:

ξ10 (t) ≈ τ1
ξ01 (t) ≈ τ2

˙ξ00 (t)
˙ξ00 (t)

(1)

where ξ10 and ξ01 represent spatial gradients in p and q directions around the origin (p =
q = 0), ξ00 the spatial common mode, and ˙ξ00 its time derivative. Estimates of ξ00 , ξ10 and
(cid:161)
(cid:162)
ξ01 for the sensor geometry of Figure 1 can be obtained as:
(cid:162)
(cid:161)
ξ00 ≈ 1
(cid:162)
(cid:161)
x−1,0 + x1,0 + x0,−1 + x0,1
4
x1,0 − x−1,0
ξ10 ≈ 1
2
ξ01 ≈ 1
x0,1 − x0,−1
2

(2)

A single source can be localized by estimating direction cosines τ1 and τ2 from (1), a
principle known for years in monopulse radar, exploited by parasite insects [1], and imple-
mented in mixed-signal VLSI hardware [6]. As shown in Figure 1 (b), the planar geometry
of four microphones allows to localize a source in 3-D, with both azimuth and elevation 1 .
More signiﬁcantly, multiple coexisting sources s(cid:96) (t) can be jointly separated and localized

1An alternative using two microphones, exploiting shape of the pinna, is presented in [5]

s(t)uqfx10x-10x01x0-1t2t1ttt ssITDILDs(t+t)s(t)(a)(b)s(t)uqfx10x-10x01x0-1t2t1s(t)uqfx10x-10x01x0-1t2t1ttt ssITDILDs(t+t)s(t)ttt ssITDILDs(t+t)s(t)(a)(b)(cid:88)
using essentially the same principle [3, 4]:
(cid:88)
(cid:96)
(cid:88)
(cid:96)
(cid:96)

ξ10 (t) =

ξ00 (t) =

s(cid:96) (t) + ν00 (t)

1 ˙s(cid:96) (t) + ν10 (t)
τ (cid:96)

(3)

,

(4)

1
τ L
1
τ L
2

ξ01 (t) =

2 ˙s(cid:96) (t) + ν01 (t)
τ (cid:96)
where ν00 , ν10 and ν01 represent common mode and spatial derivative components of ad-
 +
 ˙s1
ditive noise in the sensor observations. Taking the time derivative of ξ00 , we thus obtain

 1
 ≈
 ˙ξ00
(cid:34) ˙ν00
(cid:35)
from the sensors a linear instantaneous mixture of the time-differentiated source signals,
· · ·
· · ·
...
τ 1
ν10
ξ10
· · ·
1
τ 1
ν01
ξ01
˙sL
2
an equation in the standard form x = As + n, where x is given and the mixing matrix A
and sources s are unknown. Ignoring the noise term n, the problem setting is standard in
Independent Component Analysis (ICA), and three independent sources can be identiﬁed
from the three gradient observations.
Various formulations of ICA exist to arrive at estimates of the unknown s and A from
observations x. ICA algorithms typically specify some sort of statistical independence as-
sumption on the sources s either in distribution over amplitude [7] or over time [8]. Most
forms specify ICA to be static, in assuming that the observations contain static (instan-
taneous) linear mixtures of the sources. Note that this deﬁnition of static ICA includes
methods for blind source separation that make use of temporal structure in the dynamics
within the sources themselves [8], as long as the observed mixture of the sources is static.
In contrast, ‘convolutive’ ICA techniques explicitly assume convolutive or delayed mix-
tures in the source observations. Convolutive ICA techniques (e.g., [10]) are usually much
more involved and require a large number of parameters and long adaptation time horizons
for proper convergence.
(cid:80)
The instantaneous static formulation of gradient ﬂow (4) is convenient,2 and avoids the need
for non-static (convolutive) ICA to separate delayed mixtures of traveling wave sources (in
(cid:96) s(cid:96) (t + pτ1 + qτ2 ). Reverberation in multipath wave propagation
free space) xpq (t) =
contributes delayed mixture components in the observations which limit the effectiveness
of a static ICA formulation. As shown in the experiments below, static ICA still produces
reasonable results (12 dB of perceptually clear separation) in typical enclosed acoustic
environments (conference room).

3 Micropower VLSI Implementation

Various analog VLSI implementations of ICA exist in the literature, e.g.,
[11, 12], and
digital implementations using DSP are common practice in the ﬁeld. By adopting a mixed-
signal architecture in the implementation, we combine advantages of both approaches: an
analog datapath directly interfaces with inputs and outputs without the need for data con-
version; and digital adaptation offers the ﬂexibility of reconﬁgurable ICA learning rules.

2The time-derivative in the source signals (4) is immaterial, and can be removed by time-
integrating the separated signals obtained by applying ICA directly to the gradient ﬂow signals.

Figure 2: (a) Gradient ﬂow processor. (b) Reconﬁgurable ICA processor.
Dimensions of both processors are 3mm × 3mm in 0.5 µm CMOS technology.

Figure 3: Reconﬁgurable mixed-signal ICA architecture implementing general outer-
product forms of ICA update rules.

3.1 Gradient Flow Processor

The mixed-signal VLSI processor implementing gradient ﬂow is presented in [6]. A micro-
graph of the chip is shown in Figure 2 (a). Precise analog gradients ˙ξ00 , ξ10 and ξ01 are ac-
quired from the microphone signals by correlated double sampling (CDS) in fully differen-
tial switched-capacitor circuits. Least-mean-squares (LMS) cancellation of common-mode
leakage in the gradient signals further increases differential sensitivity. The adaptation
is performed in the digital domain using counting registers, and couples to the switched-
capacitor circuits using capacitive multiplying DAC arrays. An additional stage of LMS
adaptation produces digital estimates of direction cosines τ1 and τ2 for a single source.
In the present setup this stage is bypassed, and the common-mode corrected gradient sig-
nals are presented as inputs to the ICA chip for localization and separation of up to three
independent sources.

3.2 Reconﬁgurable ICA Processor

A general mixed-signal parallel architecture, that can be conﬁgured for implementation of
various ICA update rules in conjunction with gradient ﬂow, is shown in Figure 3 [9]. Here

LMS REGISTERSLMS REGISTERSMULTIPLYING DACMULTIPLYING DACxxxx00xxxx00.xxxx10xxxx01tttt1tttt2W31W32W33W21W22W23W11W12W13S/H OUTPUT BUFFERSICA REGISTERSMULTIPLYING DAC(a)(b)LMS REGISTERSLMS REGISTERSMULTIPLYING DACMULTIPLYING DACxxxx00xxxx00.xxxx10xxxx01tttt1tttt2W31W32W33W21W22W23W11W12W13S/H OUTPUT BUFFERSICA REGISTERSMULTIPLYING DAC(a)(b)W11W12W13W21W22W23W31W32W33x1x2x3y1y2y3update bitsupdate bitsWijxiyjlevel comparisonlevel comparisonoutput bits-1, 0, +1C-1, 0, +1mwe brieﬂy illustrate the architecture with a simple conﬁguration designed to separate two
sources, and present CMOS circuits that implement the architecture. The micrograph of
the reconﬁgurable ICA chip is shown in Figure 2 (a).

3.2.1 ICA update rule

Efﬁcient implementation in parallel architecture requires a simple form of the update rule,
that avoids excessive matrix multiplications and inversions. A variety of ICA update algo-
rithms can be cast in a common, unifying framework of outer-product rules [9].
To obtain estimates y = ˆs of the sources s, a linear transformation with matrix W is applied
to the gradient signals x, y = Wx. Diagonal terms are ﬁxed wii ≡ 1, and off-diagonal
terms adapt according to

i (cid:54)= j
∆wij = −µ f (yi )g(yj ),
The implemented update rule can be seen as the gradient of InfoMax [7] multiplied by
WT , rather than the natural gradient multiplication factor WT W. To obtain the full nat-
ural gradient in outer-product form, it is necessary to include a back-propagation path in
the network architecture, and thus additional silicon resources, to implement the vector
contribution yT . Other equivalences with standard ICA algorithms are outlined in [9].

(5)

3.2.2 Architecture

Level comparison provides implementation of discrete approximations of any scalar func-
tion f (y) and g(y) appearing in different learning rules. Since speech signals are approxi-
mately Laplacian distributed, the nonlinear scalar function f (y) is approximated by sign(y)
and implemented using single bit quantization. Conversely, a linear function g(y) ≡ y in
the learning rule is approximated by a 3-level staircase function (−1, 0, +1) using 2-bit
quantization. The quantization of the f and g terms in the update rule (5) simpliﬁes the
implementation to that of discrete counting operations.
The functional block diagram of a 3 × 3 outer-product incremental ICA architecture, sup-
porting a quantized form of the general update rule (5), is shown in Figure 3 [9]. Un-mixing
coefﬁcients are stored digitally in each cell of the architecture. The update is performed
locally by once or repeatedly incrementing, decrementing or holding the current value of
counter based on the learning rule served by the micro-controller. The 8 most signiﬁcant
bits of the 14-bit counter holding and updating the coefﬁcients are presented to a multi-
plying D/A capacitor array [6] to linearly unmix the separated signal. The remaining 6
bits in the coefﬁcient registers provide ﬂexibility in programming the update rate to tailor
convergence.

3.2.3 Circuit implementation

As in the implementation of the gradient ﬂow processor [6], the mixed-signal ICA archi-
tecture is implemented using fully differential switched-capacitor sampled-data circuits.
Correlated double sampling performs common mode offset rejection and 1/f noise reduc-
tion. An external micro-controller provides ﬂexibility in the implementation of different
learning rules. The ICA architecture is integrated on a single 3mm × 3mm chip fabricated
in 0.5 µm 3M2P CMOS technology.
The block diagram of ICA prototype in Figure 3 indicates its main functionality is a
vector(3x1)-matrix(3x3) multiplication with adaptive matrix elements.
Each cell in the implemented architecture contains a 14-bit counter, decoder and D/A ca-
pacitor arrays. Adaptation is performed in outer-product fashion by incrementing, decre-
menting or holding the current value of the counters. The most signiﬁcant 8 bits of the

Figure 4: Correlated double sampling (CDS) switched-capacitor fully differential circuits
implementing linearly weighted summing in the mixed-signal ICA architecture.

Figure 5: Experimental setup for separation of two acoustic sources in a conference room
enviroment.

counter are presented to the multiplying D/A capacitor arrays to construct the source es-
timation. Figure 4 shows the circuits one output component in the architecture, linearly
summing the input contributions. The implementation of the multiplying capacitor arrays
are identical to those discussed in [6]. Each output signal yi is is computed by accumulat-
ing outputs from the all the cells in the ith row. The accumulation is performed on C2 by
switch-cap ampliﬁer yielding the estimated signals during Φ2 phase. While the estimation
+ is sampled at ˆΦ1 by the comparator circuit. The sign of the com-
signals are valid, yi
parison of yi with variable level threshold Vth is computed in the evaluate phase, through
capacitive coupling into the ampliﬁer input node.

4 Experimental Results

To demonstrate source separation and localization in a real environment, the mixed-signal
VLSI ASICs were interfaced with four omnidirectional miniature microphones (Knowles
FG-3629), arranged in a circular array with radius 0.5 cm. At the front-end, the microphone
signals were passed through second-order bandpass ﬁlters with low-frequency cutoff at
130 Hz and high-frequency cutoff at 4.3 kHz. The signals were also ampliﬁed by a factor
of 20.
The experimental setup is shown in Figure 5. The speech signals were presented through
loudspeakers positioned at 1.5 m distance from the array. The system sampling frequency
of both chips was set to 16 kHz. A male and female speakers from TIMIT database were
chosen as sound sources. To provide the ground truth data and full characterization of the
systems, speech segments were presented individually through either loudspeaker at differ-
ent time instances. The data was recorded for both speakers, archived, and presented to the

C2C2(cid:1)1(cid:1)1(cid:1)1e(cid:1)1e(cid:1)2(cid:1)2(cid:2)(cid:1)2VrefAA(cid:2)ffffffyi+(cid:2)yi-(cid:1)1eA(cid:2)f^(cid:1)1(cid:2)f^(cid:1)2(cid:2)f^C3C4VthC3(cid:1)1eA(cid:2)f^sgn(yi-Vth)(cid:13)xj-xj+WijC(1-Wij)C(1-Wij)CWijC1.5 m1.5 m1 cm1.5 m1.5 m1 cmFigure 6: Time waveforms and spectrograms of the presented sources s1 and s2 , observed
common-mode and gradient signals ξ00 , ξ10 and ξ01 by the gradient ﬂow chip, and recov-
ered sources ˆs1 and ˆs2 by the ICA chip.

Table 1: Localization Performance

Single-source LMS localization
Dual-source ICA localization

Male speaker
-31.11
-30.35

Female speaker
40.95
43.55

gradient ﬂow chip. Localization results obtained by gradient ﬂow chip through LMS adap-
tation are reported in Table 1. The two recorded datasets were then added, and presented to
the gradient ﬂow ASIC. The gradient signals obtained from the chip were then presented
to the ICA processor, conﬁgured to implement the outerproduct update algorithm in (5).
The observed convergence time was around 2 seconds. From the recorded 14-bit digital
weights, the angles of incidence of the sources relative to the array were derived. These
estimated angles are reported in Table 1. As seen, the angles obtained through LMS bear-
ing estimation under individual source presentation are very close to the angles produced
by ICA under joint presentation of both sources. The original sources and the recorded
source signal estimates, along with recorded common-mode signal and ﬁrst-order spatial
gradients, are shown in Figure 6.

5 Conclusions

We presented a mixed-signal VLSI system that operates on spatial and temporal differences
(gradients) of the acoustic ﬁeld at very small aperture to separate and localize mixtures of
traveling wave sources. The real-time performance of the system was characterized through
experiments with speech sources presented through speakers in a conference room setting.
Although application of static ICA is limited by reverberation, the perceptual quality of the
separated outputs owes to the elimination of the direct path in the residuals. Miniature size
of the microphone array enclosure (1 cm diameter) and micropower consumption of the
VLSI hardware (250 µW) are key advantages of the approach, with applications to hearing

0(cid:13)1(cid:13)2(cid:13)3(cid:13)5(cid:13)0(cid:13)5(cid:13)x(cid:13)00(cid:13)Frequency(cid:13)0(cid:13)1(cid:13)2(cid:13)x 10(cid:13)4(cid:13)0(cid:13)0.5(cid:13)1(cid:13)0(cid:13)1(cid:13)2(cid:13)3(cid:13)2(cid:13)0(cid:13)2(cid:13)x(cid:13)10(cid:13)Frequency(cid:13)0(cid:13)1(cid:13)2(cid:13)x 10(cid:13)4(cid:13)0(cid:13)0.5(cid:13)1(cid:13)0(cid:13)1(cid:13)2(cid:13)3(cid:13)2(cid:13)0(cid:13)2(cid:13)x(cid:13)01(cid:13)Frequency(cid:13)0(cid:13)1(cid:13)2(cid:13)x 10(cid:13)4(cid:13)0(cid:13)0.5(cid:13)1(cid:13)0(cid:13)1(cid:13)2(cid:13)3(cid:13)1(cid:13)0(cid:13)1(cid:13)s(cid:13)1(cid:13)Frequency(cid:13)0(cid:13)1(cid:13)2(cid:13)x 10(cid:13)4(cid:13)0(cid:13)0.5(cid:13)1(cid:13)0(cid:13)1(cid:13)2(cid:13)3(cid:13)1(cid:13)0(cid:13)1(cid:13)s(cid:13)2(cid:13)Time (s)(cid:13)Time(cid:13)Frequency(cid:13)0(cid:13)1(cid:13)2(cid:13)x 10(cid:13)4(cid:13)0(cid:13)0.5(cid:13)1(cid:13)^^aids, conferencing, multimedia, and surveillance.

Acknowledgments

This work was supported by grants of the Catalyst Foundation (New York), the National
Science Foundation, and the Defense Intelligence Agency.

References
[1] D. Robert, R.N. Miles, and R.R. Hoy, “Tympanal Hearing in the Sarcophagid Para-
sitoid Fly Emblemasoma sp.: the Biomechanics of Directional Hearing,” J. Experi-
mental Biology, vol. 202, pp 1865-1876, 1999.
[2] R. Reeve and B. Webb, “New neural circuits for robot phonotaxis”, Philosophical
Transactions of the Royal Society A, vol. 361, pp. 2245-2266, 2002.
[3] G. Cauwenberghs, M. Stanacevic, and G. Zweig, “Blind Broadband Source Localiza-
tion and Separation in Miniature Sensor Arrays,” Proc. IEEE Int. Symp. Circuits and
Systems (ISCAS’2001), Sydney, Australia, May 6-9, 2001.
[4] J. Barr `ere and G. Chabriel, “A Compact Sensor Array for Blind Separation of Sources”,
IEEE Transactions Circuits and Systems, Part I, vol. 49 (5), pp. 565-574, 2002.
[5] J.G. Harris, C.-J. Pu, J.C. Principe, “A Neuromorphic Monaural Sound Localizer,”
Proc. Neural Inf. Proc. Sys. (NIPS*1998), Cambridge MA: MIT Press, vol. 10, pp.
692-698, 1999.
[6] G. Cauwenberghs and M. Stanacevic, “Micropower Mixed-Signal Acoustic Localizer,”
Proc. IEEE Eur. Solid State Circuits Conf. (ESSCIRC’2003), Estoril Portugal, Sept. 16-
18, 2003.
[7] A.J. Bell and T.J. Sejnowski, “An Information Maximization Approach to Blind Sepa-
ration and Blind Deconvolution,” Neural Comp, vol. 7 (6), pp 1129-1159, Nov 1995.
[8] L. Molgedey and G. Schuster, “Separation of a mixture of independent signals using
time delayed correlations,” Physical Review Letters, vol. 72, no. 23, pp. 3634–3637,
1994.
[9] A. Celik, M. Stanacevic and G. Cauwenberghs, “Mixed-Signal Real-Time Adaptive
Blind Source Separation,” Proc. IEEE Int. Symp. Circuits and Systems (ISCAS’2004),
Vancouver Canada, May 23-26, 2004.
[10] R. Lambert and A. Bell, “Blind separation of multiple speakers in a multipath envi-
ronment,” Proc. ICASSP’97, M ¨unich, 1997.
[11] Cohen, M.H., Andreou, A.G. “Analog CMOS Integration and Experimentation with
an Autoadaptive Independent Component Analyzer,” IEEE Trans. Circuits and Systems
II, vol 42 (2), pp 65-77, Feb. 1995.
[12] Gharbi, A.B.A., Salam, F.M.A. “Implementation and Test Results of a Chip for the
Separation of Mixed Signals,” Proc. Int. Symp. Circuits and Systems (ISCAS’95), May
1995.
[13] M. Cohen and G. Cauwenberghs, “Blind Separation of Linear Convolutive Mixtures
through Parallel Stochastic Optimization,” Proc. IEEE Int. Symp. Circuits and Systems
(ISCAS’98), Monterey CA, vol. 3, pp. 17-20, 1998.

