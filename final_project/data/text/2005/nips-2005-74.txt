Integrate-and-Fire models with adaptation are
good enough: predicting spike times under
random current injection

Renaud Jolivet(cid:3)
Brain Mind Institute, EPFL
CH-1015 Lausanne, Switzerland
renaud.jolivet@ep(cid:3).ch

Alexander Rauch
MPI for Biological Cybernetics
D-72012 T ¤ubingen, Germany
alexander.rauch@tuebingen.mpg.de

Hans-Rudolf L ¤uscher
Institute of Physiology
CH-3012 Bern, Switzerland
luescher@pyl.unibe.ch

Wulfram Gerstner
Brain Mind Institute, EPFL
CH-1015 Lausanne, Switzerland
wulfram.gerstner@ep(cid:3).ch

Abstract

Integrate-and-Fire-type models are usually criticized because of their
simplicity. On the other hand, the Integrate-and-Fire model is the ba-
sis of most of the theoretical studies on spiking neuron models. Here,
we develop a sequential procedure to quantitatively evaluate an equiv-
alent Integrate-and-Fire-type model based on intracellular recordings of
cortical pyramidal neurons. We (cid:2)nd that the resulting effective model
is suf(cid:2)cient to predict the spike train of the real pyramidal neuron with
high accuracy. In in vivo-like regimes, predicted and recorded traces are
almost indistinguishable and a signi(cid:2)cant part of the spikes can be pre-
dicted at the correct timing. Slow processes like spike-frequency adapta-
tion are shown to be a key feature in this context since they are necessary
for the model to connect between different driving regimes.

1

Introduction

In a recent paper, Feng [1] was questioning the (cid:147)goodness(cid:148) of the Integrate-and-Fire model
(I&F). This is a question of importance since the I&F model is one of the most commonly
used spiking neuron model in theoretical studies as well as in the machine learning com-
munity (see [2-3] for a review). The I&F model is usually criticized in the biological
community because of its simplicity. It is believed to be much too simple to capture the
(cid:2)ring dynamics of real neurons beyond a very rough and conceptual description of input
integration and spikes initiation.
Nevertheless, recent years have seen several groups reporting that this type of model yields
quantitative predictions of the activity of real neurons. Rauch and colleagues have shown
that I&F-type models (with adaptation) reliably predict the mean (cid:2)ring rate of cortical

(cid:3) homepage: http://icwww.ep(cid:3).ch/(cid:24)rjolivet

pyramidal cells [4]. Keat and colleagues have shown that a similar model is able to predict
almost exactly the timing of spikes of neurons in the visual pathway [5]. However, the
question is still open of how the predictions of I&F-type models compare to the precise
structure of spike trains in the cortex. Indeed, cortical pyramidal neurons are known to
produce spike trains whose reliability highly depends on the input scenario [6].
The aim of this paper is twofold. Firstly, we will show that there exists a systematic way
to extract relevant parameters of an I&F-type model from intracellular recordings. To do
so, we will follow the method exposed in [7] and which is based on optimal (cid:2)ltering tech-
niques. Alternative approaches like maximum-likelihood methods exist and have been ex-
plored recently by Paninski and colleagues [8]. Note that both approaches had already been
mentioned by Brillinger and Segundo [9]. Secondly, we will show by a quantitative evalu-
ation of the model performances that the quality of simple threshold models is surprisingly
good and is close to the intrinsic reliability of real neurons. We will try to convince the
reader that, given the addition of a slow process, the I&F model is in fact a model that can
be considered good enough for pyramidal neurons of the neocortex under random current
injection.

2 Model and Methods

We started by collecting recordings. Layer 5 pyramidal neurons of the rat neocortex were
recorded intracellularly in vitro while stimulated at the soma by a randomly (cid:3)uctuating cur-
rent generated by an Ornstein-Uhlenbeck (OU) process with a 1 ms autocorrelation time.
Both the mean (cid:22)I and the variance (cid:27) 2
I of the OU process were varied in order to sample the
response of the neurons to various levels of tonic and noisy inputs. Details of the experi-
mental procedure can be found in [4]. A subset of these recordings was used to construct,
separately for each recorded neuron, a generalized I&F-type model that we formulated in
the framework of the Spike Response Model [3].

2.1 De(cid:2)nition of the model

The Spike Response Model (SRM) is written
u(t) = (cid:17)(t (cid:0) ^t) + Z +1
0
with u the membrane voltage of the neuron and I the external driving current. The kernel
(cid:20) models the integrative properties of the membrane. The kernel (cid:17) acts as a template for
the shape of spikes (usually highly stereotyped). Like in the I&F model, the model neuron
(cid:2)res each time that the membrane voltage u crosses the threshold # from below

(cid:20)(s) I (t (cid:0) s)ds

(1)

d
d
dt
dt
Here, the threshold includes a mechanism of spike-frequency adaptation. # is given by the
following equation

#(t); then ^t = t

if u(t) (cid:21) #(t) and

u(t) (cid:21)

(2)

d#
dt

# (cid:0) #0
(cid:28)#

= (cid:0)

+ A# Xk
Each time that a spike is (cid:2)red, the threshold # is increased by a (cid:2)xed amount A# . It then
decays back to its resting value #0 with time constant (cid:28)# . tk denote the past (cid:2)ring times of
the model neuron. During discharge at rate f , the threshold (cid:3)uctuates around the average
value

(cid:14)(t (cid:0) tk )

(3)

(cid:22)# (cid:25) #0 + (cid:11) f

(4)

where (cid:11) = A# (cid:28)# . This type of adaptation mechanism has been shown to constitute a
universal model for spike-frequency adaptation [10] and has already been applied in a sim-
ilar context [11]. During the model estimation, we use as a (cid:2)rst step a traditional constant
threshold denoted by #(t) = #cst which is then transformed in the adaptive threshold of
Equation (3) by a procedure to be detailed below.

2.2 Mapping technique

The mapping technique itself is extensively described in [7,12-13] and we refer interested
readers to these publications. In short, it is a systematic step-by-step evaluation and opti-
mization procedure based on intracellular recordings. It consists in sequentially evaluating
kernels ((cid:17) and (cid:20)) and parameters [A# , #0 and (cid:28)# in Equation (3)] that characterize a speci(cid:2)c
instance of the model. The consecutive steps of the procedure are as follows

1. Extract the kernel (cid:17) from a sample voltage recording by spike triggered averaging.
For the sake of simplicity, we assume that the mean drive (cid:22)I = 0.
2. Subtract (cid:17) from the voltage recording to isolate the subthreshold (cid:3)uctuations.
3. Extract the kernel (cid:20) by the Wiener-Hopf optimal (cid:2)ltering technique [7,14]. This
step involves a comparison between the subthreshold (cid:3)uctuations and the corre-
sponding input current.
4. Find the optimal constant threshold #cst . The optimal value of #cst is the one
that maximizes the coef(cid:2)cient (cid:0) (see subsection 2.3 below for the de(cid:2)nition of (cid:0)).
The parameter #cst depends on the speci(cid:2)c set of input parameters (mean (cid:22)I and
variance (cid:27) 2
I ) used during stimulation.
5. Plot the threshold #cst as a function of the (cid:2)ring frequency f of the neuron and
run a linear regression. #0 is identi(cid:2)ed with the value of the (cid:2)t at f = 0 and (cid:11)
with the slope [see Equation (4) and Figure 1C].
6. Optimize A# for the best performances (again measured with (cid:0)), (cid:28)# is de(cid:2)ned as
(cid:28)# = (cid:11)=A# .

Figure 1A and B show kernels (cid:17) (step 1) and (cid:20) (step 3) for a typical neuron. The double
exponential shape of (cid:20) is due to the coupling between somatic and dendritic compartments
[15]. Figure 1C shows the optimal constant #cst plotted versus f . It is very well (cid:2)tted by a
simple linear function and allows to determine the parameters #0 and (cid:11) (steps 4 and 5).

2.3 Evaluation of performances

The performances of the model are evaluated with the coincidence factor (cid:0) [16].
de(cid:2)ned by

It is

(5)

(cid:0) =

Ncoinc (cid:0) hNcoinc i
1
1
N
2 (Ndata + NSRM )
where Ndata is the number of spikes in the reference spike train, NSRM is the number of
spikes in the predicted spike train SSRM , Ncoinc is the number of coincidences with pre-
cision (cid:1) between the two spike trains, and hNcoinc i = 2(cid:23)(cid:1)Ndata is the expected number
of coincidences generated by a homogeneous Poisson process with the same rate (cid:23) as the
spike train SSRM . The factor N = 1(cid:0) 2(cid:23)(cid:1) normalizes (cid:0) to a maximum value (cid:0) = 1 which
is reached if and only if the spike train of the SRM reproduces exactly that of the cell. A
homogeneous Poisson process with the same number of spikes as the SRM would yield
(cid:0) = 0. We compute the coincidence factor (cid:0) by comparing the two complete spike trains
as in [7]. Throughout the paper, we use (cid:1) = 2 ms. Results do depend on (cid:1) but the exact
value of (cid:1) is not critical as long as it is chosen in a reasonable range 1 (cid:20) (cid:1) (cid:20) 4 ms [17].
The coincidence factor (cid:0) is similar to the (cid:147)reliability(cid:148) as de(cid:2)ned in [6]. All measures of (cid:0)

A

)
V
m
(
 
h

20

0

-20

-40

-60

-80
-5

B

0.010

0.005

)
1
-
s
W
G
(
 
¥
k

0.000

C

-40

R2 = 0.93
p < 0.0001

)
V
m
(
 
t
s
c
q

-45

-50

0
5
10
time (msec)

15

-5

0
5
10
time (msec)

15

-55
0

10

f (Hz)

20

30

Figure 1: Kernels (cid:17) (A) and (cid:20) (B) as extracted by the method exposed in this paper. Raw
data (symbols) and (cid:2)t by double exponential functions (solid line). C. The optimal constant
threshold #cst is plotted versus the output frequency f (symbols). It is very neatly (cid:2)tted by
a linear function (line).

reported in this paper are given for new stimuli, independent of those used for parameter
optimization during the model estimation procedure.

3 Results

Figure 2 shows a direct comparison between predicted and recorded spike train for a typical
neuron. Both spike trains are almost indistinguishable (A). Even when zooming on the
subthreshold regime, differences are in the range of a few millivolts only (B). The spike
dynamics is correctly predicted apart from a short period of time just after a spike is emitted
(C). This is due to the fact that the kernel (cid:17) was extracted for a mean drive (cid:22)I = 0.
Here, the mean is much larger than 0 and the neuron has already adapted to this new
regime. It produces slightly different after-spike effects. This can be corrected easily in
our framework by taking a time-dependent time constant in the kernel (cid:20), i.e. (cid:20)(s) !
(cid:20)(t (cid:0) ^t; s). This dependence is of importance to account for spike-to-spike interactions
[18]. The mapping procedure discussed above allows, in principle, to compute (cid:20)(t (cid:0) ^t; s)
for any t (cid:0) ^t (see [7] for further details). However, it requires longer recordings than the
ones provided by our experiments and was dropped here.
Before moving to a quantitative estimate of the quality of the predictions of our model, we
need to understand what kind of limits are imposed on predictions by the modelled neu-
rons themselves. It is well known that pyramidal neurons of the cortex respond with very
different reliability depending on the type of stimulation they receive [6]. Neurons tend to
(cid:2)re regularly but without conserving the exact timing of spikes in response to constant or
quasi constant input current. On the other hand, they (cid:2)re irregularly but reliably in terms of
spike timing in response to (cid:3)uctuating current. We do not expect our model to yield better
predictions than the intrinsic reliability of the modelled neuron. To evaluate the intrinsic
reliability of the pyramidal neurons, we repeated injection of the same OU process, i.e. in-
jection of processes with the same seed, and computed (cid:0) between the repeated spike trains
obtained in response to this procedure. Figure 3A shows a surface plot of the intrinsic reli-
ability (cid:0)n!n of a typical neuron (the subscript n ! n is written for neuron to itself). It is
plotted versus the parameters of the stimulation, the current mean drive (cid:22)I and its standard
deviation (cid:27)I . We (cid:2)nd that the mean drive (cid:22)I has almost no impact on (cid:0)n!n (measured
cross-correlation coef(cid:2)cient r = 0:04 with a p-value p = 0:81). On the other hand, (cid:27)I
has a strong impact on the reliability of the neuron (r = 0:93 with p < 10(cid:0)4 ). When
(cid:27)I is large ((cid:27)I & 300 pA), (cid:0)n!n reaches a plateau at about 0:84 (cid:6) 0:05 (mean (cid:6) s.d.).

A

B

)
V
m
(
 
e
g
a
t
l
o
v
 
e
n
a
r
b
m
e
m

40

20

0

-20

-40

-60

-80

1700

1800
time (msec)
C

1900

Figure 2: Performances of the SRM constructed by the method presented in this paper. A.
The prediction of the model (black line) is compared to the spike train of the corresponding
neuron (thick grey line). B. Zoom on the subthreshold regime. This panel corresponds
to the (cid:2)rst dotted zone in A (horizontal bar is 5 ms; vertical bar is 5 mV) C. Zoom on a
correctly predicted spike. This panel corresponds to the second dotted zone in A (horizontal
bar is 1 ms; vertical bar is 20 mV). The model slightly undershoots during about 4 ms after
the spike (see text for further details).

When (cid:27)I decreases to 100 (cid:20) (cid:27)I (cid:20) 300 pA, (cid:0)n!n quickly drops to an intermediate value
of 0:65 (cid:6) 0:1 and (cid:2)nally for (cid:27)I (cid:20) 100 pA drops down to 0:09 (cid:6) 0:05. These (cid:2)ndings are
stable across the different neurons that we recorded and repeat the (cid:2)ndings of Mainen and
Sejnowski [6].
In order to connect model predictions to these (cid:2)ndings, we evaluate the (cid:0) coincidence
factor between the predicted spike train and the recorded spike trains (this (cid:0) is labelled
m ! n for model to neuron). Figure 3B shows a plot of (cid:0)m!n versus (cid:0)n!n . We (cid:2)nd
that the predictions of our minimal model are close to the natural upper bound set by the
intrinsic reliability of the pyramidal neuron. On average, the minimal model achieves a
quality (cid:0)m!n which is 65% ((cid:6)3% s.e.m.) of the upper bound, i.e. (cid:0)m!n = 0:65 (cid:0)n!n .
Furthermore, let us recall that due to the de(cid:2)nition of the coincidence factor (cid:0), the threshold
for statistical signi(cid:2)cance here is (cid:0)m!n = 0. All the points are well above this value, hence
highly signi(cid:2)cant. Finally, we compare the predictions of our minimal model in terms
of two other indicators, the mean rate and the coef(cid:2)cient of variation of the interspike
interval distribution (Cv ). The mean rate is usually correctly predicted by our minimal
model (see Figure 3C) in agreement with the (cid:2)ndings of Rauch and colleagues [4]. The Cv
is predicted in the correct range as well but may vary due to missed or extra spikes added
in the prediction (data not shown). It is also noteworthy that available spike trains are not
very long (a few seconds) and the number of spikes is sometimes too low to yield a reliable
estimate of the Cv .

A

C

150

)
z
H
(
 
100
e
t
a
r
 
d
e
t
c
i
d
e
r
p

50

0

0

B

D

1

R2 = 0.68
p < 0.0002

n
ﬁ
0.5
m
G

0.5
Gnﬁn

1

R2 = 0.81
p < 0.0001

n
ﬁ
0.5
m
G

R2 = 0.96
p < 0.0001

50
100
actual rate (Hz)

150

0.5
Gnﬁn

1

1

Figure 3: Quantitative performances of the model. A. Intrinsic reliability (cid:0)n!n of a typical
pyramidal neuron in function of the mean drive (cid:22)I and its standard deviation (cid:27)I . B. Per-
formances of the SRM in correct spike timing prediction (cid:0)m!n are plotted versus the cells
intrinsic reliability (cid:0)n!n (symbols) for the very same stimulation parameters. The diag-
onal line (solid) denotes the (cid:147)natural(cid:148) upper bound limit imposed by the neurons intrinsic
reliability. C. Predicted frequency versus actual frequency (symbols). D. Same as in A but
in a model without adaptation where the threshold has been optimized separately for each
set of stimulation parameters (see text for further details.)

Previous model studies had shown that a model with a threshold simpler than the one used
here is able to reliably predict the spike train of more detailed neuron models [7,12]. Here,
we used a threshold including an adaptation mechanism. Without adaptation, i.e. when
the sum over all preceding spikes in Equation (3) is replaced by the contribution of the
last emitted spike only, it is still possible to reach the same quality of predictions for each
driving regime (Figure 3D) under the condition that the three threshold parameters (A# , #0
and (cid:28)# ) are chosen differently for each set of input parameters (cid:22)I and (cid:27)I . In contrast to this,
our I&F model with adaptation achieves the same level of predictive quality (Figure 3B)
with one single set of threshold parameters. This illustrates the importance of adaptation to
I&F models or SRM.

4 Discussion

Mapping real neurons to simpli(cid:2)ed neuronal models has bene(cid:2)ted from many develop-
ments in recent years [4-5,7-8,11-13,19-22] and was applied to both in vitro [4,9,13,22]
and in vivo recordings [5]. We have shown here that a simple estimation procedure allows
to build an equivalent I&F-type model for a collection of cortical neurons. The model neu-
ron is built sequentially from intracellular recordings. The resulting model is very ef(cid:2)cient
in the sense that it allows a quantitative and accurate prediction of the spike train of the real
neuron. Most of the time, the predicted subthreshold membrane voltage differs from the

recorded one by a few millivolts only. The mean (cid:2)ring rate of the minimal model corre-
sponds to that of the real neuron. The statistical structure of the spike train is approximately
conserved since we observe that the coef(cid:2)cient of variation (Cv ) of the interspike interval
distribution is predicted in the correct range by our minimal model. But most important,
our minimal model has the ability to predict spikes with the correct timing ((cid:6)2 ms) and the
level of prediction that is reached is close to the intrinsic reliability of the real neuron in
terms of spike timing [6]. The adapting threshold has been found to play an important role.
It allows the model to tune to variable input characteristics and to extend its predictions
beyond the input regimes used for model evaluation.
This work suggests that L5 neocortical pyramidal neurons under random current injection
behave very much like I&F neurons including a spike-frequency adaptation process. This
is a result of importance. Indeed, the I&F-type models are extremely popular in large scale
network studies. Our results can be viewed as a strong a posteriori justi(cid:2)cation to the use
of this class of model neurons. They also indicate that the picture of a neuron combining a
linear summation in the subthreshold regime with a threshold criterion for spike initiation
is good enough to account for much of the behavior in an in vivo-like lab setting. This
should however be moderated since several important aspects were neglected in this study.
First, we used random current injection rather than a more realistic random conductance
protocol [23].
In a previous report [12], we had checked the consequences of random
conductance injection with simulated data. We found that random conductance injection
mainly changes the effective membrane time constant of the neuron and can be accounted
for by making the time course of the optimal linear (cid:2)lter ((cid:20) here) depend on the mean in-
put to the neuron. The minimal model reached the same quality level of predictions when
driven by random conductance injection [12] as the level it reaches when driven by ran-
dom current injection [7]. Second, a largely (cid:3)uctuating current generated by a random
process can only be seen as a poor approximation to the input a neuron would receive
in vivo. Our input has stationary statistics with a spectrum that is close to white (cut-off
at 1 kHz), but a lower cut-off frequency could be used as well. Whether random input
is a reasonable model of the input a neuron would receive in vivo is highly controversial
[24-26], but from a purely practical point of view random stimulation provides at least a
well-de(cid:2)ned experimental paradigm for in vitro experiments that mimics some aspects of
synaptic bombardment [27]. Third, all transient effects have been excluded since neuronal
data is analyzed in the adapted state. Finally, our experimental paradigm used somatic
current injection. Thus, all dendritic non-linearities, including backpropagating action po-
tentials and dendritic spikes are excluded.
In summary, simple threshold models will never be able to account for all the variety of neu-
ronal responses that can be probed in an arti(cid:2)cial laboratory setting. For example, effects
of delayed spike initiation cannot be reproduced by simple threshold models that combine
linear subthreshold behavior with a strict threshold criterion (but could be reproduced by
quadratic or exponential I&F models). For this reason, we are currently studying expo-
nential I&F models with adaptation that allow us to relate our approach with other known
models [21,28]. However, for random current injection that mimics synaptic bombardment,
the picture of a neuron that combines linear summation with a threshold criterion is not too
wrong. Moreover, in contrast to more complicated neuron models, the simple threshold
model allows rapid parameter extraction from experimental traces; ef(cid:2)cient numerical sim-
ulation; and rigorous mathematical analysis. Our results also suggest that, if any elaborated
computation is taking place in single neurons, it is likely to happen at dendritic level rather
than at somatic level. In absence of a clear understanding of dendritic computation, the
I&F neuron with adaptation thus appears as a model that we consider (cid:147)good enough(cid:148).

Acknowledgments

This work was supported by Swiss National Science Foundation grants number FN 200020-
103530/1 to WG and number 3100-061335.00 to HRL.

References
[1] Feng J. Neural Net. 14: 955(cid:150)975, 2001.
[2] Maass W & Bishop C. Pulsed Neural Networks. MIT Press, Cambridge, 1998.
[3] Gerstner W & Kistler W. Spiking neurons models: single neurons, populations, plasticity. Cam-
bridge Univ. Press, Cambridge, 2002.
[4] Rauch A, La Camera G, L ¤uscher H, Senn W & Fusi S. J. Neurophysiol. 90: 1598(cid:150)1612, 2003.
[5] Keat J, Reinagel P, Reid R & Meister M. Neuron 30: 803-817, 2001.
[6] Mainen Z and Sejnowski T. Science 268: 1503(cid:150)1506, 1995.
[7] Jolivet R, Lewis TJ & Gerstner W. J. Neurophysiol. 92: 959(cid:150)976, 2004.
[8] Paninski L, Pillow J & Simoncelli E. Neural Comp. 16: 2533-2561, 2004.
[9] Brillinger D & Segundo J. Biol. Cyber. 35: 213-220, 1979.
[10] Benda J & Herz A. Neural Comp. 15: 2523-2564, 2003.
[11] La Camera G, Rauch A, L ¤uscher H, Senn W & Fusi S. Neural Comp. 16: 2101-2124, 2004.
[12] Jolivet R & Gerstner W. J. Physiol.-Paris 98: 442-451, 2004.
[13] Jolivet R, Rauch A, L ¤uscher H & Gerstner W. Accepted in J. Comp. Neuro.
[14] Wiener N. Nonlinear problems in random theory. MIT Press, Cambridge, 1958.
[15] Roth A & H ¤ausser M. J. Physiol. 535: 445-472, 2001.
[16] Kistler W, Gerstner W & van Hemmen J. Neural Comp. 9: 1015-1045, 1997.
[17] Jolivet R (2005). Effective minimal threshold models of neuronal activity. PhD thesis, EPFL,
Lausanne.
[18] Arcas B & Fairhall A. Neural Comp. 15: 1789-1807, 2003.
[19] Brillinger D. Ann. Biomed. Engineer. 16: 3-16, 1988.
[20] Arcas B, Fairhall A & Bialek W. Neural Comp. 15: 1715-1749, 2003.
[21] Izhikevich E. IEEE Trans. Neural Net. 14: 1569-1572, 2003.
[22] Paninski L, Pillow J & Simoncelli E. Neurocomp. 65-66: 379-385, 2005.
[23] Robinson H & Kawai N. J. Neurosci. Meth. 49: 157-165, 1993.
[24] Arieli A, Sterkin A, Grinvald A & Aertsen A. Science 273: 1868(cid:150)1871, 1996.
[25] De Weese M & Zador A. J. Neurosci. 23: 7940(cid:150)7949, 2003.
[26] Stevens C & Zador A. In Proc. of the 5th Joint Symp. on Neural Comp., Inst. for Neural Comp.,
La Jolla, 1998.
[27] Destexhe A, Rudolph M & Par ·e D. Nat. Rev. Neurosci. 4: 739-751, 2003.
[28] Fourcaud-Trocm ·e N, Hansel D, van Vreeswijk C & Brunel N. J. Neurosci. 23: 11628-11640,
2003.

