Robust design of biological experiments

Patrick Flaherty
EECS Department
University of California
Berkeley, CA 94720
ﬂaherty@berk eley.edu

Michael I. Jordan
Computer Science and Statistics
University of California
Berkeley, CA 94720
jordan@cs.berkeley.edu

Adam P. Arkin
Bioengineering Department,
LBL, Howard Hughes Medical Institute
University of California
Berkeley, CA 94720
aparkin@lbl.gov

Abstract

We address the problem of robust, computationally-efﬁcient design of bi-
ological experiments. Classical optimal experiment design methods have
not been widely adopted in biological practice, in part because the result-
ing designs can be very brittle if the nominal parameter estimates for the
model are poor, and in part because of computational constraints. We
present a method for robust experiment design based on a semideﬁnite
programming relaxation. We present an application of this method to the
design of experiments for a complex calcium signal transduction path-
way, where we have found that the parameter estimates obtained from
the robust design are better than those obtained from an “optimal”
de-
sign.

1 Introduction

Statistical machine learning methods are making increasing inroads in the area of biolog-
ical data analysis, particularly in the context of genome-scale data, where computational
efﬁcienc y is paramount. Learning methods are particularly valuable for their ability to
fuse multiple sources of information, aiding the biologist to interpret a phenomenon in its
appropriate cellular, genetic and evolutionary context. At least as important to the biolo-
gist, however, is to use the results of data analysis to aid in the design of further exper-
iments. In this paper we take up this challenge—we
show how recent developments in
computationally-efﬁcient optimization can be brought to bear on the problem of the de-
sign of experiments for complex biological data. We present results for a speciﬁc model
of calcium signal transduction in which choices must be made among 17 kinds of RNAi
knockdown experiments.
There are three main objectives for experiment design: parameter estimation, hypothesis
testing and prediction. Our focus in this paper is parameter estimation, speciﬁcally in the
setting of nonlinear kinetic models [1]. Suppose in particular that we have a nonlinear

model y = f (x; (cid:18)) + "; " (cid:24) N (0; (cid:27) 2 ), where x 2 X represents the controllable conditions
of the experiment (such as dose or temperature), y is the experimental measurement and
(cid:18) 2 Rp is the set of parameters to be estimated. We consider a ﬁnite menu of available
experiments X = fx1 ; : : : ; xm g. Our objective is to select the best set of N experiments
(with repeats) from the menu. Relaxing the problem to a continuous representation, we
solve for a distribution over the design points and then multiply the weights by N at the
end [2]. The experiment design is thus
m
(cid:24) = (cid:26) x1 ; : : : ; xm
w1 ; : : : ; wm (cid:27) ;
Xi=1
wi = 1; wi (cid:21) 0; 8i;
and it is our goal to select values of wi that satisfy an experimental design criterion.

(1)

2 Background

We adopt a standard least-squares framework for parameter estimation. In the nonlinear
setting this is done by making a Taylor series expansion of the model about an estimate
(cid:18)0 [3]

(2)

.

f (x; (cid:18)) (cid:25) f (x; (cid:18)0 ) + V ((cid:18) (cid:0) (cid:18)0 );
(cid:12)(cid:12)(cid:12)(cid:18)0
i = @ f (xi ;(cid:18))
where V is the Jacobian matrix of the model; the ith row of V is vT
@ (cid:18)
The least-squares estimate of (cid:18) is ^(cid:18) = (cid:18)0 + (cid:0)V T W V (cid:1)(cid:0)1
V T W (y (cid:0) f (x; (cid:18)0 )), where W =
diag(w). The covariance matrix for the parameter estimate is cov( ^(cid:18) j(cid:24) ) = (cid:27)2 (cid:0)V T W V (cid:1)(cid:0)1 ,
which is the inverse of the observed Fisher information matrix.
The aim of optimal experiment design methods is to minimize the covariance matrix of the
parameter estimate [4, 5, 6]. There are two well-known difﬁculties that must be surmounted
in the case of nonlinear models [6]:
(cid:15) The optimal design depends on an evaluation of the derivative of the model with
respect to the parameters at a particular parameter estimate. Given that our goal is
parameter estimation, this involves a certain circularity.
(cid:15) Simple optimal design procedures tend to concentrate experimental weight on
only a few design points [7]. Such designs are overly optimistic about the ap-
propriateness of the model, and provide little information about possible lack of
ﬁt over a wider experimental range.

There have been three main responses to these problems: sequential experiment design [7],
Bayesian methods [8], and maximin approaches [9].
In the sequential approach, a working parameter estimate is ﬁrst used to construct a tenta-
tive experiment design. Data are collected under that design and the parameter estimate is
updated. The procedure is iterated in stages. While heuristically reasonable, this approach
is often inapplicable in practice because of costs associated with experiment set-up time.
In the Bayesian approach exempliﬁed by [8], a proper prior distribution is constructed for
the parameters to be estimated. The objective function is the KL divergence between the
prior distribution and the expected posterior distribution; this KL divergence is maximized
(thereby maximizing the amount of expected information in the experiment design). Sensi-
tivity to priors is a serious concern, however, particularly in the biological setting in which
it can be quite difﬁcult
to choose priors for quantities such as bulk rates for a complex
process.
The maximin approach considers a bounded range for each parameter and ﬁnds the optimal
design for the worst case parameters in that range. The major difﬁculties with this approach
are computational, and its main applications have been to specialized problems [7].

The approach that we present here is closest in spirit to the maximin approach. We view
both of the problems discussed above as arguments for a robust design, one which is in-
sensitive to the linearization point and to model error. We work within the framework of
E-optimal design (see below) and consider perturbations to the rank-one Fisher information
matrix for each design point. An optimization with respect to such perturbations yields a
robust semideﬁnite program [10, 11, 12].

3 Optimal Experiment Design

The three most common scalar measures of the size of the parameter covariance matrix in
optimal experiment design are:

(cid:15) D-optimal design: determinant of the covariance matrix.
(cid:15) A-optimal design: trace of the covariance matrix.
(cid:15) E-optimal design: maximum eigenvalue of the covariance matrix.
We adopt the E-optimal design criterion, and formulate the design problem as follows:
(cid:21)max 2
i !(cid:0)13
  m
m
Xi=1
Xi=1
wi vi vT
5 s:t:
4
wi (cid:21) 0; 8i;
where (cid:21)max [M ] is the maximum eigenvalue of a matrix M . This problem can be recast as
the following semideﬁnite program [5]:

P0 : p(cid:3)0 = min
w

wi = 1

(3)

P0 : p(cid:3)0 = max
w;s

s

s:t:

wi vi vT
i (cid:21) sIp

m
Xi=1
wi = 1; wi (cid:21) 0; 8i;

(4)

m
Xi=1
which forms the basis of the robust extension that we develop in the following section.

4 Robust Experiment Design

The uncertain parameters appear in the experiment design optimization problem through
the Jacobian matrix, V . We consider additive unstructured perturbations on the Jacobian
or “data”
in this problem. The uncertain observed Fisher information matrix is F (w; (cid:1)) =
Pm
i (cid:0) (cid:1)i ), where (cid:1)i is a p (cid:2) p matrix for i = 1; : : : ; m. We consider a spectral
i=1 wi (vi vT
norm bound on the magnitude of the perturbations such that kblkdiag((cid:1)1 ; : : : ; (cid:1)m )k (cid:20) (cid:26).
Incorporating the perturbations, the E-optimal experiment design problem with uncertainty
based on (4) can be cast as the following minimax problem:
P(cid:26) : p(cid:3)(cid:26) = minw;s maxk(cid:1)k(cid:20)(cid:26) (cid:0)s
subject to Pm
i=1 wi (vi vT
i (cid:0) (cid:1)i ) (cid:21) sIp
(cid:1) = blkdiag((cid:1)1 ; : : : ; (cid:1)m )
Pm
i=1 wi = 1; wi (cid:21) 0; 8i:
We will call equation (5) an E-robust experiment design.

(5)

To implement the program efﬁciently , we can recast the linear matrix inequality in (5) in a
linear fractional representation:
F (w; s; (cid:1)) = F (w; s) + L(cid:1)R(w) + R(w)T (cid:1)T LT (cid:21) 0;

where

F (w; s) =

m
Xi=1
R(w) = 1p2
wi vi vT
(w (cid:10) Ip )
i (cid:0) sIp ;
L = (cid:0)1
m (cid:10) Ip(cid:17) ; (cid:1) = blkdiag((cid:1)1 ; : : : ; (cid:1)m ):
p2 (cid:16)1T
Taking (cid:1)1 = (cid:1) (cid:1) (cid:1) = (cid:1)m , a special case of the S-procedure [11] yields the following
semideﬁnite program:
P(cid:26) : p(cid:3)(cid:26) = minw;s;(cid:28) (cid:0)s
subject to " Pm
2 (cid:28) Ip wT (cid:10) (cid:26)p2
i (cid:0) sIp (cid:0) m
i=1 wi vi vT
w (cid:10) (cid:26)p2
Ip
(cid:28) Imp
Pm
i=1 wi = 1; wi (cid:21) 0; 8i:
If (cid:26) = 0 we recover (4). Using the Schur complement the ﬁrst
further simpliﬁed to

constraint in (7) can be

# (cid:21) 0

(7)

Ip

m
i (cid:0) (cid:26)pmkwk2 (cid:21) sIp ;
Xi=1
wi vi vT
which makes the regularization of the optimization problem (4) explicit. The uncertainty
bound, (cid:26), serves as a weighting parameter for a Tikhonov regularization term.

(8)

5 Results

We demonstrate the robust experiment design on two models of biological systems. The
ﬁrst model is the Michaelis-Menten model of a simple enzyme reaction system. This
model, derived from mass-action kinetics, is a fundamental building block of many mecha-
nistic models of biological systems. The second example is a model of a complex calcium
signal transduction pathway in macrophage immune cells. In this example we consider
RNAi knockdowns at a variety of ligand doses for the estimation of receptor level parame-
ters.

5.1 Michaelis-Menten Reaction Model

tion [13]. The basic chemical reaction that leads to this model is E + S

The Michaelis-Menten model is a common approximation to an enzyme-substrate reac-
k+1(cid:0)(cid:0)*)(cid:0)(cid:0)k(cid:0)1
k2(cid:0)! E + P ,
where E is the enzyme concentration, S is the substrate concentration and P is the product
concentration. We employ mass action kinetics to develop a differential equation model for
this reaction system [13]. The velocity of the reaction is deﬁned to be the rate of product
. The initial velocity of the reaction is
formation, V0 = @P
@ t (cid:12)(cid:12)t0

(9)

C

;

V0 (cid:25)

(cid:18)1x
(cid:18)2 + x

where

(cid:18)1 = k+2E0 ; (cid:18)2 =

k(cid:0)1 + k+2
k+1

:

(10)

We have taken the controllable factor, x, in this system to be the initial substrate con-
centration S0 . The parameter (cid:18)1 is the saturating velocity and (cid:18)2 is the initial substrate
concentration at which product is formed at one-half the maximal velocity. In this example
(cid:18)1 = 2 and (cid:18)2 = 2 are the total enzyme and initial substrate concentrations. We consider
six initial substrate concentrations as the menu of experiments, X = (cid:8) 1
8 ; 1; 2; 4; 8; 16(cid:9).
Figure 1 shows the robust experiment design weights as a function of the uncertainty pa-
rameter with the Jacobian computed at the true parameter values. When (cid:26) is small, the
experimental weight is concentrated on only two design points. As (cid:26) ! (cid:26)max the design
converges to a uniform distribution over the entire menu of design points. In a sense, this
uniform allocation of experimental energy is most robust to parameter uncertainty. Inter-
mediate values of (cid:26) yield an allocation of design points that reﬂects
a tradeoff between
robustness and nominal optimality.

E−robust Experiment Design Weight by  r

0.125
    1
    2
    4
    8
   16

0.7

0.6

0.5

0.4

0.3

0.2

0.1

t
h
g
i
e
w

0
10−4

10−3

10−2
r

10−1

100

Figure 1: Michaelis-Menten model experiment design weights as a function of (cid:26).

For moderate values of (cid:26) we gain signi ﬁcantly in terms of robustness to errors in v i vT
i , at
a moderate cost to maximal value of the minimum eigenvalues of the parameter estimate
covariance matrix. Figure 2 shows the efﬁcienc y of the experiment design as a function of
(cid:26) and the prior estimate (cid:18)02 used to compute the Jacobian matrix. The E-efﬁcienc y of a
design is deﬁned to be
(cid:21)max hcov (cid:16) ^(cid:18)j(cid:18) ; (cid:24)0(cid:17)i
(cid:21)max hcov (cid:16) ^(cid:18)j(cid:18)0 ; (cid:24)(cid:26)(cid:17)i
If the Jacobian is computed at the correct point in parameter space the optimal design
achieves maximal efﬁcienc y. As the distance between (cid:18)0 and (cid:18) grows the efﬁcienc y of the
optimal design decreases rapidly. If the estimate, (cid:18)02 , is eight instead of the true value,
two, the efﬁcienc y of the optimal design at (cid:18)0 is 36% of the optimal design at (cid:18) . However,
at the cost of a decrease in efﬁcienc y for parameter estimates close to the true parameter
value we guarantee the efﬁcienc y is better for points further from the true parameters with
a robust design. For example, for (cid:26) = 0:001 the robust design is less efﬁcient
for the range
0 < (cid:18)02 < 7, but is more efﬁcient
for 7 < (cid:18)02 < 16.

efﬁcienc y ,

:

(11)

5.2 Calcium Signal Transduction Model

When certain small molecule ligands such as the anaphylatoxin C5a are introduced into
the environment of an immune cell a complex chain of chemical reactions leads to the

r=0
r=1e−3
r=1e−2
r=1e−1
r=10

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

y
c
n
e
i
c
i
f
f
E

0
0

2

4

6

10

12

14

16

8
q
02

Figure 2: Efﬁcienc y of robust designs as a function of (cid:26) and perturbations in the prior
parameter estimate (cid:18)02 .

transduction of the extracellular ligand concentration information and a transient increase
in the intracellular calcium concentration. This chain of reactions can be mathematically
modeled using the principles of mass-action kinetics and nonlinear ordinary differential
equations. We consider speciﬁcally the model presented in [14] which was developed for
the P2Y2 receptor, modifying the model for our data on the C5a receptor.
The menu of available experiments is indexed by one of two different cell lines in combina-
tion with different ligand doses. The cell lines are: wild-type and a GRK2 knockdown line.
GRK2 is a protein that represses signaling in the G-protein receptor complex. When its
concentration is decreased with interfering RNA the repression of the signal due to GRK2
is reduced. There are 17 experiments on the menu and we choose to do 100 experiments
allocated according the experiment design. For each experiment we are able measure the
transient calcium spike peak height using a ﬂuorescent
calcium dye. We are concerned
with estimating three C5A receptor parameters: K1 , kp , kdeg which are detailed in [14].
We have selected the initial parameter estimates based on a least-squares ﬁt
to a separate
data set of 67 experiments on a wild-type cell line with a ligand concentration of 250nM.
We have estimated, from experimental data, the mean and variance for all of the experi-
ments in our menu. Observations are simulated from these data to obtain the least-squares
parameter estimate for the optimal, robust ((cid:26) = 1:5 (cid:2) 10(cid:0)6 ) and uniform experiment de-
signs.
Figure 3 shows the model ﬁts with associated 95% con ﬁdence bands for the wild-type and
knockdown cell lines for the parameter estimates from the three experiment designs. A
separate validation data set is generated uniformly across the design menu. Compared to
the optimal design, the parameter estimates based on the robust design provide a better
ﬁt across the whole dose range for both cell types as measured by mean-squared residual
error.
Note also that the measured response at high ligand concentration is better ﬁt with param-
eters estimated from the robust design. Near 1(cid:22)M of C5a concentration the peak height is
predicted to decrease slightly in the wild-type cell line, but plateaus for the GRK2 knock-
down cell line. This matches the biochemical understanding that GRK2 acts as a repressor
of signaling.

0.1

0.05

0
10−4

0.1

0.05

0
10−4

)
M
u
(
 
t
h
g
i
e
H
 
k
a
e
P

0.1

0.05

0
10−4

Optimal Design − WT

Optimal Design − GRK

0.1

0.05

10−2
Robust Design − WT

100

0
10−4

10−2
Robust Design − GRK

100

0.1

0.05

0
10−4

0.1

0.05

0
10−4

)
M
u
(
 
t
h
g
i
e
H
 
k
a
e
P

10−2
Uniform Design − WT

100

10−2
[C5A] (uM)

100

10−2
Uniform Design − GRK

100

10−2
[C5A] (uM)

100

Figure 3: Model predictions based on the least squares parameter estimate using data ob-
served from the optimal, robust and uniform design. The predicted peak height curve (black
line) based on the robust design data is shifted to the left compared to the peak height curve
based on the optimal design data and matches the validation sample (shown as blue dots)
more accurately.

6 Discussion

The methodology of optimal experiment design leads to efﬁcient
algorithms for the
construction of designs in general nonlinear situations [15]. However, these variance-
minimizing designs fail to account for uncertainty in the nominal parameter estimate and
the model. We present a methodology, based on recent advances in semideﬁnite program-
ming, that retains the advantages of the general purpose algorithm while explicitly incor-
porating uncertainty.
We demonstrated this robust experiment design method on two example systems. In the
Michaelis-Menten model, we showed that the E-optimal design is recovered for (cid:26) = 0 and
the uniform design is recovered as (cid:26) ! (cid:26)max . It was also shown that the robust design is
more efﬁcient
than the optimal for large perturbations of the nominal parameter estimate
away from the true parameter.
The second example, of a calcium signal transduction model, is a more realistic case of
the need for experiment design in high-throughput biological research. The model cap-
tures some of the important kinetics of the system, but is far from complete. We require
a reasonably accurate model to make further predictions about the system and drive a set
of experiments to estimate critical parameters of the model more accurately. The resulting
robust design spreads some experiments across the menu, but also concentrates on experi-
ments that will help minimize the variance of the parameter estimates.
These robust experiment designs were obtained using SeDuMi 1.05 [16]. The design for the
calcium signal transduction model takes approximately one second on a 2GHz processor,
which is less time than required to compute the Jacobian matrix for the model.
Research in machine learning has led to signi ﬁcant advances in computationally-efﬁcient

to biological data.
data analysis methods, allowing increasingly complex models to be ﬁt
Challenges in experimental design are the ﬂip side of this coin—for
complex models to
be useful in closing the loop in biological research it is essential to begin to focus on the
development of computationally-efﬁcient experimental design methods.

Acknowledgments
We would like to thank Andy Packard for helpful discussions. We would also like to thank
Robert Rebres and William Seaman for the data used in the second example. PF and APA
would like to acknowledge support from the Howard Hughes Medical Institute and from
the Alliance for Cellular Signaling through the NIH Grant Number 5U54 GM62114-05.
MIJ would like to thank NIH R33 HG003070 for funding.

References
[1] I. Ford, D.M. Titterington, and C.P. Kitsos. Recent advances in nonlinear experiment design.
Technometrics, 31(1):49–60, 1989.
[2] L. Vandenberghe, S. Boyd, and W. S.-P. Determinant maximization with linear matrix inequality
constraints. SIAM Journal on Matrix Analysis and Applications, 19(2):499 –533, 1998.
[3] G.A.F. Seber and C.J. Wild. Nonlinear Regression. Wiley-Interscience, Hoboken, NJ, 2003.
[4] A.C. Atkinson and A.N. Donev. Optimum Experimental Designs. Oxford University Press,
1992.
[5] S. Boyd and L. Vandenberghe. Convex Optimization. Cambridge University Press, 2003.
[6] G.E.P Box, W.G. Hunter, and J.S. Hunter. Statistics for Experimenters: An Introduction to
Design, Data Analysis, and Model Building. John Wiley and Sons, New York, 1978.
[7] S.D. Silvey. Optimal Design. Chapman and Hall, London, 1980.
[8] D.V. Lindley. On the measure of information provided by an experiment. The Annals of Math-
ematical Statistics, 27(4):986–1005, 1956.
[9] L. Pronzato and E. Walter. Robust experiment design via maximin optimization. Mathematical
Biosciences, 89:161–176, 1988.
[10] L. Vandenberghe and S. Boyd. Semideﬁnite programming. SIAM Review, 38(1):49–95, 1996.
[11] L. El Ghaoui, L. Oustry, and H. Lebret. Robust solutions to uncertain semideﬁnite programs.
SIAM J. Optimization, 9(1):33–52, 1998.
[12] L. El Ghaoui and H. Lebret. Robust solutions to least squares problems with uncertain data.
SIAM J. Matrix Anal. Appl., 18(4):1035 –1064, 1997.
[13] L.A. Segel and M. Slemrod. The quasi-steady state assumption: A case study in perturbation.
SIAM Review, 31(3):446–477, 1989.
[14] G. Lemon, W.G. Gibson, and M.R. Bennett. Metabotropic receptor activation, desensitization
and sequestrationi: modelling calcium and inositol 1,4,5-trisphosphate dynamics following re-
ceptor activation. Journal of Theoretical Biology, 223(1):93 –111, 2003.
[15] A.C. Atkinson. The usefulness of optimum experiment designs. JRSS B, 58(1):59–76, 1996.
[16] J.F. Sturm. Using SeDuMi 1.02, a MATLAB toolbox for optimization over symmetric cones.
Optimization Methods and Software, 11:625 –653, 1999.

