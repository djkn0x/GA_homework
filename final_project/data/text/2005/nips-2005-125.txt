A Bayesian Spatial Scan Statistic

Daniel B. Neill
Andrew W. Moore
School of Computer Science
Carnegie Mellon University
Pittsburgh, PA 15213
{neill,awm}@cs.cmu.edu

Gregory F. Cooper
Center for Biomedical Informatics
University of Pittsburgh
Pittsburgh, PA 15213
gfc@cbmi.pitt.edu

Abstract
We propose a new Bayesian method for spatial cluster detection, the
“Bayesian spatial scan statistic,” and compare this method
to the standard
(frequentist) scan statistic approach. We demonstrate that the Bayesian
statistic has several advantages over the frequentist approach, including
increased power to detect clusters and (since randomization testing is
unnecessary) much faster runtime. We evaluate the Bayesian and fre-
quentist methods on the task of prospective disease surveillance: detect-
ing spatial clusters of disease cases resulting from emerging disease out-
breaks. We demonstrate that our Bayesian methods are successful in
rapidly detecting outbreaks while keeping number of false positives low.

Introduction
1
Here we focus on the task of spatial cluster detection: ﬁnding spatial regions where some
quantity is signi ﬁcantly higher than expected. For example , our goal may be to detect
clusters of disease cases, which may be indicative of a naturally occurring epidemic (e.g.
inﬂuenza), a bioterrorist attack (e.g. anthrax release), o r an environmental hazard (e.g. ra-
diation leak). [1] discusses many other applications of cluster detection, including mining
astronomical data, medical imaging, and military surveillance. In all of these applications,
we have two main goals: to identify the locations, shapes, and sizes of potential clusters,
and to determine whether each potential cluster is more likely to be a “true” cluster or sim-
ply a chance occurrence. Thus we compare the null hypothesis H0 of no clusters against
some set of alternative hypotheses H1 (S), each representing a cluster in some region or
regions S. In the standard frequentist setting, we do this by signi ﬁca nce testing, computing
the p-values of potential clusters by randomization; here we propose a Bayesian frame-
work, in which we compute posterior probabilities of each potential cluster.

Our primary motivating application is prospective disease surveillance: detecting spatial
clusters of disease cases resulting from a disease outbreak. In this application, we perform
surveillance on a daily basis, with the goal of ﬁnding emergi ng epidemics as quickly as
possible. For this task, we are given the number of cases of some given syndrome type
(e.g. respiratory) in each spatial location (e.g. zip code) on each day. More precisely, we
typically cannot measure the actual number of cases, and instead rely on related observable
quantities such as the number of Emergency Department visits or over-the-counter drug
sales. We must then detect those increases which are indicative of emerging outbreaks,
as close to the start of the outbreak as possible, while keeping the number of false posi-
tives low. In biosurveillance of disease, every hour of earlier detection can translate into
thousands of lives saved by more timely administration of antibiotics, and this has led to
widespread interest in systems for the rapid and automatic detection of outbreaks.

In this spatial surveillance setting, each day we have data collected for a set of discrete
spatial locations si . For each location si , we have a count ci (e.g. number of disease cases),
and an underlying baseline bi . The baseline may correspond to the underlying population
at risk, or may be an estimate of the expected value of the count (e.g. derived from the
time series of previous count data). Our goal, then, is to ﬁnd if there is any spatial region
S (set of locations si ) for which the counts are signi ﬁcantly higher than expected , given the
baselines. For simplicity, we assume here (as in [2]) that the locations si are aggregated to a
uniform, two-dimensional, N × N grid G, and we search over the set of rectangular regions
S ⊆ G. This allows us to search both compact and elongated regions, allowing detection of
elongated disease clusters resulting from dispersal of pathogens by wind or water.

1.1 The frequentist scan statistic
One of the most important statistical tools for cluster detection is Kulldorff ’s spatial scan
statistic [3-4]. This method searches over a given set of spatial regions, ﬁnding those re-
gions which maximize a likelihood ratio statistic and thus are most likely to be generated
under the alternative hypothesis of clustering rather than the null hypothesis of no clus-
tering. Randomization testing is used to compute the p-value of each detected region,
correctly adjusting for multiple hypothesis testing, and thus we can both identify potential
clusters and determine whether they are signi ﬁcant. Kulldo rff ’s framework assumes that
counts ci are Poisson distributed with ci ∼ Po(qbi ), where bi represents the (known) cen-
sus population of cell si and q is the (unknown) underlying disease rate. Then the goal of
the scan statistic is to ﬁnd regions where the disease rate is higher inside the region than
outside. The statistic used for this is the likelihood ratio F (S) = P(Dat a | H1 (S))
, where the
P(Dat a | H0 )
null hypothesis H0 assumes a uniform disease rate q = qal l . Under H1 (S), we assume that
q = qin for all si ∈ S, and q = qout for all si ∈ G − S, for some constants qin > qout . From
this, we can derive an expression for F (S) using maximum likelihood estimates of qin ,
)Cout ( Cal l
qout , and qal l : F (S) = ( Cin
)−Cal l , if Cin
)Cin ( Cout
> Cout
, and F (S) = 1 otherwise.
Bin
Bout
Bal l
Bin
Bout
In this expression, we have Cin = (cid:229)S ci , Cout = (cid:229)G−S ci , Cal l = (cid:229)G ci , and similarly for the
baselines Bin = (cid:229)S bi , Bout = (cid:229)G−S bi , and Bal l = (cid:229)G bi .
Once we have found the highest scoring region S∗ = arg maxS F (S) of grid G, and its score
F ∗ = F (S∗ ), we must still determine the statistical signi ﬁcance of thi s region by random-
ization testing. To do so, we randomly create a large number R of replica grids by sampling
under the null hypothesis ci ∼ Po(qal l bi ), and ﬁnd the highest scoring region and its score
for each replica grid. Then the p-value of S∗ is Rbeat +1
R+1 , where Rbeat is the number of repli-
cas G0 with F ∗ higher than the original grid. If this p-value is less than some threshold (e.g.
0.05), we can conclude that the discovered region is unlikely to have occurred by chance,
and is thus a signi ﬁcant spatial cluster; otherwise, no sign i ﬁcant clusters exist.

The frequentist scan statistic is a useful tool for cluster detection, and is commonly used in
the public health community for detection of disease outbreaks. However, there are three
main disadvantages to this approach. First, it is difﬁcult t o make use of any prior informa-
tion that we may have, for example, our prior beliefs about the size of a potential outbreak
and its impact on disease rate. Second, the accuracy of this technique is highly dependent
on the correctness of our maximum likelihood parameter estimates. As a result, the model
is prone to parameter over ﬁtting, and may lose detection pow er in practice because of
model misspeci ﬁcation. Finally, the frequentist scan stat
istic is very time consuming, and
may be computationally infeasible for large datasets. A naive approach requires searching
over all rectangular regions, both for the original grid and for each replica grid. Since there
are O(N 4 ) rectangles to search for an N × N grid, the total computation time is O(RN 4 ),
where R = 1000 is a typical number of replications. In past work [5, 2, 6], we have shown
how to reduce this computation time by a factor of 20-2000x through use of the “fast spatial
scan” algorithm; nevertheless, we must still perform this f aster search both for the original
grid and for each replica.

We propose to remedy these problems through the use of a Bayesian spatial scan statistic.
First, our Bayesian model makes use of prior information about the likelihood, size, and
impact of an outbreak. If these priors are chosen well, we should achieve better detec-
tion power than the frequentist approach. Second, the Bayesian method uses a marginal
likelihood approach, averaging over possible values of the model parameters qin , qout , and
qal l , rather than relying on maximum likelihood estimates of these parameters. This makes
the model more ﬂexible and less prone to over ﬁtting, and redu
ces the potential impact of
model misspeci ﬁcation. Finally, under the Bayesian model t here is no need for randomiza-
tion testing, and (since we need only to search the original grid) even a naive search can be
performed relatively quickly. We now present the Bayesian spatial scan statistic, and then
compare it to the frequentist approach on the task of detecting simulated disease epidemics.

2 The Bayesian scan statistic
Here we consider the natural Bayesian extension of Kulldorff ’s scan statistic, moving from
a Poisson to a conjugate Gamma-Poisson model. Bayesian Gamma-Poisson models are
a common representation for count data in epidemiology, and have been used in disease
mapping by Clayton and Kaldor [7], Molli ´e [8], and others. In disease mapping, the effect
of the Gamma prior is to produce a spatially smoothed map of disease rates; here we instead
focus on computing the posterior probabilities, allowing us to determine the likelihood that
an outbreak has occurred, and to estimate the location and size of potential outbreaks.

For the Bayesian spatial scan, as in the frequentist approach, we wish to compare the null
hypothesis H0 of no clusters to the set of alternative hypotheses H1 (S), each representing
a cluster in some region S. As before, we assume Poisson likelihoods, ci ∼ Po(qbi ). The
difference is that we assume a hierarchical Bayesian model where the disease rates qin , qout ,
and qal l are themselves drawn from Gamma distributions. Thus, under the null hypothesis
H0 , we have q = qal l for all si ∈ G, where qal l ∼ Ga(aal l , bal l ). Under the alternative hypoth-
esis H1 (S), we have q = qin for all si ∈ S and q = qout for all si ∈ G − S, where we indepen-
dently draw qin ∼ Ga(ain , bin ) and qout ∼ Ga(aout , bout ). We discuss how the a and b priors
are chosen below. From this model, we can compute the posterior probabilities P(H1 (S) | D)
of an outbreak in each region S, and the probability P(H0 | D) that no outbreak has oc-
curred, given dataset D: P(H0 | D) = P(D | H0 )P(H0 )
and P(H1 (S) | D) = P(D | H1 (S))P(H1 (S))
,
P(D)
P(D)
where P(D) = P(D | H0 )P(H0 ) + (cid:229)S P(D | H1 (S))P(H1 (S)). We discuss the choice of prior
probabilities P(H0 ) and P(H1 (S)) below. To compute the marginal likelihood of the data
given each hypothesis, we must integrate over all possible values of the parameters (qin ,
qout , qal l ) weighted by their respective probabilities. Since we have chosen a conjugate
prior, we can easily obtain a closed-form solution for these likelihoods:
P(D | H0 ) = Z P(qal l ∼ Ga(aal l , bal l )) (cid:213)
P(ci ∼ Po(qal l bi )) d qal l
si ∈G
P(D | H1 (S)) = Z P(qin ∼ Ga(ain , bin )) (cid:213)
si ∈S
× Z P(qout ∼ Ga(aout , bout )) (cid:213)
P(ci ∼ Po(qout bi )) d qout
si ∈G−S
Now, computing the integral, and letting C = (cid:229) ci and B = (cid:229) bi , we obtain:
ba
(qbi )ci e−qbi
Z P(q ∼ Ga(a, b))(cid:213)
a−1 e−bq (cid:213)
d q (cid:181)
P(ci ∼ Po(qbi )) d q = Z
q
G(a)
(ci )!
si
si
ba
ba
ba G(a + C)
a−1 e−bq q(cid:229) ci e−q (cid:229) bi d q =
a+C−1 e−(b+B)q d q =
G(a) Z q
G(a) Z q
(b + B)
a+C G(a)
Thus we have the following expressions for the marginal likelihoods: P(D | H0 ) (cid:181)
a
aout G(aout +Cout )
ain G(ain+Cin )
al l G(aal l +Cal l )
(bal l )
× (bout )
, and P(D | H1 (S)) (cid:181) (bin )
.
aout +Cout G(aout )
ain +Cin G(ain )
a
(bout +Bout )
(bin+Bin )
(bal l +Bal l )
al l +Cal l G(aal l )

P(ci ∼ Po(qin bi )) d qin

The Bayesian spatial scan statistic can be computed simply by ﬁrst calculating the score
P(D | H1 (S))P(H1 (S)) for each spatial region S, maintaining a list of regions ordered by
score. We then calculate P(D | H0 )P(H0 ), and add this to the sum of all region scores, ob-
taining the probability of the data P(D). Finally, we can compute the posterior probability
P(H1 (S) | D) = P(D | H1 (S))P(H1 (S))
for each region, as well as P(H0 | D) = P(D | H0 )P(H0 )
. Then
P(D)
P(D)
we can return all regions with non-negligible posterior probabilities, the posterior probabil-
ity of each, and the overall probability of an outbreak. Note that no randomization testing
is necessary, and thus overall complexity is proportional to number of regions searched,
e.g. O(N 4 ) for searching over axis-aligned rectangles in an N × N grid.

2.1 Choosing priors
One of the most challenging tasks in any Bayesian analysis is the choice of priors. For
any region S that we examine, we must have values of the parameter priors ain (S), bin (S),
aout (S), and bout (S), as well as the region prior probability P(H1 (S)). We must also choose
the global parameter priors aal l and bal l , as well as the “no outbreak” prior P(H0 ).
Here we consider the simple case of a uniform region prior, with a known prior probability
of an outbreak P1 .
In other words, if there is an outbreak, it is assumed to be equally
likely to occur in any spatial region. Thus we have P(H0 ) = 1 − P1 , and P(H1 (S)) = P1
,
Nreg
where Nreg is the total number of regions searched. The parameter P1 can be obtained from
historical data, estimated by human experts, or can simply be used to tune the sensitivity
and speci ﬁcity of the algorithm. The model can also be easily adapted to a non-uniform
region prior, taking into account our prior beliefs about the size and shape of outbreaks.

.

For the parameter priors, we assume that we have access to a large number of days of past
data, during which no outbreaks are known to have occurred. We can then obtain estimated
values of the parameter priors under the null hypothesis by matching the moments of each
Gamma distribution to their historical values. In other words, we set the expectation and
variance of the Gamma distribution Ga(aal l , bal l ) to the sample expectation and variance
aal l
aal lbal l
= Varsam pl e h Cal l
= Esam pl e h Cal l
Bal l i, and
Bal l i. Solving for
of Cal l
observed in past data:
b2
Bal l
al l
Bal l i(cid:17)2
(cid:16)Esam pl e h Cal l
Esam pl e h Cal l
Bal l i
aal l and bal l , we obtain aal l =
and bal l =
Varsam pl e h Cal l
Varsam pl e h Cal l
Bal l i
Bal l i
The calculation of priors ain (S), bin (S), aout (S), and bout (S) is identical except for two dif-
ferences: ﬁrst, we must condition on the region S, and second, we must assume the alterna-
tive hypothesis H1 (S) rather than the null hypothesis H0 . Repeating the above derivation for
Bout (S) i(cid:17)2
(cid:16)Esam pl e h Cout (S)
Esam pl e h Cout (S)
Bout (S) i
the “out ” parameters, we obtain aout (S) =
and bout (S) =
,
Varsam pl e h Cout (S)
Varsam pl e h Cout (S)
Bout (S) i
Bout (S) i
where Cout (S) and Bout (S) are respectively the total count (cid:229)G−S ci and total baseline (cid:229)G−S bi
outside the region. Note that an outbreak in some region S does not affect the disease rate
outside region S. Thus we can use the same values of aout (S) and bout (S) whether we are
assuming the null hypothesis H0 or the alternative hypothesis H1 (S).
On the other hand, the effect of an outbreak inside region S must be taken into account when
computing ain (S) and bin (S); since we assume that no outbreak has occurred in the past
data, we cannot just use the sample mean and variance, but must consider what we expect
these quantities to be in the event of an outbreak. We assume that the outbreak will increase
qin by a multiplicative factor m, thus multiplying the mean and variance of Cin
by m. To
Bin
account for this in the Gamma distribution Ga(ain , bin ), we multiply ain by m while leaving
Bin (S) i(cid:17)2
bin unchanged. Thus we have ain (S) = m (cid:16)Esam pl e h Cin (S)
Esam pl e h Cin (S)
Bin (S) i
and bin (S) =
Varsam pl e h Cin (S)
Varsam pl e h Cin (S)
Bin (S) i
Bin (S) i

,

where Cin (S) = (cid:229)S ci and Bin (S) = (cid:229)S bi . Since we typically do not know the exact value of
m, here we use a discretized uniform distribution for m, ranging from m = 1 . . . 3 at intervals
of 0.2. Then scores can be calculated by averaging likelihoods over the distribution of m.

Finally, we consider how to deal with the case where the past values of the counts and
baselines are not given. In this “blind Bayesian” (BBayes) c ase, we assume that counts
are randomly generated under the null hypothesis ci ∼ Po(q0 bi ), where q0 is the expected
ratio of count to baseline under the null (for example, q0 = 1 if baselines are obtained
by estimating the expected value of the count). Under this simple assumption, we can
easily compute the expectation and variance of the ratio of count to baseline under the null
E[Po(q0 B)]
Var[Po(q0 B)]
B2 = q0
= q0 B
= q0 B
hypothesis: E (cid:2) C
B = q0 , and Var (cid:2) C
B . Thus
B (cid:3) =
B (cid:3) =
B2
B
we have a = q0B and b = B under the null hypothesis. This gives us aal l = q0Bal l , bal l =
Bal l , aout (S) = q0Bout (S), bout (S) = Bout (S), ain (S) = mq0Bin (S), and bin (S) = Bin (S). We
can use a uniform distribution for m as before.
In our empirical evaluation below, we
consider both the Bayes and BBayes methods of generating parameter priors.

3 Results: detection power
We evaluated the Bayesian and frequentist methods on two types of simulated respiratory
outbreaks, injected into real Emergency Department and over-the-counter drug sales data
for Allegheny County, Pennsylvania. All data were aggregated to the zip code level to
ensure anonymity, giving the daily counts of respiratory ED cases and sales of OTC cough
and cold medication in each of 88 zip codes for one year. The baseline (expected count)
for each zip code was estimated using the mean count of the previous 28 days. Zip code
centroids were mapped to a 16 × 16 grid, and all rectangles up to 8 × 8 were examined. We
ﬁrst considered simulated aerosol releases of inhalationa l anthrax (e.g. from a bioterrorist
attack), generated by the Bayesian Aerosol Release Detector, or BARD [9]. The BARD
simulator uses a Bayesian network model to determine the number of spores inhaled by
individuals in affected areas, the resulting number and severity of anthrax cases, and the
resulting number of respiratory ED cases on each day of the outbreak in each affected zip
code. Our second type of outbreak was a simulated “Fictional Linear Onset Outbreak”
(or “FLOO”), as in [10]. A FLOO( D, T ) outbreak is a simple simulated outbreak with
duration T , which generates t D cases in each affected zip code on day t of the outbreak
(0 < t ≤ T /2), then generates T D/2 cases per day for the remainder of the outbreak. Thus
we have an outbreak where the number of cases ramps up linearly and then levels off.
While this is clearly a less realistic outbreak than the BARD-simulated anthrax attack, it
does have several advantages: most importantly, it allows us to precisely control the slope
of the outbreak curve and examine how this affects our methods’ detection ability.

To test detection power, a semi-synthetic testing framework similar to [10] was used: we
ﬁrst run our spatial scan statistic for each day of the last ni ne months of the year (the ﬁrst
three months are used only to estimate baselines and priors), and obtain the score F ∗ for
each day. Then for each outbreak we wish to test, we inject that outbreak into the data, and
obtain the score F ∗ (t ) for each day t of the outbreak. By ﬁnding the proportion of baseline
days with scores higher than F ∗ (t ), we can determine the proportion of false positives we
would have to accept to detect the outbreak on day t . This allows us to compute, for any
given level of false positives, what proportion of outbreaks can be detected, and the mean
number of days to detection. We compare three methods of computing the score F ∗ : the fre-
quentist method (F ∗ is the maximum likelihood ratio F (S) over all regions S), the Bayesian
maximum method (F ∗ is the maximum posterior probability P(H1 (S) | D) over all regions
S), and the Bayesian total method (F ∗ is the sum of posterior probabilities P(H1 (S) | D) over
all regions S, i.e. total posterior probability of an outbreak). For the two Bayesian methods,
we consider both Bayes and BBayes methods for calculating priors, thus giving us a total
of ﬁve methods to compare (frequentist, Bayes max, BBayes max, Bayes tot, BBayes tot).
In Table 1, we compare these methods with respect to proportion of outbreaks detected and

Bayes max

method
frequentist

Table 1: Days to detect and proportion of outbreaks detected, 1 false positive/month
FLOO ED
FLOO OTC
FLOO OTC
BARD ED
BARD ED
FLOO ED
FLOO ED
(25,20)
(40,14)
(.016)
(.125)
(1,20)
(2,20)
(4,14)
3.582
3.925
1.733
6.122
3.324
1.859
5.393
(100%)
(100%)
(88%)
(100%)
(96%)
(100%)
(100%)
1.600
1.740
2.875
5.043
3.755
5.455
7.588
(100%)
(79%)
(63%)
(88%)
(100%)
(100%)
(100%)
3.698
1.600
4.984
2.848
1.683
7.035
5.164
(88%)
(100%)
(100%)
(100%)
(100%)
(77%)
(65%)
3.475
5.195
3.811
1.633
5.777
3.195
1.882
(100%)
(100%)
(88%)
(100%)
(100%)
(100%)
(100%)
6.929
4.380
3.792
1.617
5.672
3.180
1.840
(100%)
(100%)
(100%)
(100%)
(88%)
(100%)
(99%)

BBayes max

Bayes tot

BBayes tot

mean number of days to detect, at a false positive rate of 1/month. Methods were evaluated
on seven types of simulated outbreaks: three FLOO outbreaks on ED data, two FLOO out-
breaks on OTC data, and two BARD outbreaks (with different amounts of anthrax release)
on ED data. For each outbreak type, each method’s performance was averaged over 100 or
250 simulated outbreaks for BARD or FLOO respectively.

In Table 1, we observe very different results for the ED and OTC datasets. For the ﬁve runs
on ED data, all four Bayesian methods consistently detected outbreaks faster than the fre-
quentist method. This difference was most evident for the more slowly growing (harder to
detect) outbreaks, especially FLOO(1,20). Across all ED outbreaks, the Bayesian meth-
ods showed an average improvement of between 0.13 days (Bayes tot) and 0.43 days
(BBayes max) as compared to the frequentist approach; “max” methods
performed sub-
stantially better than “tot ” methods, and “BBayes ” methods
performed slightly better than
“Bayes ” methods. For the two runs on OTC data, on the other han d, most of the Bayesian
methods performed much worse (over 1 day slower) than the frequentist method. The ex-
ception was the Bayes tot method, which again outperformed the frequentist method by an
average of 0.15 days. We believe that the main reason for these differing results is that the
OTC data is much noisier than the ED data, and exhibits much stronger seasonal trends.
As a result, our baseline estimates (using mean of the previous 28 days) are reasonably ac-
curate for ED, but for OTC the baseline estimates will lag behind the seasonal trends (and
thus, underestimate the expected counts for increasing trends and overestimate for decreas-
ing trends). The BBayes methods, which assume E[C/B] = 1 and thus rely heavily on the
accuracy of baseline estimates, are not reasonable for OTC. On the other hand, the Bayes
methods (which instead learn the priors from previous counts and baselines) can adjust for
consistent misestimation of baselines and thus more accurately account for these seasonal
trends. The “max” methods perform badly on the OTC data becau se a large number of
baseline days have posterior probabilities close to 1; in this case, the maximum region pos-
terior varies wildly from day to day, depending on how much of the total probability is
assigned to a single region, and is not a reliable measure of whether an outbreak has oc-
curred. The total posterior probability of an outbreak, on the other hand, will still be higher
for outbreak than non-outbreak days, so the “tot ” methods ca n perform well on OTC as
well as ED data. Thus, our main result is that the Bayes tot method, which infers baselines
from past counts and uses total posterior probability of an outbreak to decide when to sound
the alarm, consistently outperforms the frequentist method for both ED and OTC datasets.

4 Results: computation time
As noted above, the Bayesian spatial scan must search over all rectangular regions for the
original grid only, while the frequentist scan (in order to calculate statistical signi ﬁcance by
randomization) must also search over all rectangular regions for a large number (typically
R = 1000) of replica grids. Thus, as long as the search time per region is comparable for the
Bayesian and frequentist methods, we expect the Bayesian approach to be approximately
1000x faster. In Table 2, we compare the run times of the Bayes, BBayes, and frequen-

Table 2: Comparison of run times for varying grid size N
N = 256
N = 128
N = 64
N = 32
N = 16
method
12 hrs
44 min
2.8 min
10.8 sec
0.7 sec
Bayes (naive)
37 min
2.4 min
9.3 sec
0.6 sec
BBayes (naive)
10 hrs
∼500 days
∼31 days
49 hrs
2.9 hrs
12 min
frequentist (naive)
frequentist (fast)
20 sec
1.8 min
10.7 min
77 min
10 hrs

tist methods for searching a single grid and calculating signi ﬁcance ( p-values or posterior
probabilities for the frequentist and Bayesian methods respectively), as a function of the
grid size N . All rectangles up to size N /2 were searched, and for the frequentist method
R = 1000 replications were performed. The results conﬁrm our in tuition: the Bayesian
methods are 900-1200x faster than the frequentist approach, for all values of N tested.
However, the frequentist approach can be accelerated dramatically using our “fast spatial
scan” algorithm [2], a multiresolution search method which can ﬁnd the highest scoring
region of a grid while searching only a small subset of regions. Comparing the fast spatial
scan to the Bayesian approach, we see that the fast spatial scan is slower than the Bayesian
method for grid sizes up to N = 128, but slightly faster for N = 256. Thus we now have two
options for making the spatial scan statistic computationally feasible for large grid sizes:
to use the fast spatial scan to speed up the frequentist scan statistic, or to use the Bayesian
scan statistics framework (in which case the naive algorithm is typically fast enough). For
even larger grid sizes, it may be possible to extend the fast spatial scan to the Bayesian
approach: this would give us the best of both worlds, searching only one grid, and using a
fast algorithm to do so. We are currently investigating this potentially useful synthesis.
5 Discussion
We have presented a Bayesian spatial scan statistic, and demonstrated several ways in
which this method is preferable to the standard (frequentist) scan statistics approach. In
Section 3, we demonstrated that the Bayesian method, with a relatively non-informative
prior distribution, consistently outperforms the frequentist method with respect to detec-
tion power. Since the Bayesian framework allows us to easily incorporate prior informa-
tion about size, shape, and impact of an outbreak, it is likely that we can achieve even
better detection performance using more informative priors, e.g. obtained from experts in
the domain. In Section 4, we demonstrated that the Bayesian spatial scan can be computed
in much less time than the frequentist method, since randomization testing is unnecessary.
This allows us to search large grid sizes using a naive search algorithm, and even larger
grids might be searched by extending the fast spatial scan to the Bayesian framework.

We now consider three other arguments for use of the Bayesian spatial scan. First, the
Bayesian method has easily interpretable results: it outputs the posterior probability that
an outbreak has occurred, and the distribution of this probability over possible outbreak
regions. This makes it easy for a user (e.g. public health ofﬁ cial) to decide whether to
investigate each potential outbreak based on the costs of false positives and false negatives;
this type of decision analysis cannot be done easily in the frequentist framework. Another
useful result of the Bayesian method is that we can compute a “ map” of the posterior proba-
bilities of an outbreak in each grid cell, by summing the posterior probabilities P(H1 (S) | D)
of all regions containing that cell. This technique allows us to deal with the case where the
posterior probability mass is spread among many regions, by observing cells which are
common to most or all of these regions. We give an example of such a map below:

Figure 1: Output of Bayesian spatial scan on baseline OTC data, 1/30/05.
Cell shading is based on posterior probability of an outbreak in that cell,
ranging from white (0%) to black (100%). The bold rectangle represents
the most likely region (posterior probability 12.27%) and the darkest cell
is the most likely cell (total posterior probability 86.57%). Total posterior
probability of an outbreak is 86.61%.

Second, calibration of the Bayesian statistic is easier than calibration of the frequentist
statistic. As noted above, it is simple to adjust the sensitivity and speci ﬁcity of the Bayesian
method by setting the prior probability of an outbreak P1 , and then we can “sound the
alarm” whenever posterior probability of an outbreak excee ds some threshold. In the fre-
quentist method, on the other hand, many regions in the baseline data have sufﬁciently
high likelihood ratios that no replicas beat the original grid; thus we cannot distinguish the
p-values of outbreak and non-outbreak days. While one alternative is to “sound the alarm”
when the likelihood ratio is above some threshold (rather than when p-value is below some
threshold), this is technically incorrect: because the baselines for each day of data are dif-
ferent, the distribution of region scores under the null hypothesis will also differ from day
to day, and thus days with higher likelihood ratios do not necessarily have lower p-values.
Third, we argue that it is easier to combine evidence from multiple detectors within the
Bayesian framework, i.e. by modeling the joint probability distribution. We are in the pro-
cess of examining Bayesian detectors which look simultaneously at the day’s Emergency
Department records and over-the-counter drug sales in order to detect emerging clusters,
and we believe that combination of detectors is an important area for future research.

In conclusion, we note that, though both Bayesian modeling [7-8] and (frequentist) spa-
tial scanning [3-4] are common in the spatial statistics literature, this is (to the best of our
knowledge) the ﬁrst model which combines the two techniques
into a single framework.
In fact, very little work exists on Bayesian methods for spatial cluster detection. One no-
table exception is the literature on spatial cluster modeling [11-12], which attempts to infer
the location of cluster centers by inferring parameters of a Bayesian process model. Our
work differs from these methods both in its computational tractability (their models typi-
cally have no closed form solution, so computationally expensive MCMC approximations
are used) and its easy interpretability (their models give no indication as to statistical sig-
ni ﬁcance or posterior probability of clusters found). Thus we believe that this is the ﬁrst
Bayesian spatial cluster detection method which is powerful and useful, yet computation-
ally tractable. We are currently running the Bayesian and frequentist scan statistics on
daily OTC sales data from over 10000 stores, searching for emerging disease outbreaks on
a daily basis nationwide. Additionally, we are working to extend the Bayesian statistic to
fMRI data, with the goal of discovering regions of brain activity corresponding to given
cognitive tasks [13, 6]. We believe that the Bayesian approach has the potential to improve
both speed and detection power of the spatial scan in this domain as well.
References
[1] M. Kulldorff. 1999. Spatial scan statistics: models, calculations, and applications. In J. Glaz and M. Balakrishnan, eds., Scan
Statistics and Applications, Birkhauser, 303-322.
[2] D. B. Neill and A. W. Moore. 2004. Rapid detection of signiﬁcant spatial cl usters. In Proc. 10th ACM SIGKDD Intl. Conf.
on Knowledge Discovery and Data Mining, 256-265.
[3] M. Kulldorff and N. Nagarwalla. 1995. Spatial disease clusters: detection and inference. Statistics in Medicine 14, 799-810.
[4] M. Kulldorff. 1997. A spatial scan statistic. Communications in Statistics: Theory and Methods 26(6), 1481-1496.
[5] D. B. Neill and A. W. Moore. 2004. A fast multi-resolution method for detection of signiﬁcant spatial disease clusters. In
Advances in Neural Information Processing Systems 16, 651-658.
[6] D. B. Neill, A. W. Moore, F. Pereira, and T. Mitchell. 2005. Detecting signiﬁcant multidimensional spatial clusters.
Advances in Neural Information Processing Systems 17, 969-976.
[7] D. G. Clayton and J. Kaldor. 1987. Empirical Bayes estimates of age-standardized relative risks for use in disease mapping.
Biometrics 43, 671-681.
[8] A. Molli ´e. 1999. Bayesian and empirical Bayes approaches to disease mapping. In A. B. Lawson, et al., eds. Disease Mapping
and Risk Assessment for Public Health. Wiley, Chichester.
[9] W. Hogan, G. Cooper, M. Wagner, and G. Wallstrom. 2004. A Bayesian anthrax aerosol release detector. Technical Report,
RODS Laboratory, University of Pittsburgh.
[10] D. B. Neill, A. W. Moore, M. Sabhnani, and K. Daniel. 2005. Detection of emerging space-time clusters. In Proc. 11th ACM
SIGKDD Intl. Conf. on Knowledge Discovery and Data Mining.
[11] R. E. Gangnon and M. K. Clayton. 2000. Bayesian detection and modeling of spatial disease clustering. Biometrics 56,
922-935.
[12] A. B. Lawson and D. G. T. Denison, eds. 2002. Spatial Cluster Modelling. Chapman & Hall/CRC, Boca Raton, FL.
[13] X. Wang, R. Hutchinson, and T. Mitchell. 2004. Training fMRI classiﬁ ers to detect cognitive states across multiple human
subjects. In Advances in Neural Information Processing Systems 16, 709-716.

In

