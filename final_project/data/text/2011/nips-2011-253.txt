Uniqueness of Belief Propagation on Signed Graphs

Yusuke Watanabe(cid:3)
The Institute of Statistical Mathematics
10-3 Midori-cho, Tachikawa, Tokyo 190-8562, Japan
watay@ism.ac.jp

Abstract

While loopy Belief Propagation (LBP) has been utilized in a wide variety of ap-
plications with empirical success, it comes with few theoretical guarantees. Es-
pecially, if the interactions of random variables in a graphical model are strong,
the behaviors of the algorithm can be difﬁcult to analyze due to underlying phase
transitions. In this paper, we develop a novel approach to the uniqueness problem
of the LBP ﬁxed point; our new “necessary and sufﬁcient” condition is stated in
terms of graphs and signs, where the sign denotes the types (attractive/repulsive)
of the interaction (i.e., compatibility function) on the edge. In all previous works,
uniqueness is guaranteed only in the situations where the strength of the interac-
tions are “sufﬁciently” small in certain senses. In contrast, our condition covers
arbitrary strong interactions on the speciﬁed class of signed graphs. The result
of this paper is based on the recent theoretical advance in the LBP algorithm; the
connection with the graph zeta function.

1 Introduction

The belief propagation algorithm [1] was originally proposed as an efﬁcient method for the exact
computation in the inference with graphical models associated to trees; the algorithm has been
extended to general graphs with cycles and called Loopy Belief Propagation (LBP) algorithm. It has
shown empirical success in a wide class of problems including computer vision, compressed sensing
and error correcting codes [2, 3, 4]. In such applications, existence of cycles and strong interactions
between variables make the behaviors of the LBP algorithm difﬁcult to analyze. In this paper we
propose a novel approach to the uniqueness problem of LBP ﬁxed point.
Although a considerable number of researches have been done in this decade [5, 6], understating
of the LBP algorithm is not yet complete. An important step toward better understanding of the
algorithm has been the variational interpretation by the Bethe free energy function; the ﬁxed points
of LBP correspond to the stationary points of the Bethe free energy function [7]. This view provides
a number of algorithms that (provably) ﬁnd a stationary point of the Bethe free energy function
[8, 9, 10, 11]. For the uniqueness problem of the LBP ﬁxed point a number of conditions has been
proposed [12, 13, 14, 15]. (Note that the convergence property implies uniqueness by deﬁnition.)
In all previous works, the uniqueness is guaranteed only in the situations where the strength of the
interactions are “sufﬁciently” small in certain senses.
In this paper we propose a completely new approach to the uniqueness condition of the LBP algo-
rithm; it should be emphasized that strength of interactions on speciﬁed class of signed graphs can
be arbitrary large in this condition. (The signs denote the attractive/repulsive types of the compat-
ibility function on the edges.) Generally speaking, the behavior of the algorithm is complex if the
strength of interactions are strong. In such regions, phase transition phenomena can occur in the un-
derlying computation tree [15], making theoretical analyses difﬁcult. To overcome such difﬁculties,
(cid:3)

Current afﬁliation: SONY, Intelligent Systems Research Laboratory. YusukeB.Watanabe@jp.sony.com

1

we utilize the connection between the Bethe free energy and the graph zeta function established in
[16]; the determinant of the Hessian of the Bethe free energy equals the reciprocal of the graph zeta
function up to a positive factor. Combined with the index formula [16], the uniqueness problem is
reduced to a positivity property of the graph zeta function.
This paper is organized as follows. In section 2 we introduce the background of LBP. In section 3
we explain the condition for the uniqueness, which is the main result of this paper. In section 4 the
proof of the main result is given by a graph theoretic approach. In section 5 we remark foregoing
researches based on the new technique.

2 Loopy Belief Propagation, Bethe free energy and graph zeta function

p(x)

(2)

p(x)

and

p(x) =

pi (xi ) :=

pij (xi ; xj ) :=

In this section, we provide basic facts on LBP; the connection with the Bethe free energy and graph
zeta function. Throughout this paper, G = (V ; E ) is a connected undirected graph with V , the
Y
Y
vertices, and E , the undirected edges. We consider the binary pairwise model, which is given by the
following factorization form with respect to G:
1
 ij (xi ; xj )
 i (xi );
Z
i2V
ij2E
where x = (xi )i2V is a list of binary ( i.e., xi 2 f(cid:6)1g) variables, Z is the normalization constant
and  ij ;  i are positive functions called compatibility functions. Without loss of generality we
assume that  ij (xi ; xj ) = exp(Jij xixj ) and  i (xi ) = exp(hixi ). We refer Jij as interaction and
its absolute value as “strength”.
X
X
In various applications, we would like to compute marginal distributions
xnfxi xj g
xnfxi g
though exact computations are often intractable due to the combinatorial complexities. If the graph
is a tree, however, they are efﬁciently computed by the belief propagation algorithm [1]. Even if
the graph has cycles, the direct application of the algorithm (Loopy Belief Propagation; LBP) often
gives good approximation [6].
X
Y
LBP is a message passing algorithm. For each directed edge, a message vector (cid:22)i!j (xj ) is assigned
and initialized arbitrarily. The update rule of messages is given by
i!j (xj ) /
(cid:22)k!i (xi );
(cid:22)new
 j i (xj ; xi ) i (xi )
k2Ni nj
xi
where Ni is the neighborhood of i 2 V . The order of edges in the update is arbitrary; the set of
ﬁxed point does not depend on the order. If the messages converge to some ﬁxed point f(cid:22)
i!j (xj )g,
1
Y
the approximations of pi (xi ) and pij (xi ; xj ) are calculated as
Y
Y
bi (xi ) /  i (xi )
1
k!i (xi );
(cid:22)
k2Ni
bij (xi ; xj ) /  ij (xi ; xj ) i (xi ) j (xj )
1
P
P
k!i (xi )
(cid:22)
(cid:22)
P
k2Nj ni
k2Ni nj
bij (xi ; xj ) = 1. From (3) and (5), the constraints
with normalization
bi (xi ) = 1 and
xi ;xj
xi
bij (xi ; xj ) = bi (xi ) are automatically satisﬁed.
bij (xi ; xj ) > 0, and
xj

1
k!j (xj );

(4)

(5)

(1)

(3)

2.1 The Bethe free energy
o
n
X
X
The LBP algorithm is interpreted as a variational problem of the Bethe free energy function [7]. In
this formulation, the domain of the function is given by
fqi ; qij g; qij (xi ; xj ) > 0;
qij (xi ; xj ) = qi (xi )
xj
xi ;xj

qij (xi ; xj ) = 1;

L(G) =

(6)

2

and element of this set is called pseudomarginals, i.e., a set of locally consistent probability distri-
X
X
X
X
butions. The closure of this set is called local marginal polytope [6]. The objective function called
Bethe free energy is deﬁned on L(G) by:
X
X
X
X
F (q) := (cid:0)
qij (xi ; xj ) log  ij (xi ; xj ) (cid:0)
qi (xi ) log  i (xi )
i2V
ij2E
xi xj
xi
(1 (cid:0) di )
(7)
+
qij (xi ; xj ) log qij (xi ; xj ) +
qi (xi ) log qi (xi );
i2V
ij2E
xi
xi xj
where di = jNi j. The outcome of this variational problem is the same as that of LBP. More precisely,
there is a one-to-one correspondence between the set of stationary points of the Bethe free energy
and the set of ﬁxed points of LBP. The correspondence is given by (4, 5).

2.2 Zeta function and Ihara’s formula

g(p) := ue1

In this section, we explain the connection of LBP to the graph zeta function. We use the follow-
ing terms for graphs [17, 16]. Let ~E be the set of directed edges obtained by duplicating undi-
rected edges. For each directed edge e 2 ~E , o(e) 2 V is the origin of e and t(e) 2 V is
the terminus of e. For e 2 ~E , the inverse edge is denoted by (cid:22)e, and the corresponding undi-
rected edge by [e] = [(cid:22)e] 2 E . A closed geodesic in G is a sequence (e1 ; : : : ; ek ) of directed
6= (cid:22)ei+1 for i 2 Z=kZ. For a closed geodesic c, we may
edges such that t(ei ) = o(ei+1 ); ei
form the m-multiple, cm , by repeating it m-times. A closed geodesic c is prime if there are no
closed geodesic d and natural number m((cid:21) 2) such that c = dm . For example, a closed geodesic
c = (e1 ; e2 ; e3 ; e1 ; e2 ; e3 ) is not prime and c = (e1 ; e2 ; e3 ; e4 ; e1 ; e2 ; e3 ) is prime. Two closed
geodesics are said to be equivalent if one is obtained by cyclic permutation of the other. For exam-
ple, closed geodesics (e1 ; e2 ; e3 ); (e2 ; e3 ; e1 ) and (e3 ; e1 ; e2 ) are equivalent. An equivalence class
Y
of prime closed geodesics is called a prime cycle. Let P be the set of prime cycles of G. For given
(complex or real) weights u = (ue )e2 ~E , the Ihara’s graph zeta function [18, 19] is given by
(1 (cid:0) g(p))
(cid:1) (cid:1) (cid:1) uek
(cid:0)1
for p = (e1 ; : : : ; ek );
(cid:16)G (u) :=
p2P
= det(I (cid:0) UM)
(cid:0)1 ;
(cid:26)
where the second equality is the determinant representation [19] with matrices indexed by the di-
rected edges. The deﬁnitions of M and U are
if e 6= (cid:22)e0 and o(e) = t(e
0
Me;e0 :=
1
otherwise.
0
and Ue;e0 := ue (cid:14)e;e0 , respectively.
The following theorem gives the connection between the Bethe free energy and the zeta function.
More precisely, the theorem asserts that the determinant of the Hessian of the Bethe free energy
Y
Y
Y
Y
function is the reciprocal of the zeta function up to a positive factor.
Theorem 1 ([16, 20]). The following equality holds at any point of L(G):
(cid:0)1 = det(r2F )
qi (xi )1(cid:0)di 22jV j+4jE j
(cid:16)G (u)
qij (xi ; xj )
xi=(cid:6)1
xi ;xj =(cid:6)1
i2V
ij2E
where the derivatives are taken over a afﬁne coordinate of L(G): mi = Eqi [xi ]; (cid:31)ij = Eqij [xixj ],
(cid:31)ij (cid:0) mimj
and
Covqij [xi ; xj ]
ui!j =
fVarqi [xi ]Varqj [xj ]g1=2
i )(1 (cid:0) m2
f(1 (cid:0) m2
j )g1=2
(10)
: =: (cid:12)ij
Note that, from (7), the Hessian r2F does not depend on Jij and hi . Since the weight (10) in
Theorem 1 is symmetric with respect to the inversion of edges, the zeta function can be reduced
to undirected edge weights. To avoid confusion, we introduce a notation:
the zeta function of
undirected edge weights (cid:12) = ((cid:12)ij )ij2E is denoted by ZG ((cid:12)). Note also that, since (cid:12)ij is the
correlation coefﬁcient of qij , we have j(cid:12)ij j < 1. The equality does not occur by the positivity
assumption of probabilities.

(9)

);

(8)

=

3

Figure 1: w1-reduction

Figure 2: Example of the complete w-
reduction.

3 Signed graphs with unique solution

In this section, we state the main result of this paper, Theorem 3. The result shows a new type of
approach towards uniqueness conditions. The proof of the theorem is given in the next section.

3.1 Existing conditions on uniqueness

There have been many works on the uniqueness and/or convergence of the LBP algorithm for dis-
crete graphical models [12, 13, 14, 15] and Gaussian graphical models [21]. As we are discussing
binary pairwise graphical models, we review some of the conditions for the model. The following
condition is given by Mooij and Kappen:
Theorem 2. [[13]] Let (cid:26)(X ) denote the spectral radius (i.e., the maximum of the absolute value of
the eigenvalues) of a matrix X . If (cid:26)(J M) < 1, then the LBP converges to the unique ﬁxed point,
where J is a diagonal matrix deﬁned by Je;e0 = tanh(jJe j)(cid:14)e;e0 .
This theorem gives the uniqueness property by bounding the strengths of the interactions, i.e.,
fjJij jgij2E . Therefore, the condition does not depend on the signs of the interactions. The situ-
X
ations are the same in other existing conditions [12, 13, 14, 15]. For example, Heskes’s condition
[12] is
jJij j < 1:
j2Ni

(11)

These conditions are unsatisfactory in a sense that they do not use the information of the signs,
fsgn Jij gij2E . In fact, the behaviors of LBP algorithm can be dramatically different if the signs
of the compatibility functions are changed. Note that each edge compatibility function  ij tend to
force the variables xi ; xj equal if Jij > 0 and not equal if Jij < 0; the ﬁrst case is called attractive
interaction and the latter repulsive. In contrast to the above uniqueness conditions, we pursue another
approach: we use the information of signs, fsgn Jij gij2E , rather than the strengths. In this paper,
we characterize the signed graphs that guarantee the uniqueness of the solution; this result is stated
in Theorem 3.

3.2 Statement of main theorem of this section

We introduce basic terms to state the main theorem. A signed graph, (G; s), is a graph equipped
with a sign map, s, from the edges to f(cid:6)1g. A compatibility function deﬁnes the sign function, s,
by s(ij ) = sgn Jij . The sign function of all plus (resp. minus) sign is denoted by s+ (resp. s(cid:0) ).
The deletion and subgraph of a signed graph is deﬁned naturally restricting the sign function.
Deﬁnition 1. A w-reduction of a signed graph (G; s) is a signed graph that is obtained by one of
the following operations:
(w1) Erasure of a vertex of degree two. (Let j be a vertex of degree two and ij; j k (i 6= k) be
the connecting edges. Delete them and make a new edge ik with the sign s(ij )s(j k). See
Figure 1.)
(w2) Deletion of a loop with minus sign. (An edge ij is called a loop if i = j .)
(w3) Contraction of a bridge. (An edge is a bridge if the deletion of the edge makes the number of
the connected component increase. The sign on the bridge can be either +1 or (cid:0)1.)

4

Figure 3: B3

Figure 4: P3

Figure 5: D4 .

Figure 6: Example 4 in Subsection 3.3.

Note that all the operations decrease the number of edges by one. A signed graph is w-reduced if
no w-reduction is applicable. Any signed graph is reduced to the unique w-reduced signed graph
called the complete w-reduction. Example of a complete w-reduction is given in Figure 2. From
the viewpoint of the computational complexity, ﬁnding the complete w-reduction is easy. (See the
supplementary material for further discussions.)

Here are important (signed) graphs. See Figures 3, 4 and 5. A bouquet graph, Bn , is a graph with the
single node with n loops. Pn is a graph with two vertices and n parallel edges. Kn is the complete
graph of n vertices. Cn is cycle of length n. Dn is a signed graph obtained by duplicating each edge
of Cn with plus and minus signs.
0
Deﬁnition 2. Two signed graphs (G; s) and (G; s
) are said to be gauge equivalent if there exists a
map g : V (cid:0)! f(cid:6)1g such that s
0
(ij ) = s(ij )g(i)g(j ). The map g is called gauge transformation.
Theorem 3. For a signed graph (G; s) the following conditions are equivalent.

1. LBP algorithm on G has the unique ﬁxed point for any compatibility functions with sign s.

2. The complete w-reduction of (G; s) is one of the followings:
(i) B0 (ii) (B1 ; +) (iii)
(P3 ; +; (cid:0); (cid:0)) and (P3 ; +; +; (cid:0)). (iv) (K4 ; s(cid:0) ) and its gauge equivalent signed graphs.
(v) Dn and its w-reduced subgraphs (n (cid:21) 2).
The proof of this theorem is given in the next section.

3.3 Examples and experiments

In this subsection we present concrete examples of signed graphs which do or do not satisfy the
condition of Theorem 3.
(Ex.1) Trees and graphs with a single cycle: In these cases it is well known that LBP has the unique
ﬁxed point irrespective of the compatibility functions [1, 22]. This fact is easily derived by Theorem
3 since the complete w-reduction of them are B0 or (B1 ; +). (Ex.2) Complete graph Kn : (Kn ; s)
is w-reduced as we can not apply w-reduction. For n = 4, the condition of sign is given in 2.(iv).
If n (cid:21) 5 it does not satisfy the condition for any sign. (Ex.3) 2 (cid:2) 2 grid graph: This graph does
not satisfy the condition for any sign because its complete w-reduction is different from the signed
graphs in the item 2 of Theorem 3. (Ex.4) Consider a signed graph in Figure 6. Notice that the
products of signs along the ﬁve cycles are all minus. Applying (w2) and (w3), we see that the
complete w-reduction is B0 . Therefore the signed graph satisﬁes the condition.
We experimentally check convergence behaviors of the LBP algorithm on D4 , which satisﬁes the
condition of Theorem 3. Since the LBP ﬁxed point is unique, it is the absolute minimum of the
Bethe free energy function. We set the compatibility functions Jij = (cid:6)J; hi = h and initialized
(cid:0)3 after 50
messages randomly. We judged convergence if average message update is less than 10
iterations. The result is shown in Figure 7. LBP is not convergent in the right white region and
convergent in the rest of gray region. Convergence is theoretically guaranteed for tanh(jJ j) < 1=3
(jJ j / 0:347) by Theorem 2. In the non-convergent region LBP appears to be unstable around the
ﬁxed point.

4 Proofs: conditions in terms of graph zeta function

The aim of this subsection is to prove Theorem 3. For the proof, Lemma 2, which is purely a result
of the graph zeta function, is utilized.

5

Figure 7: Convergence region of LBP.

Figure 8: X1 and X2 .

4.1 Graph theoretic results
We denote by G (cid:0) (cid:15) the deletion of an undirected edge (cid:15) from a graph G and by G=(cid:15) the contraction.
A minor of a graph is obtained by the repeated applications of the deletion, contraction and removal
of isolated vertices. The Deletion and contraction operations have natural meaning in the context of
the graph zeta function as follows:
Lemma 1.

G ( ~u), where ~ue is equal to ue if [e] 6= ij and 0
(cid:0)1
(cid:0)1
1. Let ij be an edge, then (cid:16)
G(cid:0)ij (u) = (cid:16)
otherwise.
G ( ~u), where ~ue is equal to ue if [e] 6= ij
(cid:0)1
(cid:0)1
2. Let ij be a non-loop edge, then (cid:16)
G=ij (u) = (cid:16)
and 1 otherwise.

Proof. From the prime cycle representation of zeta functions, both of the assertions are trivial.

Next, to prove Theorem 3, we formally deﬁne the notion of deletions, contractions and minors on
signed graphs [23]. For a signed graph the signed-deletion of an edge is just the deletion of the
edge along with the sign on it. The signed-contraction of a non-loop edge ij 2 E is deﬁned up to
gauge equivalence as follows. For any non-loop edge ij , there is a gauge equivalent signed graph
that has the sign + on ij . The signed-contraction is obtained by contracting the edge. The resulting
signed graph is determined up to gauge equivalence. A signed minor of a signed graph is obtained
by repeated applications of the signed-deletion, signed-contraction, and removal of isolated vertices.
Lemma 2. For a signed graph, (G; s), the following conditions are equivalent.
1. (G; s) is U-type. That is, if (cid:12)ij 2 Is(ij ) for all ij 2 E then Z
(cid:0)1
G ((cid:12)) > 0, where (cid:12) =
((cid:12)ij )ij2E , I+ = [0; 1) and I(cid:0) = ((cid:0)1; 0].
2. (G; s) is weakly U-type. That is, if (cid:12)ij 2 Is(ij ) for all ij 2 E then Z
G ((cid:12)) (cid:21) 0
(cid:0)1
3. (B2 ; s+ ) is not contained as a signed minor.

4. The complete w-reduction of (G; s) is one of the followings: (i) B0 (ii) (B1 ; s+ ) (iii)
(P3 ; +; (cid:0); (cid:0)) and (P3 ; +; +; (cid:0)). (iv) (K4 ; s(cid:0) ) and its gauge equivalent signed graphs.
(v) Dn and its w-reduced subgraphs (n (cid:21) 2).
The uniqueness condition in Theorem 3 is equivalent to all the conditions in this lemma. Here, we
remark properties of this condition (the proof is straightforward from deﬁnition and Lemma 2):

(1) (G; s) is U-type iff its gauge equivalents are U-type.
(2) If (G; s) is U-type then its signed minors are U-type.

We prove the equivalence cyclic manner. Here we give a sketch of the proof (Detail is given in the
supplementary material.)

6

BM =

Proof of 1 ) 2. Trivial.
Proof of 2 ) 3. If (G; s) is weakly U-type, then its signed minors are weakly U-type; this is obvious
264 (cid:12)(cid:15)1 (cid:12)(cid:15)1
375
from Lemma 1. However, direct computation of the zeta of (B2 ; s+ ) shows that this signed graph is
not weakly U-type. In fact, the directed edge matrix with weight of B2 is
(cid:12)(cid:15)1
0
(cid:12)(cid:15)2 (cid:12)(cid:15)2 (cid:12)(cid:15)2
0
0
(cid:12)(cid:15)1 (cid:12)(cid:15)1 (cid:12)(cid:15)1
(cid:12)(cid:15)2
0
(cid:12)(cid:15)2 (cid:12)(cid:15)2
and det(I (cid:0) BM) = (1 (cid:0) (cid:12)(cid:15)1 )(1 (cid:0) (cid:12)(cid:15)2 )(1 (cid:0) (cid:12)(cid:15)1
(cid:0) 3(cid:12)(cid:15)1 (cid:12)(cid:15)2 ). This value can be negative in
(cid:0) (cid:12)(cid:15)2
the region 0 (cid:20) (cid:12)(cid:15)1 ; (cid:12)(cid:15)2 < 1.
Proof of 3 ) 4. Note that if (G; s) does not contain (B2 ; s+ ) as a signed minor then any w-
reductions of (G; s) also do not contain (B2 ; s+ ) as a signed minor; we can check this property
for each type of w-reductions, (w,1,2,3).
Therefore, it is sufﬁcient to show that if a w-reduced signed graph (G; s) does not contain (B2 ; +; +)
as a signed minor then it is one of the ﬁve types. Notice that G has no vertex of degree less than
three. First, if the nullity of G is less than three, it is not hard to see that the signed graph is type
(i), (ii) or (iii). Secondly, we consider the case that the graph G has nullity three. Note that all
w-reduced signed graphs of nullity two have the signed minor (B1 ; +). Therefore, we can assume
that G does not have (plus) loop. Since (G; s) is w-reduced, G must be one of the following graphs:
K4 ; P4 ; X1 and X2 , where X1 and X2 are deﬁned in Figure 8. It is easy to check that possible way
of assigning signs on these graphs are one of the types, (iii-v). Finally, we consider the case of the
nullity, n, is more than three. In this case, we can show that (G; s) must be Dn or its subgraph.
(Details are found in the supplementary material.)
Y
Proof of 4 ) 1. First we claim the following statement: if
G (u) (cid:21) 0 8u = (ue ) 2
(cid:0)1
(cid:16)
e2 ~E
G (u) = det(I (cid:0) UM)
(cid:0)1
then (G; s) is U-type. This claim can be proved using the property that (cid:16)
(cid:0)1
is linear for each variable, ue . (That is, if we ﬁx u except for one variable, say ue1 , then (cid:16)
G =
C1 + C2ue1 .) Take the product of the closed intervals from 0 to s(e) (e 2 ~E ) and make a hypercube.
If there is a non-positive point in the hypercube then there must be a non-positive point in a face; we
can repeat this argument until we arrive at a vertex.
We check the condition (12) for all the four classes. Notice that if (G; s) satisﬁes (12) then its gauge
equivalents, the deletion and signed-contraction has the same property. So far, we have proven the
assertion for w-reduced graphs; we extend the proof to arbitrary signed graphs. For any signed
graph, the complete w-reductions are obtained by ﬁrst using reductions (w1,w2) and then reducing
the bridges (w3) because (w3) always makes the degree bigger and does not make a loop. Therefore,
the following two claims complete the proof.
0
0
Claim 1. Let (G
) be a (w3)-reduction of a signed graph (G; s), i.e., obtained by contraction of
0
) has the property (12) then (G; s) also has the property.
a bridge (cid:15). If (G

f0; s([e])g;

; s
0
; s

(12)

Proof of Claim 1. Let b and (cid:22)b be the corresponding directed edges of (cid:15). Since any prime cycles pass
b and (cid:22)b at the same number of times,
(cid:0)1
(cid:0)1
G(cid:0)(cid:15) ( ~u) + ubu(cid:22)b f ( ~u);
(cid:16)
G (u) = (cid:16)
where ~u is restriction of u on G (cid:0) (cid:15) and f is a function. Assume that s((cid:15)) = 1.
(The case
s((cid:15)) = (cid:0)1 is completely analogous.) Since (G
0
0
) has the property (12), (G; s) has the property
; s
for (ub ; u(cid:22)b ) = (1; 1). For (ub ; u(cid:22)b ) = (0; 0); (1; 0); (0; 1) cases, we can deduce form the property of
G (cid:0) (cid:15). (cid:4)
0
0
Claim 2. Let (G
) be a (w1) or (w2)-reduction of a signed graph (G; s). If (G
; s
then (G; s) is U-type.

) is U-type

(13)

; s

0

0

7

Q
Proof of Claim 2. The case of (w1) is trivial. We prove the case (w2). From the multivariate
(cid:0)1
Ihara’s formula, the positivity of Z
G0 ((cid:12)) on the set
ij2E Is(ij ) implies the positive deﬁniteness of
I + ^D 0 (cid:0) ^A0 on the set. Adding a minus loop correspond to adding 2(cid:12) 2 (1 (cid:0) (cid:12) 2 )
(cid:0)1 (cid:0) 2(cid:12) (1 (cid:0) (cid:12) 2 )
= (cid:0)2(cid:12) (1 + (cid:12) ) on the diagonal, where (cid:0)1 < (cid:12) (cid:20) 0. Therefore the new matrix is also positive
deﬁnite and (G; s) is U-type. (cid:4)

4.2 Proof of Theorem 3
Proof of 2 ) 1. The basic strategy is to use the following theorem.
Theorem 4 (Index sum theorem [16]). As usual, consider the Bethe free energy function, F , deﬁned
on L(G). Assume that det r2F (q) 6= 0 for all LBP ﬁxed points q . Then the sum of indices at the
(cid:26)
X
(cid:1)
(cid:0)
LBP ﬁxed points are equal to one:
det r2F (q)
if x > 0;
1
(cid:0)1 if x < 0:
where sgn(x) :=
sgn
= 1;
q :rF (q)=0
(We call each summand, which is +1 or (cid:0)1, the index of F at q .)
of (cid:12)ij and Jij are equal [16], (cid:12) = ((cid:12)ij ) 2 Q
At each LBP ﬁxed point, the beta values for a solution can be computed using (10). Since the signs
ij2E Is(ij ) is satisﬁed. Therefore, from the assumption
and Lemma 2, the index of the solution is positive. We conclude the uniqueness of the solution from
the above index sum theorem.
(cid:12) = ((cid:12)ij ) 2 Q
Proof of 1 ) 2. We show the contraposition. From Lemma 2, (G; s) is not weakly U-type; there is
G ((cid:12)) < 0. Take pseudomarginals q = fqij gij2E [ fqigi2V
(cid:0)1
ij2E Is(ij ) such that (cid:16)
1A :
0@ X
that has the correlation coefﬁcients of qij equal to (cid:12)ij . (For example, set (cid:31)ij = (cid:12)ij ; mi = 0.) We
Y
Y
X
can choose Jij and hi such that
i2V
ij2E
i2V
ij2E
This construction implies that q correspond to a LBP ﬁxed point with compatibility functions
fJij ; hi g. This solution has index -1 by deﬁnition.
If this is the unique solution, it contradicts
the index sum formula. Therefore, there must be other solutions.

(xi ) / exp

qij (xi ; xj )

q1(cid:0)di
i

Jij xixj +

hixi

(14)

5 Concluding remarks

In this paper we have developed a new approach to the uniqueness problem of the LBP algorithm.
As a result, we have obtained a new class of LBPs that are guaranteed to have the unique solution.
The uniqueness problem is reduced to the properties of graph zeta functions, Lemma 2, using the
indexed formula. In contrast to the existing conditions, our uniqueness guarantee includes graphical
models with strong interactions. Though our result is shown in the case of binary pairwise models,
the idea can be extended to factor graph models with many states. In fact, Theorem 1 has been
extended to the general settings of the LBP algorithm on factor graphs [20].
One direction for the future research is to combine the information of the signs and strengths of
the interactions to show the uniqueness. The uniqueness problem is reduced to the positivity of the
graph zeta function on a restricted set, rather than the hypercube of size one. If we can check the
positivity of graph zeta functions theoretically or algorithmically, the result can be used for a better
guarantee of the uniqueness.

References
[1] J. Pearl. Probabilistic Reasoning in Intelligent Systems: Networks of Plausible Inference.
Morgan Kaufmann Publishers, San Mateo, CA, 1988.

8

[2] P.F. Felzenszwalb and D.P. Huttenlocher. Efﬁcient belief propagation for early vision. Inter-
national journal of computer vision, 70(1):41–54, 2006.
[3] D. Baron, S. Sarvotham, and R.G. Baraniuk. Bayesian compressive sensing via belief propa-
gation. Signal Processing, IEEE Transactions on, 58(1):269–280, 2010.
[4] R.J. McEliece, D.J.C. MacKay, and J.F. Cheng. Turbo decoding as an instance of Pearl’s
”belief propagation” algorithm. IEEE J. Sel. Areas Commun., 16(2):140–52, 1998.
[5] S. Ikeda, T. Tanaka, and S. Amari. Stochastic reasoning, free energy, and information geome-
try. Neural Computation, 16(9):1779–1810, 2004.
[6] M.J. Wainwright and M.I. Jordan. Graphical models, exponential families, and variational
inference. Foundations and Trends in Machine Learning, 1(1-2):1–305, 2008.
[7] J.S. Yedidia, W.T. Freeman, and Y. Weiss. Generalized belief propagation. Adv. in Neural
Information Processing Systems, 13:689–95, 2001.
[8] A.L. Yuille. CCCP algorithms to minimize the bethe and kikuchi free energies: Convergent
alternatives to belief propagation. Neural computation, 14(7):1691–1722, 2002.
[9] A.L. Yuille and A. Rangarajan. The concave-convex procedure. Neural Computation,
15(4):915–936, 2003.
[10] Y.W. Teh, M. Welling, et al. The uniﬁed propagation and scaling algorithm. Advances in
neural information processing systems, 2:953–960, 2002.
[11] T. Heskes. Convexity arguments for efﬁcient minimization of the bethe and kikuchi free ener-
gies. Journal of Artiﬁcial Intelligence Research, 26(1):153–190, 2006.
[12] T. Heskes. On the uniqueness of loopy belief propagation ﬁxed points. Neural Computation,
16(11):2379–2413, 2004.
[13] J. M. Mooij and H. J. Kappen. Sufﬁcient Conditions for Convergence of the Sum-Product
Algorithm. IEEE Transactions on Information Theory, 53(12):4422–4437, 2007.
[14] A.T. Ihler, JW Fisher, and A.S. Willsky. Loopy belief propagation: Convergence and effects
of message errors. Journal of Machine Learning Research, 6(1):905–936, 2006.
[15] S. Tatikonda and M.I. Jordan. Loopy belief propagation and Gibbs measures. Uncertainty in
AI, 18:493–500, 2002.
[16] Y. Watanabe and K. Fukumizu. Graph zeta function in the bethe free energy and loopy belief
propagation. Adv. in Neural Information Processing Systems, 22:2017–2025, 2009.
[17] M. Kotani and T. Sunada. Zeta functions of ﬁnite graphs. J. Math. Sci. Univ. Tokyo, 7(1):7–25,
2000.
[18] K. Hashimoto. Zeta functions of ﬁnite graphs and representations of p-adic groups. Automor-
phic forms and geometry of arithmetic varieties, 15:211–280, 1989.
[19] H.M. Stark and A.A. Terras. Zeta functions of ﬁnite graphs and coverings. Advances in
Mathematics, 121(1):124–165, 1996.
[20] Y. Watanabe and K. Fukumizu. Loopy belief propagation, Bethe free energy and graph zeta
function. arXiv:1103.0605.
[21] D.M. Malioutov, J.K. Johnson, and A.S. Willsky. Walk-sums and belief propagation in Gaus-
sian graphical models. The Journal of Machine Learning Research, 7:2064, 2006.
[22] Y. Weiss. Correctness of Local Probability Propagation in Graphical Models with Loops.
Neural Computation, 12(1):1–41, 2000.
[23] Thomas Zaslavsky. Characterizations of signed graphs. Journal of Graph Theory, 5(4):401–
406, 1981.

9

