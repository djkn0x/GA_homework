Object detection with grammar models
Ross Girshick
Pedro Felzenszwalb
David McAllester
University of Chicago
TTI Chicago
Brown University

helmet,
occluded left side

ski cap, no face
truncated

pirate hat, dresses,
long hair

truncation, holding glass,
heavy occlusion

Objects from rich categories have 
diverse structural variation

 

Object detection with grammar models
A Discriminatively Trained, Multiscale, Deformable Part Model
Ross Girshick
Pedro Felzenszwalb
David McAllester
Deva Ramanan
David McAllester
UC Irvine
Toyota Technological Institute at Chicago
University of Chicago
TTI Chicago
Brown University
dramanan@ics.uci.edu
mcallester@tti-c.org

Pedro Felzenszwalb
University of Chicago
pff@cs.uchicago.edu

Abstract

More mixture components?

This paper describes a discriminatively trained, multi-
scale, deformable part model for object detection. Our sys-
Dalal & Triggs 
tem achieves a two-fold improvement in average precision
over the best performance in the 2006 PASCAL person de-
CVPR 2005
tection challenge. It also outperforms the best results in the
AP 0.12
2007 challenge in ten out of twenty categories. The system
relies heavily on deformable parts. While deformable part
Figure 1. Example detection obtained with the person model. The
Felzenszwalb, McAllester & Ramanan
models have become quite popular, their value had not been
model is deﬁned by a coarse template, several higher resolution
demonstrated on difﬁcult benchmarks such as the PASCAL
CVPR 2008
part templates and a spatial model for the location of each part.
challenge. Our system also relies heavily on new methods
(g)
(f)
(e)
(d)
(c)
(b)
(a)
for discriminative training. We combine a margin-sensitive
AP 0.27
approach for data mining hard negative examples with a
object categories. Figure 1 shows an example detection ob-
Figure 6. Our HOG detectors cue mainly on silhouette contours (especially the head, shoulders and feet). The most active blocks are
formalism we call latent SVM. A latent SVM, like a hid-
tained with our person model.
centred on the image background just outside the contour. (a) The average gradient image over the training examples. (b) Each “pixel”
den CRF, leads to a non-convex training problem. How-
shows the maximum positive SVM weight in the block centred on the pixel. (c) Likewise for the negative SVM weights. (d) A test image.
The notion that objects can be modeled by parts in a de-
ever, a latent SVM is semi-convex and the training prob-
(e) It’s computed R-HOG descriptor. (f,g) The R-HOG descriptor weighted by respectively the positive and the negative SVM weights.
formable conﬁguration provides an elegant framework for
lem becomes convex once latent information is speciﬁed for
representing object categories [1–3, 6, 10, 12, 13, 15, 16, 22].
the positive examples. We believe that our training meth-
While these models are appealing from a conceptual point
[10] T. Joachims. Making large-scale svm learning practical. In
ods will eventually make possible the effective use of more
B. Schlkopf, C. Burges, and A. Smola, editors, Advances in
of view, it has been difﬁcult to establish their value in prac-
latent information such as hierarchical (grammar) models
Kernel Methods - Support Vector Learning. The MIT Press,
tice. On difﬁcult datasets, deformable models are often out-
and models involving latent three dimensional pose.
Cambridge, MA, USA, 1999.
performed by “conceptually weaker” models such as rigid
templates [5] or bag-of-features [23]. One of our main goals
[11] Y. Ke and R. Sukthankar. Pca-sift: A more distinctive rep-
1. Introduction
is to address this performance gap.
resentation for local image descriptors. CVPR, Washington,
Our models include both a coarse global template cov-
DC, USA, pages 66–75, 2004.
We consider the problem of detecting and localizing ob-
ering an entire object and higher resolution part templates.
jects of a generic category, such as people or cars, in static
[12] D. G. Lowe. Distinctive image features from scale-invariant
The templates represent histogram of gradient features [5].
keypoints. IJCV, 60(2):91–110, 2004.
images. We have developed a new multiscale deformable
As in [14, 19, 21], we train models discriminatively. How-
part model for solving this problem. The models are trained
[13] R. K. McConnell. Method of and apparatus for pattern recog-
ever, our system is semi-supervised, trained with a max-
using a discriminative procedure that only requires bound-
nition, January 1986. U.S. Patent No. 4,567,610.
margin framework, and does not rely on feature detection.
ing box labels for the positive examples. Using these mod-
[14] K. Mikolajczyk and C. Schmid. A performance evaluation of
We also describe a simple and effective strategy for learn-
els we implemented a detection system that is both highly
Felzenszwalb, Girshick, 
local descriptors. PAMI, 2004. Accepted.
ing parts from weakly-labeled data. In contrast to computa-
efﬁcient and accurate, processing an image in about 2 sec-
tionally demanding approaches such as [4], we can learn a
[15] K. Mikolajczyk and C. Schmid. Scale and afﬁne invariant
onds and achieving recognition rates that are signiﬁcantly
McAllester & Ramanan
model in 3 hours on a single CPU.
interest point detectors. IJCV, 60(1):63–86, 2004.
better than previous systems.
Felzenszwalb, Girshick & McAllester
PAMI 2010
Another contribution of our work is a new methodology
[16] K. Mikolajczyk, C. Schmid, and A. Zisserman. Human detec-
Our system achieves a two-fold improvement in average
voc-release4
for discriminative training. We generalize SVMs for han-
tion based on a probabilistic assembly of robust part detectors.
precision over the winning system [5] in the 2006 PASCAL
AP 0.36
dling latent variables such as part positions, and introduce a
The 8th ECCV, Prague, Czech Republic, volume I, pages 69–
person detection challenge. The system also outperforms
AP 0.42
new method for data mining “hard negative” examples dur-
81, 2004.
the best results in the 2007 challenge in ten out of twenty
ing training. We believe that handling partially labeled data
[17] A. Mohan, C. Papageorgiou, and T. Poggio. Example-based
is a signiﬁcant issue in machine learning for computer vi-
This material is based upon work supported by the National Science
object detection in images by components. PAMI, 23(4):349–
sion. For example, the PASCAL dataset only speciﬁes a
Foundation under Grant No. 0534820 and 0535174.
... compositional models deﬁned by grammars  
361, April 2001.
[18] C. Papageorgiou and T. Poggio. A trainable system for object
1
detection. IJCV, 38(1):15–33, 2000.
[19] R. Ronfard, C. Schmid, and B. Triggs. Learning to parse pic-
tures of people. The 7th ECCV, Copenhagen, Denmark, vol-
ume IV, pages 700–714, 2002.
[20] Henry Schneiderman and Takeo Kanade. Object detection
using the statistics of parts. IJCV, 56(3):151–177, 2004.
[21] Eric L. Schwartz. Spatial mapping in the primate sensory pro-
jection: analytic structure and relevance to perception. Bio-
logical Cybernetics, 25(4):181–194, 1977.
[22] P. Viola, M. J. Jones, and D. Snow. Detecting pedestrians
using patterns of motion and appearance. The 9th ICCV, Nice,
France, volume 1, pages 734–741, 2003.

would help to improve the detection results in more general
situations.
Acknowledgments. This work was supported by the Euro-
pean Union research projects ACEM ED IA and PA SCAL . We
thanks Cordelia Schmid for many useful comments. SVM-
Light [10] provided reliable training of large-scale SVM’s.
References
[1] S. Belongie, J. Malik, and J. Puzicha. Matching shapes. The
8th ICCV, Vancouver, Canada, pages 454–461, 2001.
[2] V. de Poortere,
J. Cant, B. Van den Bosch,
J. de
Prins, F. Fransens, and L. Van Gool.
Efﬁcient pedes-
trian detection: a test case for svm based categorization.
Workshop on Cognitive Vision, 2002. Available online:
http://www.vision.ethz.ch/cogvis02/.
[3] P. Felzenszwalb and D. Huttenlocher. Efﬁcient matching of
pictorial structures. CVPR, Hilton Head Island, South Car-
olina, USA, pages 66–75, 2000.
[4] W. T. Freeman and M. Roth. Orientation histograms for
hand gesture recognition. Intl. Workshop on Automatic Face-
and Gesture- Recognition, IEEE Computer Society, Zurich,
Switzerland, pages 296–301, June 1995.
[5] W. T. Freeman, K. Tanaka, J. Ohta, and K. Kyuma. Com-
puter vision for computer games. 2nd International Confer-
ence on Automatic Face and Gesture Recognition, Killington,
VT, USA, pages 100–105, October 1996.
[6] D. M. Gavrila. The visual analysis of human movement: A
survey. CVIU, 73(1):82–98, 1999.
[7] D. M. Gavrila, J. Giebel, and S. Munder. Vision-based pedes-
trian detection: the protector+ system. Proc. of the IEEE In-
telligent Vehicles Symposium, Parma, Italy, 2004.
[8] D. M. Gavrila and V. Philomin. Real-time object detection for
smart vehicles. CVPR, Fort Collins, Colorado, USA, pages
87–93, 1999.
[9] S. Ioffe and D. A. Forsyth. Probabilistic methods for ﬁnding
people. IJCV, 43(1):45–68, 2001.

There are too many combinations!
Instead...

Object detection with grammar models
Ross Girshick
Pedro Felzenszwalb
David McAllester
University of Chicago
TTI Chicago
Brown University

Localizing people with an object detection grammar
Subtype 1 Subtype 2
Example detections and derived ﬁlters

Part 1

Part 2
Part 3
Part 4
Part 5
Part 6

Occluder

Parts 1-6 (no occlusion)

Parts 1-4 & occluder

Parts 1-2 & occluder

AP 0.47
✸ Fine-grained occlusion   ✸ Part sharing 
✸ Non-trivial model of the stuff that causes occlusion  
✸ Part subtypes   ✸ Subparts at multiple resolutions

Object detection with grammar models
Ross Girshick
Pedro Felzenszwalb
David McAllester
University of Chicago
TTI Chicago
Brown University
Discriminative training when the label space != output space
per son

person

face

trunk

arms

lower-par t

mouth

eyes

nose

shoe

legs

shoe

output

pants

label

Weak-label structural SVM
Generalizes latent structural SVM  

Top performance on PASCAL VOC 2010 ‘person’

