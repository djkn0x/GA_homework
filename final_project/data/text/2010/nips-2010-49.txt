 

 

 
 
 

M i x t u r e   o f   t im e -w a r p e d   t r a j e c t o r y  m o d e l s   f o r  
m o v em e n t   d e c o d i n g  

Ela ine  A.  Corbett ,  Eric J .  Perreault  and Konrad P.  Körding  
 
Northwestern University  
 
 
Ch icago ,  IL 60611  
 
 
ecorbett@u.northwestern.edu 
 

Abstract  

App lica tions  of  Brain -Machine -Interfaces   typ ically  es tima te  user   intent 
based   on  b io logical  signa ls  that  are  under   vo luntary  contro l.   For   examp le,  
we  might  want  to   estimate   how  a  patient   with  a  para lyzed   arm  wants  to  
move   based   on  residua l  musc le  act iv ity.   To   so lve  such  prob lems  it  is  
necessary  to   integrate  ob tained   informat ion over   time.  To   do   so ,   state of  the 
art  approaches  typ ical ly  use  a  probab ilistic  model  of  how  the  s tate,   e.g.  
position  and   veloci ty  of  the   arm,   evo lves  over   time   –   a  so-cal led   trajectory 
model.   We   wan ted   to   further   develop   t his  approach  using  two   intuitive  
insights:  (1)   At  any  given  po int  o f  time  there  may  be  a  sma ll  se t  of  l ikely 
movement   targets,   po tential ly  identi fied   by  the   location  o f  ob jects  in  the  
workspace   or   by  gaze   information  from  the  user.   (2)   The  user   may  want   to  
produce  movemen ts at varying speeds.  We  thus use a generative model wi th  
a   trajectory  model  incorporating  these  insights.   Approx imate  inference  on 
that  generative   model  is  imp lemented   us ing  a  mixture  of  extended   Kalman  
fil ters.   We   find   tha t  the  resu lting  algorithm  allows   us  to   decode  arm 
movements  dramatical ly  bet ter   than  when  we  use  a  trajectory  model  with  
linear  dynamics.  

 

1  

I n t r o d u c t i o n  

When pat ien ts have  lost a   limb  or  the ab il ity to  commun icate with the outs ide world ,  brain 
machine  inter faces (BMIs)  a re  often used  to  enab le robo t ic prostheses or  restore 
communication.  To  achieve  this,  the user 's intended   sta te  of the device mus t be decoded  
from b io logical signals.  In the  con tex t of Bayesian statis tics,  two  aspects are important  for  
the des ign o f an est ima tor  of  a temporally evo lv ing s tate:  the  observa tion  model ,  which 
describes how measured  variab les relate to  the sys tem’s  s tate and  the  tra jectory model  which 
describes how  the state  changes over  time in a probab ilis tic manner.  Fo llowing th is logic 
many recent BMI  app licat ions have relied  on Bayes ian estimation  for  a wide range o f 
prob lems includ ing the  decod ing o f intended  human  [1]   and  an imal  [2] movements.  In the 
context of BMI s,  Bayes ian approaches o ffer  a princip led  way o f formaliz ing the unce rtainty 
about signals and  thus o ften  resul t in improvements over  o ther  signal processing techniques 
[1]-[3]. 

Most work on sta te  est imation in dynamical systems  has  assumed  linear  dynamics and  
Gaussian no ise.  Under  these circums tances,  e fficient algo rithms result  from bel ief 
propagation.  The most  frequent app licat ion uses the Kalman filter  (KF) ,  wh ich recur sively 
comb ines no isy s tate observations with the probab ilist ic evo lution of s tate de fined  by the 
trajectory model to  est imate   the  marginal d istribution over  states  [4].  Such approaches have 
been used  widely  for  app lications   inc lud ing upper   [1] and  lower   [5]   extremity prosthe tic 

 

1 

devices,   functional elec tric s timula t ion [6] and  human compu ter  in teractions  [7].  As  these 
algorithms are  so  common ly used ,  it seems promising to  develop  extensions to  nonl inear  
trajectory models that may better  describe the probab ilist ic d istribution of movements  in 
everyday li fe .  

One salient departure from  the standard  assump t ions is  that peop le tend  to  produce bo th slow 
and  fast movemen ts,  depend ing on the situation.  Models wi th  linear  dynamics only al low 
such deviation through the  no ise term,  wh ich makes these models poor  at describ ing  the 
natural variation of movement speed s during real world  tasks.  Exp l icitly incorporating 
movement speed  in to  the  tra jectory model shou ld  lead  to  better  movemen t estima tes.  

Knowledge of  the  target pos ition should  also  strongly a ffect trajectory models.  After  all ,  we 
tend  to  accelerate  our  arm ea rly during movement and  slow down  later  on.  Target 
informa tion can be linearly incorpo rated  into  the trajectory model,  and  this has great ly 
improved  pred ictions  [8]-[12].  Al terna tively,  i f there are a sma ll number  of po tential targets 
then a mixture  of trajectory models approach  [13] can be  used .  Here we are interested  in the 
case  where  ava ilab le data provide  a prior  over  po tentia l t argets bu t where movement targets 
may be anywhere.  We wan t to  incorporate targe t uncerta inty and  al low general ization  to  
nove l targets.  

Prior  informa tion about po tentia l targets could  come  from a number  of sources bu t would  
generally be  no isy.  For  examp le ,  activ ity  in  the dorsal premo tor  cortex provides information 
about in tended  target location prior  to  movement and  may be used  where such record ings are 
availab le  [14].  Target information may also  be  found  non invas ive ly by tracking eye 
movements.  However,  such data will generally provide non -zero  priors  for  a number  of 
possib le target  locations as the sub ject saccades over  the scene.  Wh ile  sub jects almos t  
always look a t a target be fore reaching for  it  [15],  there may be a delay o f up  to  a second  
between looking a t the  targe t and  the reach –  a t ime  in terval over  wh ich up  to  3  saccades are 
typ ical ly made .  Each of these  fixations could  be the target.  Hence,  a probab ilis tic 
d istribu tion o f targets is appropriate when using either  neural record ings or  eye track ing to  
estimate  po tentia l reach  targets  

Here   we   present  an  algorithm  tha t  uses  a  mixture  of  extended   Kalman  Filter s  (EKFs)   to  
comb ine   our   insigh ts  related   to   the  variat ion  o f  movement  speed   and   the  avai lab ility  of  
probab ilistic   target  knowledge .   Each  of  the  mixture  component s  allows  the  speed   of  the 
movement   to   vary  continuous ly  over   time.  We  tested   how  we ll  we  could   use  EMGs  and   eye  
movements  to   decode   hand   position  o f  humans  per forming  a  three -d imensional  large  
workspace   reach ing  task.  We   find   that  us ing   a  trajectory  model  tha t  al lows  for   probab ilistic  
targe t  information  and   variation  o f  speed   leads  to   dramat ic  improvements  in  decod ing  
quality.  

 
2  

G e n e r a l   D e c o d i n g   S e t t i n g  

We  wanted   to   tes t  how  we l l  d i fferent  decod ing   algorithms   can   decode  human  movement,  
over   a   wide   range   of   dynam ics.  Whi le  many  recent  stud ies  have  looked   at  more  rest rictive,  
two -d imens ional  movements ,   a  system  to   restore  arm  function  should   produce  a  wide  range  
of  3D  trajectories.   We   recorded   arm  kinematics  and   EMGs  o f  hea lthy  sub jects  during  
unconstrained   3D  reaches  to   targe ts  over   a  large  workspace.   Two   hea lthy  sub jects  were  
asked   to   reach at  slow,  normal and   fas t speeds,  as  they would   in everyday  li fe.  Sub jects were  
seated   as  they  reached   towards  16   LEDs  in  b locks  of   150 s,   which  were  located   on  two  
p lanes  posi tioned   such  that  all  targets  were  jus t  reachab le  (Fig  1A) .   The  target  LED   was  lit  
for   one  second   prior   to   an  aud itory  go   cue,   at  wh ich  t ime  the  sub ject  would   reach  to   the  
targe t  at  the   appropriate  speed .   Slow,   normal  and   fast  reaches  were  allo tted   3 s,   1 .5 s  and   1s    
respectively;   however,   sub jects  determined   the  speed .   An  approxima te  to tal  of  450   reaches  
were  performed   per   sub ject.   The  sub jects  provided   info rmed   consent,   and   the  pro toco l  was  
approved   by  the   Nor thwestern  Univer sity  Ins titutional   Review  Board .   EMG  signals  were 
mea sured   from  the   pectoral is  major,   and   the  three  del to id   muscles  of  the  shoulder.   This 
represents  a  sma ll  subset  of  the  muscles  invo lved   in   reaching,   and   approximates  those  
muscles  reta in ing  some  vo luntary  contro l  fo llowing  mid -level  cervical  sp inal  cord   inj uries.  

 

2 

The  EMG  signa ls  were  band -pass   filtered   be tween  10   and   1 ,000   Hz,   and   subsequen tly  an ti -
aliased   filtered .   Hand ,   wr ist ,   shoulder   and   head   positions  were  tracked   using  an  Op to trak  
mo tion  analys is  sys tem.   We  simul taneously  recorded   eye  movements  with  an   ASL 
EYETRAC -6  head  mounted  eye tracker.    

Approxima tely  25%  o f  the  reaches  were  assigned   to   the   test   set,   and   the  res t  were  used   for  
training.   Reaches  for   wh ich   either   the  mo tion  cap ture  data  was  incomp lete,   or   there  was  
visib le   mo tion  art ifact  on  the  EMG  were  removed .  As  the  state  we  used   hand   positions  and  
jo int  ang les  (3   shoulder,   2   elbow,   position,   velocity  and   acceleration,   24   d imensions) .   Jo int 
angles  were   calculated   from  the   shoulder   and   wr ist   marker   data  using  d ig itized   bony 
landmarks  wh ich   defined   a   coord inate  sys tem  for   the  upper   limb   as  detai led   by  Wu  et   al.  
[16].  As  the   mo tion  data   we re   samp led   at  60Hz,   the  mean  abso lute  value  o f  the  EMG  in  the 
correspond ing  16 .7ms  windows  was  used   as  an  observation  of  the  s tate  at  each  time -s tep .  
Algorithm  accuracy  was  quanti fied   by  norma lizing  the  roo t -mean-squared   error   by  the  
straigh t  l ine   d istance   between  the   first   and   final  posi tion   of  the   endpo int   for   each   reach.  We  
compared   the  algorithms sta tistically using  repeated  measures ANOVAs with Tukey post -hoc  
tests,  treating reach and  sub ject as random e ffects.  

 In  the  res t  of  the  paper   we   will  ask  how  wel l  these  reaching  movements  can  be  decoded  
from EMG and  eye -tracking data .  

 

 

Figure  1 : A Expe rimen tal se tup  and  B  s amp le kinematics and  processed  EMGs for  one  reach  

 
3  

K a l m a n   F i l t e r s   w i t h   Ta r g e t   i n f o r m a t i o n  

All models that we consider in this paper assume linear observations with Gaussian noise:   

 

                 

 

(1) 

where   x  is  the   sta te ,   y   is  the   observation  and   v   is  the  measurement  no ise  wi th  p(v)   ~   N(0 ,R) , 
and   R   is  the  observa tion  covariance  ma trix.   The   mode l   fitted   the   measured   EMGs  wi th  an 
average  r2 of 0 .55 .  This high lights the  need  to  integrate   informat ion over  time .  

The standard approach also assumes linear dynamics and Gaussian process noise:  
                                        
 
 
 
where ,  x t        represents  the hand  and   jo int angle  positions,  w  is  the process   no ise with  p (w)  
~   N(0 ,Q) ,   and   Q  is  the   state   covariance  matrix.   The  Kalman  filter  does  optimal  inference  for 
this generative model. 

(2) 

This model can e ffectively cap ture  the dynamics o f stereo typ ical reaches to  a s ingle  target  by 
appropriately  tuning  its  parameter s.   However,   when  used   to   describe  reaches  to   mu ltip le  
targe ts,   the  model  canno t  describe   target  depe ndent  aspects  of  reaching  bu t  bo ils  down   to   a  
random  drift  model.   Fast  velocit ies  are  underes timated   as  they  are  unlikely  under   the  
trajectory model and  there is  excessive dri ft close  to  the target (Fig.  2A) .  

 

3 

In many decoding applications we may know the subject’s target. A range of recent studies have 
addressed the issue of incorporating this information into the trajectory model  [8, 13], and we 
might assume the effect of the target on the dynamics to be linear. This naturally suggests adding 
the target to the state space, which works well in practice [9, 12].  By appending the target to the 
state vector (KFT), the simple linear format of the KF may be retained:   
                                             
where  xT t      is the vector of target positions, with dimensionality less than or equal to that of 
xt. This trajectory model thus allows describing both the rapid accelerat ion that characterizes the 
beginning of a reach and the stabilization towards its end.  

 

 

 

(3) 

We compared the accuracy of the KF and the KFT to the Single Target Model (STM), a KF 
trained only on reaches to the target being tested (Fig. 2). The STM represents the  best possible 
prediction that could be obtained with a Kalman filter. Assuming the target is perfectly known, we 
implemented the KFT by correctly initializing the target state xT at the beginning of the reach. We 
will relax this assumption below. The initial hand and joint angle positions were also assumed to 
be known. 

 

 

Figure 2: A Sample reach and predictions and B average accuracies with standard errors  for KFT, 
KF and MTM. 

 
Consistent with the recent literature, both methods that incorporated target information produced 
higher prediction accuracy than the standard KF (both p<0.0001). Interestingly, there was no 
significant difference between the KFT and the STM (p=0.9). It seems that when we have 
knowledge of the target, we do not lose much by training a single model over the whole 
workspace rather than modeling the targets individually. This is encouraging, as we desire a BMI 
system that can generalize to any target within the workspace, not just specifically to those that are 
available in the training data.  

Clearly, adding the target to the state space allows the dynamics of  typical movements to be 
modeled effectively, resulting in dramatic increases in decoding performance.  
 
4  

T i m e  Wa r p i n g    

4 . 1  

I m p l e m e n t i n g   a   t i m e - w a r p e d   t r a j e c t o r y   m o d e l  

While   the  KFT  above  can  cap ture   the  general  reach  trajectory  profile,   it  does  no t  al low  for  
natural  variab i lity  in   the  speed   of  movements.   Depend ing   on   our   task  ob jectives,   wh ich 
would   no t  d irec tly  be  observed   by  a  BMI ,   we  might  laz ily  reach  toward   a  target  or   move  a t 
maximal  speed .   We  aim  to   change  the  trajectory  model   to   exp licitly  incorporate  a   warp ing 
factor   by  wh ich  the   average   movement  speed   is   scaled ,   allowing   for   such   variab ility.  As   the  
movement  speed  will be  pos itive  in al l practical cases ,  we model  the  logarithm o f  th is  fac tor, 

 

4 

 

and  append  it to  the  s tate  vector:  
                                                                          
We  create   a   time -warped   tra jectory model by  no ting  that   if   the  average  rate  of  a  trajectory   is  
to   be  scaled   by  a   factor   S ,   the   position  at  time  t  wil l  equal  that  of  the  orig ina l  trajectory  at 
time  S t.   Di fferentia ting,   the   velocity  wi ll  be  mu ltip l ied   by  S ,   and   the  acce leration  by  S2.   For  
simp licity,   the   trajectory  no ise  is  assumed   to   be  add itive  and   Gaussian,   and   the  model  is 
assumed  to  be stationary:  

(4) 

 

 

     

 

 
  

 

 
 
 
 

  
    
 
    
  
   
     

                                                                        
                                                                   
                                              
                
    
                                                                     
                                                                   
 
 
 
where   Ip  is  the  p-d imens ional  ident ity  matrix  and          is  a  p p  matrix  of  zeros.   Only  the      
terms   used   to   pred ict  the   acceleration  s tates  need   to   be  estimated   to   build   the  s tate  t ransi tion  
matrix,  and  they are scaled  as a  nonlinear   funct ion o f  xs.    

    
      
 
      
  
     
       

      

 
 
 
 

 
  

 

 

 

(5) 

After   add ing  the  variab le   movemen t  speed   to   the  s tate  space  the  sys tem  is  no   longe r   linear.  
Therefore   we   need   a   d i fferent  so lution  s trategy.   Ins tead   of  the  typ ical  KFT  we  use   the 
Extended   Kalman  F ilter   (EKFT )   to   imp lement  a  nonlinear   trajectory  model  by  linearizing  
the dynamics around  the bes t  estima te at each t ime -step  [17].  With this approach we  add  only 
sma ll computa tional overhead  to  the KF T recur sions.  
 
4 . 2  

Tr a i n i n g   t h e   t i m e   w a r p i n g   m o d e l  

The  filter   parameters  were   trained   using  a  variant  of  the  Expecta tion  Maximization  (EM)  
algorithm  [18].   For   extended   Kalman   filter   learning   the   in itial ization  for   the  variab les  may  
matter.  S  was initialized with the ground truth average reach speeds for each movement relative to 
the  average  speed  across  all movements.  The  state  transition  parameters      were  estimated   us ing  
nonl inear   least  squares  regression,   wh ile  C,   Q  and   R   were  es timated   linearly  for   the  new 
system,   us ing  the   maximum  l ike lihood   so lution  [18]  (M-s tep) .   For   the  E -s tep   we  used   a  
standard   extended   Kalman  smoo the r.  We  thus  found   the  expected   va lues  for   t he  sta tes  given 
the  current  fil ter   parameter s .   For   this  computa tion,   and   later   when  testing  the  algori thm,   xs  
was  init ialized   to   its   average   value   across  all   reaches   wh ile  the   rema in ing  states  were  
init ialized   to   their   true  values.  The  smoo thed  estima te  fo r  xs was then used, along with the true 
values  for  the  other  states,  to  re-estimate  the  filter  parameters  in  the  M-step  as  before.  We 
alternated between the E and M steps until the log likelihood converged (which it did in all cases).  
Following  the  training  procedure,  the  diagonal  of  the  state  covariance  matrix  Q  corresponding  to 
xs  was  set  to  the  variance  of  the  smoothed  xs  over  all  reaches,  according  to  how  much  this  state 
should be allowed to change during prediction. This allowed the estimate of  xs to develop over the 
course  of  the  reach  due  to  the  evidence  provided  by  the  observations,  better  capturing  the 
dynamics of reaches at different speeds.  
 
4 . 3  

P e r f o r m a n c e   o f   t h e   t i m e - w a r p e d   E K F T  

Incorporating  time  warp ing  exp lic itly  into   the  trajectory  model  pro duced   a  no ticeab le  
increase  in  decod ing  performance  over   the  KFT.   As  the  speed   state  xs  is  estimated  
throughou t  the  cour se   of  the   reach,   based   on  the  evidence  provided   by  the  observations,   the 
trajectory model has  the   flex ib ility  to   fo l low  the dynamics of  the  reach more accura te ly  (Fig.  
3) .   While  at  the   normal  se lf -se lected   speed   the  d i fference  between  the  algorithms  is  small,  
for   the  slow  and   fas t  speeds,   where  the  dynamics  deviate  from  average,   there  i s  a  clear  
advan tage to  the   time  warp ing model.  

 

 

5 

 

Figure 3 : Hand  positions  and  pred ictions of  the KFT and  EKFT  for  samp le reaches  at  A s low,  
B  normal and  C  fast  speeds.  No te the d i fferent  time sca les between reaches.  

 
The  models  were  first  trained   using  data  from  a ll  speeds  (Fig.   4A) .   The  EKFT  was  1 .8% 
more  accurate  on average  (p<0 .01) ,  and   the  e ffect was  signi ficant a t  the  slow  (1 .9%,  p<0 .05) 
and   the  fast  (2 .8%,   p<0 .01) ,  but  no t  at  the  normal  (p=0 .3)   speed .  We  also   trained   the models 
from  data  using  only  reaches  at  the  se lf -selected   normal   speed ,   as  we   wan ted   to   see  if  there  
was  enough  varia tion   to   e ffective ly  train  the   EKFT  (F ig.   4B) .   Interest ingly,   the  per fo rmance  
of  the   EKFT  was  reduced   by  on ly  0 .6%,   and   the  KFT  by  1 .1%.   The  d i fference  in 
performance   between  the   EKFT  and   KFT  was  even  more  pronounced   on   aver age   (2 .3%,  
p<0 .001) ,  and   for   the  slow  and   fast  speeds  (3 .6   and   4 .1%,   bo th  p<  0 .0001) .   At  the  normal  
speed ,   the   algori thms  again  were   no t  stat ist ically  d i fferent  (p=0 .6) .   This  result  demons trates  
that  the  EKFT  is  a  practical   op tion  for   a  real  BMI   system,   as   it  is  no t  necessary  to   greatly 
vary  the  speeds wh ile co llec ting  training data  for   the model  to  be effective  over  a wide  range  
of in tended  speeds.  

Exp lici tly  incorporating  speed   information  into   the  trajectory  model  he lps  decod ing,   by 
modeling  the natural  variat ion in vo li tiona l speed .    

 

 
5  

Figure 4 : Mean and  standard  error  of  EKFT and  KFT accuracy a t the d i fferent sub ject -
selected  speed s.  Models were trained  on reaches at A all speeds and  B  just normal speed  
reaches.  As terisks ind icate s tatist ically s igni fi can t d i fferences between the  algorithms .  

 

M i x t u r e s   o f   Ta r g e t s  

So   far,   we   have  assumed   tha t  the   target s  of  our   reaches  a re   perfectly  known.   In  a  real -world  
system,   there   wi ll  be   uncertainty  about  the  intended   target  of  the  reach .   However,   in  typ ica l 
app lications  there   are   a  sma ll  number   of  possib le  ob jectives.   Here  we  address  this  s itua tion .  
Drawing  on  the   recent  literature ,   we  use  a  mix ture  model  to   consider   each  of  the  possib le 
targe ts  [11,  13].  We  cond ition   the posterior  probab ility  for   the st a te on  the  N possib le  targets,  
T:  

 

 

  
                                        
    

           

 

(6) 

6 

Using Bayes ' Rule,  this equa tion becomes:  

 

  
                                       
    

                   
       

 

(7) 

As  we   are   dealing  wi th  a   mixture  model ,   we  perfo rm  the  Kalman  fil ter   recursion   for   each 
possib le  ta rge t,   xT ,   and   our   so lut ion  is  a  we ighted   sum  o f  the  outputs.   The  weights  are  
proportional  to   the   prior  for   tha t  target ,          ,   and   the  likelihood   of  the  model  given  that 
targe t               .           is independent o f the targe t and  does no t need  to  be calculated .  

We  tested   mix tures  of  bo th   algorithms,   the  mKFT  and   mEKFT,   wi th  real  uncert ain  priors 
ob tained   from  eye -tracking   in  the  one -second   period   preced ing  movement.   As  the  targets  
were  situated   on  two   p lanes ,   the   three -d imens ional   loca tion  o f  the  eye  gaze  was  found   by 
pro jecting  its  d irection  onto   those  p lanes.   T he  first,   midd le  and   las t  eye  samp les  were  
selected ,   and   all o ther   samp les were  assigned   to   a group   accord ing  to  wh ich o f  the  three was  
closest.   The   mean  and   variance   o f  these   three  groups  were  used   to   in itial ize  three  Kalman  
fil ters  in  the mixture model.  The priors of  the  three  groups were  assigned  proportional  to   the 
number   o f  samp les   in  them.   If  the   sub ject  looks  at   mu lt ip le  position s   prior   to   reach ing,   this 
method  ensures with a  high probab ility that  the  correct target  was accounted  for  in one o f the  
fil ters in the  mixture.    

We  also   compared   the  MTM   approach  of  Yu  et  al.   [13],   where  a  d i fferen t  KF  model  was  
generated   for   each  target,   and   a  mixture  is  performed   over   these  models.   This  approach 
exp lici tly  cap tures  the  dynamics  of  stereo typ ical  reaches  to   s peci fic  ta rge ts.   Given  perfect  
targe t  information,   it  would   reduce  to   the  STM   described   above .   Priors  for   the  MTM   were  
found   by  ass igning  each  valid   eye  samp le  to   its  closest  two   targe ts,   and   weigh ting  the  
models  proportional  to   the  number   o f  samp les  assig ned   to   the  correspond ing  target,   d ivided  
by  its  d istance   from  the   mean  of  those  samp les.  We  tried   o ther   ways  of  assigning  priors  and  
the one presen ted  gave the  best results.  

We   calcula ted   the  reduction   in  decod ing  qual ity  when   ins tead   of  perfect  priors  we  provide  
eye -movement  based   no isy  priors   (Fig.   5) .  The  accuracies   of  the mEKFT,   the mKFT  and   the  
MTM   were   only  degraded   by  0 .8 ,   1 .9   and   2 .1%  respectively,   compared   to   the  perfec t  prior  
situation .   The  mEKFT  was   still   close  to   10%  bet ter   than  the  KF.   The  mixture  model  
framework is e ffec tive  in accoun ting   for  uncerta in priors .    

 

 

Figure 5 : Mean and  standard  errors  of accuracy   for  algori thms with perfec t priors,  and  
uncertain priors with  full and  partial training se t.  The as terisk   ind ica tes a   stat ist ically  
signi fican t e ffects between the two  training ty pes,  where  real priors are used .  

 

Here ,   only  reaches   at  norma l  speed   were  used   to   train  the  models,   as  th is  is  a   more  realist ic  
training  se t  for   a   BMI   app lication.  This  accounts  for   the   degraded   performance  of  the  MTM 
wi th  per fect  priors  relative  to   the  STM   from  above  (Fig.   2) .   With  even  more   stereo typed  
training data   for  each ta rget,  the  MTM  doesn 't generalize  as well to  new  speeds.  

 

7 

We  also   wanted   to   know  if  the  algorithms  cou ld   generalize  to   new  targets.   In   a  real 
app lication,   the  ava ilab le  tra ining  data  will  generally  no t   span  the  ent ire  useab le  worksp ace.  
We   compared   the  algorithms   where  reaches  to   al l  targe ts  excep t  the  one  being  tested   had  
been  used   to   train  the  models.   The  performance  o f  the   MTM   was    signi ficantly  de graded  
unsurprisingly,   as  it  was   des igned   for   reaches  to   a  set  o f   known   ta rge ts.   Per formance  of  the  
mKFT  and  mEKFT degraded  by  about  1%,  but  no t  signi ficantly  (bo th p>0 .7) ,  demons trating  
that  the  cont inuous  approach  to   ta rge t  informa tion  is  p referab le  when   the  ta rget  could   be 
anywhere in space ,  no t just a t locations  for  which training data is ava ilab le.  

 
6  

D i s c u s s i o n   a n d   c o n c l u s i o n s  

The goal of this work was to  design a trajectory model that would  improve decod ing  for  
BMIs with an app lica tion  to  reaching.  We incorporated  two   features tha t prominently  
influence the  dynamics of na tural reach: the movement speed  and  the ta rget location.  Our  
approach is appropriate  whe re  uncer tain target information is availab le.  The model 
generalizes well  to  new regions o f the  workspace for  wh ich there is no  training data,  and  
across a  broad  range  o f reaching dynamics  to  widely spaced  targe ts in three d imensions.    

The advantages over  l inear  models in decod ing precision we report here could  be equally 
ob tained  using mix tures ove r  many ta rgets and  speeds.  While mixture  models  [11,  13] could  
allow  for  s low ver sus  fas t movemen ts and  any number  o f  po tential targets,  this s trategy will 
generally require  many mixture componen ts.  Such an approach would  requ ire a lo t more 
training data ,  as we  have  shown  that i t does no t generalize we ll .  I t wou ld  also  be run -t ime 
intensive wh ich is prob lemat ic for  prosthe tic devices  tha t  rely on low power  contro lle rs.  In 
contrast,   the  a lgorithm  introduced  here  on ly  takes a sma l l amoun t of add ition al run - time in 
comparison to  the standard  KF approach.  The EKF  is on ly marginal ly slower  than the 
standard  KF and  the  algorithm wi ll no t generally need  to  consider  more than 3  mixture 
components assuming the sub ject fixates the ta rge t within the second  pre ced ing the reach.  

In th is paper  we assumed  tha t sub jects a lways would   fixa te a reach ta rge t  –  along with o ther  
non-ta rgets.  Whi le  this  is clo se to  the way humans usual ly coord inate eyes and  reaches  [15],  
there might be  cases where peop le do  no t fixate a reach target.  Our  approach could  be easily 
extended  to  deal with such s itua tions by add ing a dummy mixture component  tha t all ows the 
descrip tion o f  movements to  any  target.  

As an alternative  to  mixture approaches ,  a sys tem can exp licitly es timate the ta rge t position  
in the  s tate  vector   [9].  This approach,  however,  would  no t straight forward ly al low for  the 
rich targe t information  availab le; we look at the ta rget but als o  at o ther  loca tions ,  strongly 
sugges ting mixture d is tribu tions .  A comb ina tion o f  the two  approaches  could   further  
improve  decod ing quali ty.  We could  bo th es timate speed  and  target posi tion   for  the EKFT  in 
a continuous manner  wh ile retain ing the mixture  over  ta rget priors .    

We  believe   that  the  issues  that  we  have  addressed   here   are  almost  universal.   Virtually  al l 
types   of   movements  are   executed   a t  varying  speed .   A  p robab ilistic  d istribution  for   a  small  
number  o f  ac tion   cand ida tes  may  a lso  be  expected   in mo st BMI   app licat ions  –   a fter   a ll  there  
are   usually  only  a   small  number   of  actions  tha t   make  sense  in  a  given  environmen t.   While 
this  work  is   presented   in  the  context  o f  decod ing  human  reaching,   it  may  be  app l ied   to   a 
wide   range   o f  BMI   app lications   includ ing   lower   l imb   prosthetic   devices  and   human  
computer   interact ions ,   as  well  as  d i fferen t  signa l  sources  such  as  elec trode  grid   record ings 
and   electroencephalograms .   The  increased   user   contro l  in  conveying  their   intended  
movements would  signi fican tly improve  the  functionali ty of a neuroprosthetic device.    

A c k n o w l e d g e m e n t s  

T h e   a u t h o r s   t h a n k   T .   H a s w e l l ,   E .   K r e p k o v i c h ,   a n d   V.  Rav ichandran  for  assis tance  
wi th experiments .  This work  was  funded  by the NSF Program  in Cyber -Physica l Sys tems.    

R e f e r e n c e s  
[1] 
L.R. Hochberg, M.D. Serruya, G.M. Friehs, J.A. Mukand, M. Saleh, A.H. Caplan, A. Branner, D. 

 

8 

[6] 

[7] 

[8] 

[4] 

Chen, R.D. Penn, and J.P. Donoghue, “Neuronal ensemble control of prosthetic devices by a human 
with tetraplegia,” Nature,  vol. 442, 2006, pp. 164–171. 
[2]  W. Wu, Y. Gao, E. Bienenstock, J.P. Donoghue, and M.J. Black, “Bayesian p opulation decoding of 
motor cortical activity using a Kalman filter,” Neural Computation,  vol. 18, 2006, pp. 80–118. 
[3]  W. Wu, M.J. Black, Y. Gao, E. Bienenstock, M. Serruya, A. Shaikhouni, and J.P. Donoghue, “Neural 
decoding of cursor motion using a Kalman filter,” Advances in Neural Information Processing 
Systems 15: Proceedings of the 2002 Conference, 2003, p. 133. 
R.E. Kalman, “A new approach to linear filtering and prediction problems,” Journal of basic 
Engineering,  vol. 82, 1960, pp. 35–45. 
[5]  G.G. Scandaroli, G.A. Borges, J.Y. Ishihara, M.H. Terra, A.F.D. Rocha, and F.A.D.O. Nascimento, 
“Estimation of foot orientation with respect to ground for an above knee robotic prosthesis,” 
Proceedings of the 2009 IEEE/RSJ international conference on Intelligent robots and systems,  St. 
Louis, MO, USA: IEEE Press, 2009, pp. 1112-1117. 
I. Cikajlo, Z. Matjačić, and T. Bajd, “Efficient FES triggering applying Kalman filter during sensory 
supported treadmill walking,” Journal of Medical Engineering & Technology,  vol. 32, 2008, pp. 133-
144. 
S. Kim, J.D. Simeral, L.R. Hochberg, J.P. Donoghue, and M.J. Black, “Neural control of computer 
cursor velocity by decoding motor cortical spiking activity in humans with tetraplegia,” Journal of 
Neural Engineering,  vol. 5, 2008, pp. 455-476. 
L. Srinivasan, U.T. Eden, A.S. Willsky, and E.N. Brown, “A state-space analysis for reconstruction of 
goal-directed movements using neural signals,” Neural computation,  vol. 18, 2006, pp. 2465–2494. 
[9]  G.H. Mulliken, S. Musallam, and R.A. Andersen, “Decoding trajectories from posterior parietal cortex 
ensembles,” Journal of Neuroscience,  vol. 28, 2008, p. 12913. 
[10]  W. Wu, J.E. Kulkarni, N.G. Hatsopoulos, and L. Paninski, “Neural Decoding of Hand Motion Using a 
Linear State-Space Model With Hidden States,” IEEE Transactions on neural systems and 
rehabilitation engineering,  vol. 17, 2009, p. 1. 
J.E. Kulkarni and L. Paninski, “State-space decoding of goal-directed movements,” IEEE Signal 
Processing Magazine,  vol. 25, 2008, p. 78. 
[12]  C. Kemere and T. Meng, “Optimal estimation of feed -forward-controlled linear systems,” IEEE 
International Conference on Acoustics, Speech, and Signal Processing, 2005. 
Proceedings.(ICASSP'05), 2005. 
[13]  B.M. Yu, C. Kemere, G. Santhanam, A. Afshar, S.I. Ryu, T.H. Meng, M. Sahani, and K.V. Shenoy, 
“Mixture of trajectory models for neural decoding of goal-directed movements,” Journal of 
neurophysiology,  vol. 97, 2007, p. 3763. 
[14]  N. Hatsopoulos, J. Joshi, and J.G. O'Leary, “Decoding continuous and discrete motor behaviors using 
motor and premotor cortical ensembles,” Journal of neurophysiology,  vol. 92, 2004, p. 1165. 
[15]  R.S. Johansson, G. Westling, A. Backstrom, and J.R. Flanagan, “Eye -hand coordination in object 
manipulation,” Journal of Neuroscience,  vol. 21, 2001, p. 6917. 
[16]  G. Wu, F.C. van der Helm, H.E.J. Veeger, M. Makhsous, P. Van Roy, C. Anglin, J. Nagels, A.R. 
Karduna, and K. McQuade, “ISB recommendation on definitions of joint coordinate systems of 
various joints for the reporting of human joint motion–Part II: shoulder, elbow, wrist and hand,” 
Journal of biomechanics,  vol. 38, 2005, pp. 981–992. 
[17]  D. Simon, Optimal state estimation: Kalman, H [infinity] and nonlinear approaches , John Wiley and 
Sons, 2006. 
[18]  Z. Ghahramani and G.E. Hinton, “Parameter estimation for linear dynamical systems,” University of 
Toronto technical report CRG-TR-96-2,  vol. 6, 1996. 

[11] 

 

 

 

9 

