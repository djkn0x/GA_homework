I n d i v i d u a l i z e d   R O I   O p t i m i z a t i o n   v i a  
M a x im i z a t i o n   o f   G r o u p - w i s e   C o n s i s t e n c y   o f  
S t r u c t u r a l   a n d   F u n c t i o n a l   P r o f i l e s  

1 ,  2*Kaim ing Li,  1Le i Guo,  3Car los Faraco,  2Dajiang  Zhu, 2Fan Deng,  1Tuo Zhang,  1Xi 
Jiang, 1Degang  Zhang, 1Hanbo Chen, 1Xintao  Hu, 3Steve  Miller,  2Tianming Liu  
1School of Automa tion, Northwestern Polytechnic al University,China ;2Department of 
Computer  Science ,  the University  of Georgia, USA; 3Department of Psychology,  the  
University  of Georgia, USA;  *Ema il: likaiming@gmail.com  

Abstract  

Functiona l segregation and integration  are  fundamental  character istic s of the  
human  brain.  Studying  the  connectivity   among  segrega ted   regions  and  the  
dynamics of  integrated brain networks has drawn  increasing  interest .  A very  
controvers ial,  yet fundamental  issue  in  these studies   is how  to de termine  the  
best  functiona l  brain  regions  or   ROIs  (regions  of  interests)  for  individuals.  
Essentially,   the  computed   connec tivity   pattern s  and   dynamics  of   brain 
networks  are   very   sensitive   to  the  loca tions,  sizes ,   and  shapes  of  the  ROIs. 
This  paper   presents  a  nove l  me thodology   to  optimize   the  locations   of   an  
individua l 's ROIs  in the working memo ry  system. Our strategy  is to formulate  
the  individual  ROI   optimiza tion  as  a  group  variance   minimization  problem,  
in  which   group-wise  functional  and  st ructural  connectivity   patterns,  and  
anatomic  profiles   are  defined  as  optimization  constra ints .  The  optimization  
problem  is   solved  via  the  s imula ted   annealing  approach.  Our  experimenta l 
results  show  
improved  
the  optimized   ROIs  have  s ignificantly  
tha t 
cons istency   in  struc tura l  and  functional   profiles   across  subjects,   and  have  
more  reasonable  loca liz a tions  and  more  cons istent  morphologica l  and  
anatomic profiles.  

1  

I n t r o d u c t i o n  

The human brain’s function is segregated into distinc t regions and integrated via axonal fibers  
[1].  Studying   the  connec tivity   among   these  regions   and  modeling  their  dynamics  and  
interactions has drawn increasing interest  and effor t from the brain imaging and neuroscience  
communities  [2-6] .  For  example,  recently,   the  Human  Connec tome  Project   [7]   and  the  1000  
Functiona l  Connectomes  Project  [8]   have   embarked   to  e luc ida te  large -scale  connec tivity  
patterns  in  the  human  brain.  For  traditiona l  connec tivity   ana lysis,   a  variety   of  models  
inc luding  DCM   (dynamics  causal  modeling) ,   GCM  (Granger  causa lity   mode ling)   and  MVA 
(multivaria te autoregressive  modeling ) are  proposed [6,  9-10] to model the interaction s  of the 
ROIs. A  fundamenta l  issue  in  these   s tudies  is  how  to accurate ly   identify   the ROIs,  which are  
the s tructural subs trates  for  measuring connec tivity.  Currently,  this  is still an open, urgent , yet  
challenging   problem  in  many   brain   imaging   applications .  From  our   perspec tive,  the  ma jor  
challenges  come   from  uncertainties  in  ROI  boundary   definition,  the   tremendous  variability  
across individuals, and high  nonlinearities  within and around ROIs.   

Current  approaches  for   identify ing bra in ROIs  can be  broadly   c lassified  into  four  categories.  
The  firs t  is  manua l  labe ling  by   experts  using   the ir  doma in  knowledge.  The  second  is  a  
data-dr iven  cluster ing  of   ROIs  from  the  brain  image  itself.  For  instance,  the  ReHo   (regiona l  
homogeneity)  algorithm [11]  has been used  to identify  regiona l homogeneous regions as ROIs.  
The third is to  predefine ROIs in a template brain, and warp them back  to  the individual space  
using image regis tration [12] .  Lastly, ROIs can be defined from the ac tivated regions observed 
during  a  task-based  fMRI   paradigm.   While  fruitful  results  have  been  achieved  us ing  these  
approaches,  there  are  various  limita tions .  For  instance,  manua l  labe ling  is  difficult  to  
implement for  large datase ts and may  be vu lnerable to inter-subject and intra -subject variation;  

it  is  difficult  to  build  correspondence  across  subjec ts  using   da ta -driven  cluster ing  me thods ;  
warping  temp late  ROIs  back  to  individual  space  is  subject  to  the  accuracy   of  warping 
techniques and the ana tomical variability  across subjec ts.  

Even  identify ing  ROIs  us ing  task -based  fMRI   paradigms ,  which  is  regarded  as  the  standard  
approach  for   ROI   identification,  is  s till  an  open  ques tion.   It  was  reported  in  [13]   tha t  many  
imaging-rela ted  variables  including  scanner  vender,  RF  coil   charac ter istics  (phase  array   vs.  
volume coil), k -space acquisition tra jectory, reconstruc tion algor ithms , susceptibility -induced  
signal  dropout,  as  well  as  fie ld  strength  differences,  contr ibute  to  varia tions  in   ROI  
identification .   Other  researchers  reported  that  spa tial   smoothing,  a   common  preprocessing  
technique in fMRI  analysis to enhance SNR, may  introduce artific ial localization shift s (up to  
12.1mm  for   Gauss ian  kernel  volume t ric  smoothing )   [14]  or  generate  overly   smoothed  
activation maps tha t may  obscure impor tant de tails  [15] .  For example, as shown in  Fig.1a, the  
loca l  maximum  of  the  ROI  was  shifted   by   4mm  due  to  the  spa tial  smoothing   process.  
Additiona lly,  
its  structural  profile  (Fig.1b)  was  significantly   altered .   Furthermore ,  
group-based activation maps may  show different patterns from an individua l 's activa tion map;  
Fig.1c  depicts   such  difference s.  The  top  pane l  is  the  group  activation  map  from  a   working  
memory  study, while the bottom panel is the activa tion map o f one subjec t  in the study.  As  we  
can  see  from  the  highlighted  boxes,  the   subject  has  less  activated  regions  than  the  group  
analysis  result.  In  conc lus ion ,   standard   analysis  of  task-based  fMRI  paradigm   da ta   is  
inadequate  to accurate ly  localize ROIs  for each individual .        

 

Fig.1. (a): Local ac tivation map  maxima  (marked by  the  cross) shift  of one ROI due to  spatia l  
volume tr ic smoothing. The top one was de tected using unsmoothed da ta while the bottom one 
used smoothed data (FWHM: 6.875mm) .  (b): The corresponding fibers for the ROIs in (a). The 
ROIs are  presented using a sphere (radius : 5mm) . (c): Activation map differences be tween  the  
group (top)  and one subject  (bottom) . The highlighted boxes show  two  of the miss ing activated  
ROIs found from  the group analysis.   

Without accurate and reliable individua lized ROIs, the validity  of bra in connec tivity  analysis ,  
and  computationa l  mode ling  of  dynamics  and  interactions  among  brain  ne tworks ,   would   be  
ques tionable . In response to  this fund amenta l issue, this  paper presents a nove l computationa l  
me thodology   to  optimize  the  loca tions  of   an  individual 's  ROIs  initia lized  from  task-based  
fMRI. We  use   the  ROIs  identified  in  a  block -based  working  memory   paradigm  as  a  test  bed 
applica tion  to deve lo p and evaluate our methodology. The optimization of ROI  locations was  
formulated  as   an  energy   minimization  problem,   w ith  the   goa l  of  jointly   maximiz ing   the  
group-wise   consistency   of  functional  and  s tructural   connectivity   patterns  and   anatomic  
profiles.  The   optimiza tion  problem  is  solved  via  the  well -established  simula ted  annea ling  
approach. Our   experimental   results  show  tha t  the  optimized ROIs  achieved  our  optimization  
objectives and  demons trated  promising  results.                

2  

M a t e r i a l s   a n d   M e t h o d s  

2 . 1  

D a t a   a c q u i s i t i o n   a n d   p r e p r o c e s s i n g  

Twenty-five  university   students were  recruited  to  partic ipa te  in  
this  study. Each par tic ipant  performed an fMRI modified  version  
of  the  OSPAN  task  (3  block  types:  OSPAN,  Arithmetic,  and  
Baseline)   while  fMRI   data   was  acqu ired.   DTI  scans   were  also  
acquired  for   each   participant.  FMRI  and  DTI  scans  were  
acquired on a 3T GE Signa scanner. Acquisition parame ters were 
as  follows  :  fMRI:  64x64  ma tr ix,  4mm  slice  thickness,  220mm 
FOV,  30  slices,  TR=1.5s,  TE=25ms ,  ASSET=2;  DTI:  128x128  
ma tr ix,  2mm  slice 
thickness,  256mm  FOV,  60   slices,  
TR=15100ms ,   TE=  variable,  ASSET=2 ,  3  B0  images,  30  
optimized gradient directions, b -value=1000) . Each par ticipant’s 
 
fMRI  data   was  analyzed  us ing  FSL.  Individual  activa tion  map  
Fig.2.  working memory  
reflec ting the OSPAN (OSPAN > Base line ) contrast was used.  In  
ROIs mapped on a 
total , we identified  the 16  highes t activated ROIs ,  inc luding left  
WM/GM surface    
and right insula, left and right medial frontal gyrus, left and righ t  
 
precentral gy rus, left and right paracingula te gyrus, left and righ t  
dorsolatera l  prefrontal  cortex,  left  and  r ight  inferior  par ieta l  lobule,  left  occ ipita l  pole,  right  
frontal  pole, right  la teral occ ipita l gyrus, and left and r ight precuneus.  Fig.2 shows the 16 ROIs  
mapped  onto  a  WM(white  ma tter)/GM(gray   matter)  cortica l  surface.  For  some  individuals,  
there  may   be  miss ing  ROIs  on  the ir   activation  maps .  Under  such  condition,  we  adapted   the  
group activa tion map  as a guide  to find  these ROIs  using  linear  regis tration .    

DTI pre-processing cons isted of skull remova l, motion correction, and eddy  current correction .  
After  the pre -processing,  fiber  tracking  was  performed us ing MEDINRIA  (FA  threshold: 0.2;  
minimum  fiber   length:  20).  Fibers were   extended   a long   the ir   tangent   direction s  to  reach  into  
the gray  matter  when necessary.  Brain tissue segmenta tion was  conducted on DTI data by   the  
me thod  in  [16]   and  the  cortical  surface   was   reconstructed  from  the   tissue  maps  using  the  
marching cubes algor ithm. The cortical surface  was  parcellated into anatomica l regions us ing  
the HAMMER tool [17] . DTI space was used as the s tandard  space from which to generate the  
GM  (gray   ma tter)   segmenta tion  and  from  which  to  report  the  ROI   locations   on  the  cortical  
surface.  Since   the  fMRI   and  DTI  sequences  are  both  EPI   (echo  planar  imaging)   sequences, 
the ir  dis tortions  tend  to  be  similar  and  the  misa lignment  between  DTI  and  fMRI  images  is  
much less than that be tween  T1 and fMRI images [ 18]. Co-regis tration be tween DTI and fMRI 
data was  performed  us ing  FSL  FLIRT  [12] . The  ac tiva ted ROIs  and  tracked  fibers   were  then  
mapped onto  the cortical surface for joint modeling .  

2 . 2  

J o i n t   m o d e l i n g   o f   a n a t o m i c a l ,   s t r u c t u r a l   a n d   f u n c t i o n a l   p r o f i l e s  

Despite the high degree of  variability  across subjects, there are several  aspec ts of regularity  on  
which we base the proposed  solution. F irst ly,  across subjects, the func tional ROIs  should have  
similar   ana tomical  locations ,  e.g.,  similar   locations  in  the  atlas  space .  Second ly,  these  ROIs  
should   have  s imilar   s truc tural  connec tivity   profiles  across  subjec ts .   In  other  words ,  fibers  
pene trating the same func tional ROIs should have at lea s t similar  target  regions across subjec ts .  
Lastly,   individua l  networks   identified  by   task -based   paradigms ,  like  the  working  memory  
network  we  adapted  as  a  test  bed  in  this  paper,  should  have  s imilar  func tiona l  connectivity  
pattern  across   subjec ts.  The   neurosc ience   bases  of  the  above  premises  include:  1)   structural  
and  functiona l  brain  connectivity   are  closely   related   [ 19],  and  cortica l  gyrification  and 
axongenesis processes are closely  coupled [ 20]; Hence, it  is reasonable to put these three types  
of informa tion  in a joint modeling framework. 2) 
Extensive studies have already  demonstrated the 
exis tence of a common s truc tural and func tiona l 
architecture  of  the  human   brain  [2 1,  22],  and  it  
makes sense to assume  tha t the working memory  
network  has  similar   struc tural  and  functiona l  
connectivity  patterns across  individua ls.    

Based  on  these   premises ,  we  proposed  to 
optimize  the  locations  of  individua l  func tional  
ROIs  by   jointly   mode ling   anatomic  profiles,  
structural  connectivity   pa tterns,  and  functiona l  
connectivi ty  patterns, as illustrated in Fig 3.  The 

Fig.3. ROIs optimization scheme.   
 

 

goa l was  to minimize  the group-wise variance  (or  maximize group -wise cons istency ) of these  
jointly  modeled profiles. Mathema tica lly, we mode l ed the group-wise variance  as energy  
 as 
follows.  A  ROI   from  fMRI   analysis  was  mapped  onto  the  surface ,   and   is  represented  by   a  
center vertex and its ne ighborhood .  Suppose 𝑅𝑖𝑗  is the ROI region 
 on the  cortical surface of 
 identified in Section 2. 1; we find  a corresponding surface ROI  region  𝑆𝑖𝑗  so tha t the  
subject  
energy
(contains energy  from 
 subjec ts, each with 
 ROIs) is minimized :   

𝐸 = 𝐸𝑎 (𝜆

𝐸𝑐−𝑀𝐸𝑐
𝜎𝐸𝑐

+ (1 − 𝜆)

𝐸𝑓−𝑀𝐸𝑓
𝜎𝐸𝑓

)                                                         (1)  

where 

is  the  anatomica l  constraint; 

 is  the   structural  connec tivity   constraint, 

and  

are  the  mean  and  standard  deviation   of 

in  the  searching  space ;   

is  the  func tiona l  

connectivity  constra int, 

and 

are  the mean and s tandard  deviation  of 

respectively;  

and is a we ighting parame ter between 0 and  1.  If not spec ified ,  
and 
is the number  of ROIs in  this paper. The details of these 
energy  terms are provided in the following sections.     
 
2 . 2 . 1   A n a t o m i c a l   c o n s t r a i n t   e n e r g y  

is the number of subjects,  

Ana tomical  constra int  energy
is  defined   to  ensure   that  the  
optimized ROIs  have  similar  anatomica l  locations  in  the  atlas  
space  (Fig .4  shows  an  example  of  ROIs   of  15  randomly  
selected subjects  in the atlas space) . We model the locations for  
all  ROIs  in  the  atlas  space  using  a  Gaussian  model   (mean :  
𝑀𝑋𝑗 ,and  standard   devia tion : 
for   ROI  
).  The  mode l  
parame ters were   estima ted  using  the  initial  locations obta ined 
from Sec tion 2.1. Let 
be the  center  coordinate of region 
 

in the atlas space,  then

where  

Fig.4. ROI dis tributions 
in Atlas space .    
is expressed as   
 
1
𝑒 𝑑𝑚𝑎𝑥−1     (𝑑𝑚𝑎𝑥≤1)
             𝐸𝑎 = {
(𝑑𝑚𝑎𝑥>1)                                                     (2) 

 

𝑋𝑖𝑗−𝑀𝑋𝑗
𝑑𝑚𝑎𝑥 = 𝑀𝑎𝑥 {  ‖
3𝜎𝑋𝑗

‖   , 1 ≤ 𝑖 ≤ 𝑛;  1 ≤ 𝑗 ≤ 𝑚. }                            (3)  

Under   the  above  definition,  if  any

is within  the  range  of 

from  the  dis tribution mode l 

center

,  the  anatomical  cons traint  energy   will  a lways  be  one ;  if  not,   there  will  be   an  

exponential  increase  of  the  energy   which  punishes  the  poss ible  involvement  of  outliers.    In  
other  words,  this  energy   fac tor  will  ensure  the  optimized ROIs  will  not  s ignificant ly   deviate  
away  from  the  origina l ROIs .   
 
2 . 2 . 2   S t r u c t u r a l   c o n n e c t i v i t y   c o n s t r a i n t   e n e r g y  
Structural  connec tivity   constraint  energy
 is  defined  to  ensure   the   group  has  similar  

structural  connectivity   profiles  for  each   functional  ROI ,  since  s imilar  func tiona l  regions  
should have the similar structural connec tivity  patterns [ 19] ,    

                                        (4) 

where 

 is  the  connectivity   pattern  vec tor  for  ROI  of  subject 

,  

is  the  group   mean  

for ROI 

, and 

is the  inverse of the covariance ma trix.   

The  connectivity   pa ttern  vector 

 is  a  fiber   target   region  distr ibution  histogram.   To  obta in  

this  histogram, we first parcella te a ll the cortica l surfaces into nine regions  ( as shown in Fig.5a,  
four  lobes  for   each  hemisphe re,  and   the  subcortical  region)   us ing  the  HAMMER  algorithm 

EjiEnmaEcEcEMcEcEfEfEMfEfEnmaEjXjijXijSaEijX3jXsjXMcE111()()jjnmTcijCijCijECMCovcCMijCjijCMj1CovcijC[17] .   A  finer   parcellation  is   available  but   not  used   due   to  the  re latively   lower   parcella tion  
accuracy, which might  render  the his togram  too  sens itive  to  the  parcellation  result . Then, we  
extrac t fibers pene trating  region 
, and ca lcula te the dis tribution of the  fibers’ targe t cortical  

regions. Fig.5  illustra tes the  ideas .    
 

 

Fig.5.  Structural  connec tivity   pattern  descriptor.  (a):  Cortical  surface  parcella tion  us ing  
HAMMER   [17];  (b):  Joint  visualization  of  the  cor tica l  surface,  two   ROIs  (blue  and  green  
spheres) , and fibers penetrating the ROIs ( in red and yellow, respective ly); (c): Corresponding  
target region distribution histogram of ROIs in Fig. 5b. There are nine bins corresponding to the  
nine  cortical  regions.  Each  bin  contains  the  number   of  fibers  tha t  penetrate  the  ROI  and  are 
connected to the corresponding cor tica l region. Fiber numbers are norma lized across subjec ts .  

2 . 2 . 3   F u n c t i o n a l   c o n n e c t i v i t y   c o n s t r a i n t   e n e r g y  

Functiona l  connec tivity   constraint  energy  

is defined  to  ensure   each  individua l  has  s imilar  

functional  connec tivity   pattern s  for  the  working  memory   system,   assuming  the  human  brain  
has similar functional architecture across  individuals  [21] .       
𝑛
𝐸𝑓 = ∑ ‖𝐹𝑖 − 𝑀𝐹 ‖
                                                                                           (5) 
𝑖=1
is  the  group mean  of  the 
,  and 
 is  the  func tiona l  connectivity  ma tr ix  for  subject

Here ,  

datase t. The connectivity  be tween each pa ir of ROIs is  defined  us ing the Pearson correlation.  
The ma trix distance used here is the Frobenius norm.  

2 . 3  

E n e r g y   m i n i m i z a t i o n   s o l u t i o n  

The  minimization  of  the   energy   defined  in  Section  2.2  is  known  as  a  combina tor ial 
optimiza tion  problem.  Traditional optimization me thods may  not   fit  this problem,  s ince  there  
are  two  noticeable  charac teristics  in  this  applica tion.  F irst,  we  do  not   know   how  the  energy 
changes  with   the  varying  loca tions  of  ROIs.  Therefore,  techniques  like  Newton’s  method  
cannot  be  used.    Second,  the  structure  of  search  space  is  not  smooth,  which  may   lead  to 
multiple  loca l   minima   during  optimiza tion.  To   address  this   p roblem, we  adopt  the   simula ted  
annea ling  (SA)   algorithm  [23 ]   for  the  energy   minimiza tion.  The  idea  of  the  SA  algorithm  is 
based   on  random  walk  through  the   space  for  lower  energies.  In  these  random  walks,  the  
probability  of  taking a step  is determined by   the Boltzmann distr ibution,  

                                                                                               (6) 

if

, and 

 when 

. Here, 𝐸𝑖  and 𝐸𝑖+1  are the system energies at solution  
configura tion  𝑖   and  𝑖 + 1  respectively;  𝐾 is  the  Boltzmann  constant;   and  𝑇  is  the  system 
temperature. In other  words,  a step will be taken when a lower energy  is  found. A step will also  
be  taken with  probability  
if  a  higher  energy   is  found. This  helps  avoid   the  loca l minima  in 

the search space.   

 3  

R e s u l t s  

Compared  to  structural  and   functiona l  connectivity   patterns,  ana tomical  profiles   are  more  

ijSfEiFiFM1()/()iiEEKTpe+--=1iiEE1p1iiEEpeasily  affec ted  by  variability  across individuals. Therefore, the anatomical constra int energy  is  
designed to provide constra int only  to ROIs that are obvious ly  far away  from  reasonableness .    
The  reasonable  range  was   statis tica lly   modeled  by   the  localizations  of  ROIs warped   into  the  
atlas space  in Section 2.2.1 .  Our focus   in this paper  is the structural and func tiona l profiles.   

3 . 1  

O p t i m i z a t i o n   u s i n g   a n a t o m i c a l   a n d   s t r u c t u r a l   c o n n e c t i v i t y   p r o f i l e s  

In this section , we use only  anatomica l and struc tural  connec tivity  profiles to optimize the 
loca tions of ROIs. The goa l  is to check whether  the struc tural cons traint energy  
 works as 
expec ted. Fig.6 shows  the fibers penetra ting  the  right precuneus  for  e ight  subjec ts before  (top  
pane l)  and after  optimiza tion  (bottom panel) . The ROI  is highlighted in  a red sphere  for each 
subject. As we can see from  the  figure  (please refer  to  the highlighted yellow arrows) , after 
optimiza tion, the third and s ixth subjec ts  have  significantly  improved con sistency  with  the res t  
of the  group than before optimization, which proves the validity  of the  energy   func tion Eq.(4).    

 

Fig.6. Compar ison of s truc tural profiles before and after  optimiza tion. Each column shows the  
corresponding  before -optimization (top) and after -optimization (bottom)  fibers of one subjec t. 
The ROI (right precuneus)  is presented by  the red sphere.   

3 . 2  

O p t i m i z a t i o n  u s i n g   a n a t o m i c a l   a n d   f u n c t i o n a l   c o n n e c t i v i t y   p r o f i l e s  

In  this  sec tion ,  we  optimize   the   locations   of  ROIs  using  anatomica l  and  func tiona l  profiles,  
aiming to va lidate the definition of functional connec tivity  constraint energy
. If this energy  

cons traint   worked  we ll,  the   functional  connec tivity   variance  of  the  working  memory   system 
across  subjects  would  decrease.  Fig .7  shows  the  comparison  of  the  s tandard  derivation  for  
functional connectivity  before ( left) and after ( right) optimization. As we can see, the variance  
is significantly  reduced after optimization . This  demons trated  the effectiveness of the defined  
functional connectivity  cons traint energy.   

Fig.7. Comparison  of  the  standard  deriva tion  for  func tiona l  connec tivity   before  and  after  the  
optimiza tion.     Lower  values mean more consistent connectivity   pattern cross subjec ts.    

 

cEfEC o n s i s t e n c y   b e t w e e n   o p t i m i z a t i o n   o f   f u n c t i o n a l   p r o f i l e s   a n d  
3 . 3  
s t r u c t u r a l   p r o f i l e s  

 

 

Fig.8.  Optimization  consis tency   between   func tiona l  and  structural  profiles.  Top:  Functiona l 
profile  energy   drop  along   with  structural  profile  optimization;  Bottom:   Struc tural  profile  
energy   drop  a long  with  functiona l  profile  optimization.  Each   experiment   was   repeated  15  
times with random  initia l ROI  loca tions  that me t  the anatomical cons traint.   

The  relationship   between  structure  and  func tion  has  been  extens ive ly   studied   [24] ,  and  i t  is 
widely  be lieved that they  are closely  rela ted. In this  section, we s tudy  the rela tionship be tween  
functional profiles and struc tural profiles by  looking at how the energy  for one of them changes  
while the energy  of the  other  decreases .  The optimization  processes in Section 3.1  and 3.2 were  
repeated  15  times  respectively   with  random  initia l  ROI  locations  that  me t  the  anatomica l  
cons traint. As shown in F ig. 8, in general ,  the functional profile energies and struc tural profi le  
energies are c losely  rela ted  in such a  way  that the  f unc tiona l profile energies  tend  to decrease  
along with the  structural profile optimiza tion process, while the structural profile energies  a lso  
tend  to  decrease  as  the  func tiona l profile   is optimized. This  pos itive ly   correlated decrease of 
functional  profile  energy   and  struc tura l  profile  energy   not  only   proves  the  c lose  relationship  
between   func tional  and   structural   profiles ,  but   also  demonstra tes  the  cons istency   between 
functional  and  struc tura l  optimization,  laying  down  the  foundation  of  the  joint  optimiza tion ,  
whose results are  detailed in  the following  section.   

O p t i m i z a t i o n   u s i n g  
3 . 4  
c o n n e c t i v i t y   p r o f i l e s  

a n a t o m i c a l ,  

s t r u c t u r a l  

a n d  

f u n c t i o n a l  

In this section , we used all the cons traints in Eq. (1) to optimize the individua l loca tions of a ll  
ROIs  in  the  working  memory   system.  Ten  runs  of  the  optimiza tion  were  performed  using  
random  initia l  ROI   locations  tha t  me t  the  ana tomical   constra int.  Weighting  parameter 
 
equa led   0.5  for   all  these  runs.  Starting  and  ending  tempera tures  for   the  simula ted  annea ling  
algorithm  are   8  and  0.05;  Boltzmann  constant
.   As  we   can  see   from  Fig.9,  most  runs  
started  to  converge  at  step  24,  and  the  convergence  energy   is  quite   close  for   all  runs.  This  
indica tes that  the simula ted annea ling a lgorithm provides a valid solution  to our problem.    

By  visual inspection, most of the ROIs move to more  reasonable  and consistent locations  after  
the  joint  optimization.   As  an  example,   Fig.10  depicts  the  loca tion movements  of  the ROI   in  
Fig. 6 for  e ight subjec ts.  As we can  see, the ROIs for these subjects  share a similar anatomica l  

1Klandmark, which appears  to be  the  tip of  the upper bank  of  the  parie to -occipita l sulcus .   If  the  
initial ROI  was   not  a t  this  landmark,  it  moved   to  the  landmark  after   the  optimization, which  
was   the  case  for   subject s  1,  4  and 7. The  s tructural  profiles of  these ROIs  are very   similar  to  
Fig.6. The results in Fig. 10 indica te the significant impr ovement of ROI locations achieved by  
the joint optimization procedure.    

Fig.9.    Convergence  performance  of  the  simula ted  annealing  .  Each  run  has  28  tempera ture  
conditions.   

 

 

Fig.10.   The  movement  of  r ight   precuneus   before  (in   red  sphere)  and   after   (in  green  sphere)  
optimiza tion  for   eight  subjects.  The  "C"-shaped  red  dash  curve   for  each  subjec t  depicts   a 
similar   anatomical  landmark  across  these   subjects .     The  yellow  arrows  in  subject  1 ,  4   and  7  
visualized  the  movement direction  after optimization.   
 
4  
C o n c l u s i o n  
This  paper   presented  a  novel  computa tiona l  approach  to  optimize   the  locations   of  ROIs  
identified  from  task -based   fMRI.  The  group-wise  consistency   of  func tiona l  and   structura l  
connectivity   patterns,  and  anatomica l   locations  are  jointly   modeled   and  formulated  in  an  
energy   function,  which  is  minimized  by   the  simulated  a nnealing  optimization  algorithm .  
Experimenta l results demonstrate the optimized ROIs have more reasonable loca lizations , and 
have  significantly   improved   the cons istency   of structural  and  func tional connec tivity  profiles  
and morphologica l and anatomic profiles  across subjec ts .  Our future work inc ludes  extending  
this framework to  optimize other  parame ters of ROIs such as size and shape, and applying and  
evaluating this me thodology  to the optimization of ROIs identified in  other brain systems  such  
as the visual, auditory, language, a ttention, and emotion networks.     

5       R e f e r e n c e s  
1 .   Fris ton ,  K. , Moda l i t ies,  modes ,  and  mode ls  in  func t iona l  neuroimaging .  Sc ience , vol .326 ,  no .5951 ,  
399-403(2009) .  
2 .   Bhara t  B .  Biswa l ,  Toward  discovery sc ience  of human  bra in  func t ion ,  PNAS March  9 , 2010  vol .  107  
no .  10  4734 -4739 .    
3 .   Sporns  O,  Tononi  G,  Köt ter  R ,  The  human  connec tome :  A s truc tura l  descript ion  of the  human  bra in .  
PLoS Comput  Biol .  2005  Sep;  1(4):  e42 .  
4 .   Van  Di jk  KR ,  Hedden  T,  Venka taraman  A,  Evans  KC,  Lazar  SW,  Buckner  RL ,  Intrins ic  func t ional 
connec t ivi ty as a  tool for  human  connec tomics :  theory,  propert ies , and opt imiza t ion .  J Neurophys iol .  
2010  Jan;  103(1):  297 -321 .  
5 .   Hagmann  P,  e t  a l . ,  MR  connec tomics :  Princ ip les  and  cha l lenges .  J  Neurosci  Me thods .  2010  Jan  22 .  
6 .   Fris ton  K,  J .  e t  a l . ,  Dynamic  causa l  mode l ing ,  Neuroimage ,  19 ,  1273 -1302 ,  2003 .    
7 .   ht tp: / /www.humanconnec tomeprojec t .org/  
8 .   ht tp: / /www.ni trc .o rg/projec ts /fcon_1000/  
9 .   Goebe l ,R. ,   e t  al . ,   Inves t iga t ing   direc ted   cort ica l   interac t ions   in   time -resolved   fMRI   da ta   us ing 
vec tor   autoregress ive  mode l ing   and   Granger   causa li ty  mapping .   Magne t ic  Resonance   Imaging , 
Volume  21 ,  Issue  10 ,  December  2003 ,  Pages  1251 -1261  
10 .   Harrison  L ,  et  al . ,  Mul t ivariate  autoregress ive mode l ing  of fMRI  t ime  series ,  NeuroImage ,  Volume  
19 ,  Issue 4 ,  Augus t  2003 ,  Pages  1477 -1491  
11 .   Zang ,   Y.,   e t  a l .,  “Regiona l  homogene i ty  approach   to  fMRI   da ta   ana lys is ,”  NeuroImage ,   22(1):   p .  
394-400 ,  2004 .    
12 .   Jenkinson ,  M . , Bannis ter,  P. ,  Brady,  M . ,  Smi th ,  S. ,  2002 .  Improved  opt imiza t ion  for  the  robus t  and  
accura te  l inear  regis tra t ion  and mot ion  correc t ion  of bra in   images .  Neuroimage  17 ,  825 –841 .  
13 .   Friedman ,  L . ,  and  Glover,  G.H.  (2006) .  Report  on  a  Mul t icenter  fM RI  Qua l i ty Assurance  Protoco l .  
Journa l  of Magne t ic  Resonance   in  Imaging ,  23(6):827 -839 .  
14 .   H.J .   Jo,   J.M . Lee ,   J.H.  Kim,  C .H.  Choi ,  B.M .  Gu  and  D.H.  Kang  e t  a l. ,  Art ific ia l  shift ing  of   fMRI  
ac t iva t ion  local ized   by  volume -   and   surface -based  ana lyses,   NeuroImage   40   (3)   (2008) ,   pp .  
1077–1089 .  
15 .   W.  Ou ,  W.M .  We l ls   III ,  and  P.  Gol land . Combining  Spa t ia l  Priors   and  Ana tomica l   Informa t ion   for  
fMRI  De tec t ion .  Medica l  Image  Ana lys is ,  14(3):318 -331 ,  2010 .  
16 .   Tianming   L iu ,   Ha i   L i ,   Ke lvin   Wong ,   Ashley  Tarokh ,   Le i   Guo ,   Stephen   Wong ,   Bra in   Tissue 
Segmenta t ion  Based  on  DTI  Data ,  NeuroImage ,  38(1):114 -23 ,  2007 .  
17 .   Shen ,  D. ,  e t  a l . ,  2002 .  HAMMER:  hierarchica l  a t tribute  ma tching  mechanism for  e las t ic  regis tra t ion .  
IEEE  Trans Med  Imaging  21(11) ,  1421 -39 .  
18 .   L i   K,   e t  a l .,   Cort ica l   surface   based   identifica t ion   of  bra in   ne tworks   us ing   high   spa t ia l  reso lut ion  
res t ing   sta te  fMRI   da ta ,  Interna t iona l   Sympos ium  of  Biomedica l   Imaging   (ISBI)   2010 .DOI :  
10 .1109/ISBI .2010 .5490089   .    
19 .   Pass ingham  RE ,   e t   a l. ,   The   ana tomica l   bas is   of  func t iona l   loca l izat ion   in   the   cortex .   Na t   Rev  
Neurosc i .  3(8):606 -16 .  2002 .  
20 .   Van  Essen ,  D. :  A tens ion -based theory of morphogenes is  and  compac t  wiring  in  the  centra l    nervous  
sys tem.  Na ture  385:313 -318  (1997) .  
21 .   M .D.   Fox   and  M .E . Ra ichle,   “Spontaneous   fluc tua t ions   in  bra in   ac t ivity  observed  wi th   func t iona l  
magne t ic  resonance   imaging ” ,  Na t  Rev  Neurosc i  8:700 -711 ,  2007 .  
22 .   Van  Di jk  KR ,  Hedden  T,  Venka taraman  A,  Evans  KC,  Lazar  SW,  Buckner  RL ,  Intrins ic  func t ional 
connec t ivi ty as a  tool for  human  connec tomics :  theory,  propert ies , and opt imiza t ion .  J Neurophys iol .  
2010  Jan;  103(1):  297 -321 .  
23 .   V.  Granvi l le , e t a l . , Simula ted  annea l ing:  A proof of convergence" . IEEE  Transac t ions on  PAM I  16  
(6):  652–656 .  June  1994 .    
24 .   Honey CJ ,  Sporns  O ,  Cammoun  L ,  Gigande t X ,  Thiran  JP,  Meul i  R ,  Hagmann  P.  Predic t ing  human  
res t ing-s tate  func t iona l  connect ivi ty from s truc tura l  connec tivi ty.  PNAS,  106(6):2035 -40 .  2009 .      
 
 
 
 
 
 
 
 

