Probabilistic Matrix Factorization

Ruslan Salakhutdinov and Andriy Mnih
Department of Computer Science, University of Toronto
6 King’s College Rd, M5S 3G4, Canada
{rsalakhu,amnih}@cs.toronto.edu

Abstract

Many existing approaches to collaborative ﬁltering can nei ther handle very large
datasets nor easily deal with users who have very few ratings. In this paper we
present the Probabilistic Matrix Factorization (PMF) model which scales linearly
with the number of observations and, more importantly, performs well on the
large, sparse, and very imbalanced Netﬂix dataset. We furth er extend the PMF
model to include an adaptive prior on the model parameters and show how the
model capacity can be controlled automatically. Finally, we introduce a con-
strained version of the PMF model that is based on the assumption that users who
have rated similar sets of movies are likely to have similar preferences. The result-
ing model is able to generalize considerably better for users with very few ratings.
When the predictions of multiple PMF models are linearly combined with the
predictions of Restricted Boltzmann Machines models, we achieve an error rate
of 0.8861, that is nearly 7% better than the score of Netﬂix’s own system.

1 Introduction

One of the most popular approaches to collaborative ﬁlterin g is based on low-dimensional factor
models. The idea behind such models is that attitudes or preferences of a user are determined by
a small number of unobserved factors. In a linear factor model, a user’s preferences are modeled
by linearly combining item factor vectors using user-speciﬁc coefﬁcients. For example, for N users
and M movies, the N × M preference matrix R is given by the product of an N × D user coefﬁcient
matrix U T and a D × M factor matrix V [7]. Training such a model amounts to ﬁnding the best
rank-D approximation to the observed N × M target matrix R under the given loss function.

A variety of probabilistic factor-based models has been proposed recently [2, 3, 4]. All these models
can be viewed as graphical models in which hidden factor variables have directed connections to
variables that represent user ratings. The major drawback of such models is that exact inference is
intractable [12], which means that potentially slow or inaccurate approximations are required for
computing the posterior distribution over hidden factors in such models.

Low-rank approximations based on minimizing the sum-squared distance can be found using Sin-
ˆR = U T V of the given rank which min-
gular Value Decomposition (SVD). SVD ﬁnds the matrix
imizes the sum-squared distance to the target matrix R. Since most real-world datasets are sparse,
most entries in R will be missing. In those cases, the sum-squared distance is computed only for
the observed entries of the target matrix R. As shown by [9], this seemingly minor modiﬁcation
results in a difﬁcult non-convex optimization problem whic h cannot be solved using standard SVD
implementations.

Instead of constraining the rank of the approximation matrix ˆR = U T V , i.e. the number of factors,
[10] proposed penalizing the norms of U and V . Learning in this model, however, requires solv-
ing a sparse semi-de ﬁnite program (SDP), making this approa ch infeasible for datasets containing
millions of observations.

1

σ

V

V j

σ

U

U

i

σ

V

V j

j=1,...,M

R ij

σ

i=1,...,N

j=1,...,M

R ij

σ

σ

W

W
k

k=1,...,M

σ

U

iY

U i

iI

i=1,...,N

Figure 1: The left panel shows the graphical model for Probabilistic Matrix Factorization (PMF). The right
panel shows the graphical model for constrained PMF.

Many of the collaborative ﬁltering algorithms mentioned ab ove have been applied to modelling
user ratings on the Netﬂix Prize dataset that contains 480,1 89 users, 17,770 movies, and over 100
million observations (user/movie/rating triples). However, none of these methods have proved to
be particularly successful for two reasons. First, none of the above-mentioned approaches, except
for the matrix-factorization-based ones, scale well to large datasets. Second, most of the existing
algorithms have trouble making accurate predictions for users who have very few ratings. A common
practice in the collaborative ﬁltering community is to remo ve all users with fewer than some minimal
number of ratings. Consequently, the results reported on the standard datasets, such as MovieLens
and EachMovie, then seem impressive because the most difﬁcu lt cases have been removed. For
example, the Netﬂix dataset is very imbalanced, with “infre
quent” users rating less than 5 movies,
while “frequent” users rating over 10,000 movies. However,
since the standardized test set includes
the complete range of users, the Netﬂix dataset provides a mu ch more realistic and useful benchmark
for collaborative ﬁltering algorithms.

The goal of this paper is to present probabilistic algorithms that scale linearly with the number of
observations and perform well on very sparse and imbalanced datasets, such as the Netﬂix dataset.
In Section 2 we present the Probabilistic Matrix Factorization (PMF) model that models the user
preference matrix as a product of two lower-rank user and movie matrices. In Section 3, we extend
the PMF model to include adaptive priors over the movie and user feature vectors and show how
these priors can be used to control model complexity automatically. In Section 4 we introduce a
constrained version of the PMF model that is based on the assumption that users who rate similar
sets of movies have similar preferences. In Section 5 we report the experimental results that show
that PMF considerably outperforms standard SVD models. We also show that constrained PMF and
PMF with learnable priors improve model performance signiﬁ cantly. Our results demonstrate that
constrained PMF is especially effective at making better predictions for users with few ratings.

2 Probabilistic Matrix Factorization (PMF)

Suppose we have M movies, N users, and integer rating values from 1 to K 1 . Let Rij represent
the rating of user i for movie j , U ∈ RD×N and V ∈ RD×M be latent user and movie feature
matrices, with column vectors Ui and Vj representing user-speciﬁc and movie-speciﬁc latent featu
re
vectors respectively. Since model performance is measured by computing the root mean squared
error (RMSE) on the test set we ﬁrst adopt a probabilistic lin ear model with Gaussian observation
noise (see ﬁg. 1, left panel). We de ﬁne the conditional distr
ibution over the observed ratings as
M
N
i Vj , σ2 )(cid:21)Iij
Yj=1 (cid:20)N (Rij |U T
Yi=1
where N (x|µ, σ2 ) is the probability density function of the Gaussian distribution with mean µ and
variance σ2 , and Iij is the indicator function that is equal to 1 if user i rated movie j and equal to

p(R|U, V , σ2 ) =

,

(1)

1Real-valued ratings can be handled just as easily by the models described in this paper.

2

0 otherwise. We also place zero-mean spherical Gaussian priors [1, 11] on user and movie feature
vectors:

p(U |σ2
U ) =

M
N
Yj=1
Yi=1
The log of the posterior distribution over the user and movie features is given by

N (Ui |0, σ2
U

p(V |σ2
V ) =

N (Vj |0, σ2
V

I),

I).

(2)

1
2σ2
U

Iij (Rij − U T
i Vj )2 −

V , σ2
ln p(U, V |R, σ2 , σ2
U ) = −

M
N
1
1
Xj=1
Xi=1
2σ2
2σ2
V
Iij 
V 


M
N
Xi=1
Xj=1
U + M D ln σ2
 ln σ2 + N D ln σ2
 + C,


where C is a constant that does not depend on the parameters. Maximizing the log-posterior over
movie and user features with hyperparameters (i.e. the observation noise variance and prior vari-
ances) kept ﬁxed is equivalent to minimizing the sum-of-squ ared-errors objective function with
quadratic regularization terms:

N
Xi=1

M
Xj=1

U T
i Ui −

V T
j Vj

(3)

1
2

−

+

1
2

E =

λU
2

M
N
M
N
i Vj (cid:1)2
Xj=1
Xi=1
Xj=1
Xi=1
Iij (cid:0)Rij − U T
where λU = σ2 /σ2
V , and k · k2
U , λV = σ2/σ2
F ro denotes the Frobenius norm. A local minimum
of the objective function given by Eq. 4 can be found by performing gradient descent in U and V .
Note that this model can be viewed as a probabilistic extension of the SVD model, since if all ratings
have been observed, the objective given by Eq. 4 reduces to the SVD objective in the limit of prior
variances going to in ﬁnity.

k Ui k2
F ro +

k Vj k2
F ro ,

λV
2

(4)

In our experiments, instead of using a simple linear-Gaussian model, which can make predictions
outside of the range of valid rating values, the dot product between user- and movie-speciﬁc feature
vectors is passed through the logistic function g (x) = 1/(1 + exp(−x)), which bounds the range of
predictions:

p(R|U, V , σ2 ) =

M
N
i Vj ), σ2 )(cid:21)Iij
Yj=1 (cid:20)N (Rij |g (U T
Yi=1
We map the ratings 1, ..., K to the interval [0, 1] using the function t(x) = (x − 1)/(K − 1), so
that the range of valid rating values matches the range of predictions our model makes. Minimizing
the objective function given above using steepest descent takes time linear in the number of obser-
vations. A simple implementation of this algorithm in Matlab allows us to make one sweep through
the entire Netﬂix dataset in less than an hour when the model b eing trained has 30 factors.

(5)

.

3 Automatic Complexity Control for PMF Models

Capacity control is essential to making PMF models generalize well. Given sufﬁciently many fac-
tors, a PMF model can approximate any given matrix arbitrarily well. The simplest way to control
the capacity of a PMF model is by changing the dimensionality of feature vectors. However, when
the dataset is unbalanced, i.e. the number of observations differs signiﬁcantly among different rows
or columns, this approach fails, since any single number of feature dimensions will be too high for
some feature vectors and too low for others. Regularization parameters such as λU and λV de ﬁned
above provide a more ﬂexible approach to regularization. Pe rhaps the simplest way to ﬁnd suitable
values for these parameters is to consider a set of reasonable parameter values, train a model for each
setting of the parameters in the set, and choose the model that performs best on the validation set.
The main drawback of this approach is that it is computationally expensive, since instead of training
a single model we have to train a multitude of models. We will show that the method proposed by
[6], originally applied to neural networks, can be used to determine suitable values for the regular-
ization parameters of a PMF model automatically without signiﬁcantly affecting the time needed to
train the model.

3

As shown above, the problem of approximating a matrix in the L2 sense by a product of two low-rank
matrices that are regularized by penalizing their Frobenius norm can be viewed as MAP estimation
in a probabilistic model with spherical Gaussian priors on the rows of the low-rank matrices. The
complexity of the model is controlled by the hyperparameters: the noise variance σ2 and the the
parameters of the priors (σ2
U and σ2
V above). Introducing priors for the hyperparameters and maxi-
mizing the log-posterior of the model over both parameters and hyperparameters as suggested in [6]
allows model complexity to be controlled automatically based on the training data. Using spherical
priors for user and movie feature vectors in this framework leads to the standard form of PMF with
λU and λV chosen automatically. This approach to regularization allows us to use methods that
are more sophisticated than the simple penalization of the Frobenius norm of the feature matrices.
For example, we can use priors with diagonal or even full covariance matrices as well as adjustable
means for the feature vectors. Mixture of Gaussians priors can also be handled quite easily.

In summary, we ﬁnd a point estimate of parameters and hyperpa rameters by maximizing the log-
posterior given by
ln p(U, V , σ2 , ΘU , ΘV |R) = ln p(R|U, V , σ2 ) + ln p(U |ΘU ) + ln p(V |ΘV )+
(6)
ln p(ΘU ) + ln p(ΘV ) + C,
where ΘU and ΘV are the hyperparameters for the priors over user and movie feature vectors re-
spectively and C is a constant that does not depend on the parameters or hyperparameters.
When the prior is Gaussian, the optimal hyperparameters can be found in closed form if the movie
and user feature vectors are kept ﬁxed. Thus to simplify lear ning we alternate between optimizing
the hyperparameters and updating the feature vectors using steepest ascent with the values of hy-
perparameters ﬁxed. When the prior is a mixture of Gaussians , the hyperparameters can be updated
by performing a single step of EM. In all of our experiments we used improper priors for the hy-
perparameters, but it is easy to extend the closed form updates to handle conjugate priors for the
hyperparameters.

4 Constrained PMF

Once a PMF model has been ﬁtted, users with very few ratings wi ll have feature vectors that are close
to the prior mean, or the average user, so the predicted ratings for those users will be close to the
movie average ratings. In this section we introduce an additional way of constraining user-speciﬁc
feature vectors that has a strong effect on infrequent users.

.

(7)

Let W ∈ RD×M be a latent similarity constraint matrix. We de ﬁne the featu re vector for user i as:
Ui = Yi + PM
k=1 IikWk
PM
k=1 Iik
where I is the observed indicator matrix with Iij taking on value 1 if user i rated movie j and 0
otherwise2 . Intuitively, the ith column of the W matrix captures the effect of a user having rated a
particular movie has on the prior mean of the user’s feature vector. As a result, users that have seen
the same (or similar) movies will have similar prior distributions for their feature vectors. Note that
Yi can be seen as the offset added to the mean of the prior distribution to get the feature vector Ui
for the user i. In the unconstrained PMF model Ui and Yi are equal because the prior mean is ﬁxed
at zero (see ﬁg. 1). We now de ﬁne the conditional distributio
n over the observed ratings as
N
M
Vj (cid:1), σ2 )(cid:21)Iij
Yj=1 (cid:20)N (Rij |g(cid:0)(cid:2)Yi + PM
k=1 IikWk
(cid:3)T
Yi=1
PM
k=1 Iik
We regularize the latent similarity constraint matrix W by placing a zero-mean spherical Gaussian
prior on it:

p(R|Y , V , W, σ2 ) =

(8)

.

M
Yk=1
2 If no rating information is available about some user i, i.e. all entries of Ii vector are zero, the value of the
ratio in Eq. 7 is set to zero.

N (Wk |0, σ2
W

p(W |σW ) =

(9)

I).

4

10D

The Net ﬂix Dataset
0.97

30D

PMF1

SVD

Netflix 
Baseline Score

PMF2

PMFA1

10

20

30

40

50
Epochs

60

70

80

90

100

0.96

0.95

E
S
M
R

0.94

0.93

0.92

0.91

0.9
0

Constrained 
PMF
5

10

15

Netflix 
Baseline Score

SVD

PMF

20

25

30
Epochs

35

40

45

50

55

60

0.97

0.96

0.95

E
S
M
R

0.94

0.93

0.92

0.91
0

Figure 2: Left panel: Performance of SVD, PMF and PMF with adaptive priors, using 10D feature vectors, on
the full Net ﬂix validation data. Right panel: Performance o f SVD, Probabilistic Matrix Factorization (PMF)
and constrained PMF, using 30D feature vectors, on the validation data. The y-axis displays RMSE (root mean
squared error), and the x-axis shows the number of epochs, or passes, through the entire training dataset.

1
2

+

(10)

E =

N
Xi=1
λY
2

As with the PMF model, maximizing the log-posterior is equivalent to minimizing the sum-of-
squared errors function with quadratic regularization terms:
M
Iij (cid:0)Rij − g(cid:0)(cid:2)Yi + PM
k=1 IikWk
(cid:3)T
Vj (cid:1)(cid:1)2
Xj=1
PM
k=1 Iik
N
M
M
λV
λW
Xi=1
Xj=1
Xk=1
k Vj k2
k Yi k2
F ro +
F ro +
2
2
with λY = σ2/σ2
V , and λW = σ2 /σ2
Y , λV = σ2 /σ2
W . We can then perform gradient descent in Y ,
V , and W to minimize the objective function given by Eq. 10. The training time for the constrained
PMF model scales linearly with the number of observations, which allows for a fast and simple
implementation. As we show in our experimental results section, this model performs considerably
better than a simple unconstrained PMF model, especially on infrequent users.

k Wk k2
F ro ,

5 Experimental Results

5.1 Description of the Net ﬂix Data

According to Netﬂix, the data were collected between Octobe r 1998 and December 2005 and repre-
sent the distribution of all ratings Netﬂix obtained during this period. The training dataset consists
of 100,480,507 ratings from 480,189 randomly-chosen, anonymous users on 17,770 movie titles.
As part of the training data, Netﬂix also provides validatio n data, containing 1,408,395 ratings. In
addition to the training and validation data, Netﬂix also pr ovides a test set containing 2,817,131
user/movie pairs with the ratings withheld. The pairs were selected from the most recent ratings for
a subset of the users in the training dataset. To reduce the unintentional over ﬁtting to the test set that
plagues many empirical comparisons in the machine learning literature, performance is assessed by
submitting predicted ratings to Netﬂix who then post the roo t mean squared error (RMSE) on an
unknown half of the test set. As a baseline, Netﬂix provided t he test score of its own system trained
on the same data, which is 0.9514.

To provide additional insight into the performance of different algorithms we created a smaller and
much more difﬁcult dataset from the Netﬂix data by randomly s
electing 50,000 users and 1850
movies. The toy dataset contains 1,082,982 training and 2,462 validation user/movie pairs. Over
50% of the users in the training dataset have less than 10 ratings.

5.2 Details of Training

To speed-up the training, instead of performing batch learning we subdivided the Netﬂix data into
mini-batches of size 100,000 (user/movie/rating triples), and updated the feature vectors after each

5

mini-batch. After trying various values for the learning rate and momentum and experimenting with
various values of D , we chose to use a learning rate of 0.005, and a momentum of 0.9, as this setting
of parameters worked well for all values of D we have tried.

5.3 Results for PMF with Adaptive Priors

To evaluate the performance of PMF models with adaptive priors we used models with 10D features.
This dimensionality was chosen in order to demonstrate that even when the dimensionality of fea-
tures is relatively low, SVD-like models can still over ﬁt an d that there are some performance gains
to be had by regularizing such models automatically. We compared an SVD model, two ﬁxed-prior
PMF models, and two PMF models with adaptive priors. The SVD model was trained to minimize
the sum-squared distance only to the observed entries of the target matrix. The feature vectors of
the SVD model were not regularized in any way. The two ﬁxed-pr ior PMF models differed in their
regularization parameters: one (PMF1) had λU = 0.01 and λV = 0.001, while the other (PMF2)
had λU = 0.001 and λV = 0.0001. The ﬁrst PMF model with adaptive priors (PMFA1) had Gaus-
sian priors with spherical covariance matrices on user and movie feature vectors, while the second
model (PMFA2) had diagonal covariance matrices. In both cases, the adaptive priors had adjustable
means. Prior parameters and noise covariances were updated after every 10 and 100 feature matrix
updates respectively. The models were compared based on the RMSE on the validation set.

The results of the comparison are shown on Figure 2 (left panel). Note that the curve for the PMF
model with spherical covariances is not shown since it is virtually identical to the curve for the model
with diagonal covariances. Comparing models based on the lowest RMSE achieved over the time of
training, we see that the SVD model does almost as well as the moderately regularized PMF model
(PMF2) (0.9258 vs. 0.9253) before over ﬁtting badly towards
the end of training. While PMF1
does not over ﬁt, it clearly under ﬁts since it reaches the RMS E of only 0.9430. The models with
adaptive priors clearly outperform the competing models, achieving the RMSE of 0.9197 (diagonal
covariances) and 0.9204 (spherical covariances). These results suggest that automatic regularization
through adaptive priors works well in practice. Moreover, our preliminary results for models with
higher-dimensional feature vectors suggest that the gap in performance due to the use of adaptive
priors is likely to grow as the dimensionality of feature vectors increases. While the use of diagonal
covariance matrices did not lead to a signiﬁcant improvemen t over the spherical covariance matrices,
diagonal covariances might be well-suited for automatically regularizing the greedy version of the
PMF training algorithm, where feature vectors are learned one dimension at a time.

5.4 Results for Constrained PMF

For experiments involving constrained PMF models, we used 30D features (D = 30), since this
choice resulted in the best model performance on the validation set. Values of D in the range of
[20, 60] produce similar results. Performance results of SVD, PMF, and constrained PMF on the
toy dataset are shown on Figure 3. The feature vectors were initialized to the same values in all
three models. For both PMF and constrained PMF models the regularization parameters were set to
λU = λY = λV = λW = 0.002. It is clear that the simple SVD model over ﬁts heavily. The co n-
strained PMF model performs much better and converges considerably faster than the unconstrained
PMF model. Figure 3 (right panel) shows the effect of constraining user-speciﬁc features on the
predictions for infrequent users. Performance of the PMF model for a group of users that have fewer
than 5 ratings in the training datasets is virtually identical to that of the movie average algorithm that
always predicts the average rating of each movie. The constrained PMF model, however, performs
considerably better on users with few ratings. As the number of ratings increases, both PMF and
constrained PMF exhibit similar performance.

One other interesting aspect of the constrained PMF model is that even if we know only what movies
the user has rated, but do not know the values of the ratings, the model can make better predictions
than the movie average model. For the toy dataset, we randomly sampled an additional 50,000 users,
and for each of the users compiled a list of movies the user has rated and then discarded the actual
ratings. The constrained PMF model achieved a RMSE of 1.0510 on the validation set compared
to a RMSE of 1.0726 for the simple movie average model. This experiment strongly suggests that
knowing only which movies a user rated, but not the actual ratings, can still help us to model that
user’s preferences better.

6

E
S
M
R

1.3
1.28
1.26
1.24
1.22
1.2
1.18
1.16
1.14
1.12
1.1
1.08
1.06
1.04
1.02
1
0

Constrained 
PMF
20

40

Toy Dataset

1.2

1.15

1.1

1.05

1

0.95

0.9

0.85

E
S
M
R

SVD

PMF

Movie Average

PMF

Constrained 
PMF

60

80

100
Epochs

120

140

160

180

200

0.8
   1−5   

   6−10  

  11−20  
 81−160  
  41−80  
  21−40  
Number of Observed Ratings

  >161   

Figure 3: Left panel: Performance of SVD, Probabilistic Matrix Factorization (PMF) and constrained PMF on
the validation data. The y-axis displays RMSE (root mean squared error), and the x-axis shows the number of
epochs, or passes, through the entire training dataset. Right panel: Performance of constrained PMF, PMF, and
the movie average algorithm that always predicts the average rating of each movie. The users were grouped by
the number of observed ratings in the training data.

1.2

1.15

1.1

1.05

1

0.95

0.9

0.85

E
S
M
R

Movie 
Average

PMF

Constrained 
PMF

20

18

16

14

12

10

8

6

4

2

)
%
(
 
s
r
e
s
U

0.92

0.918

0.916

0.914

0.912

0.91

0.908

0.906

0.904

0.902

E
S
M
R

Constrained 
PMF

Constrained PMF 
(using Test rated/unrated id)

0.8
   1−5   

   6−10  

  11−20  
  41−80     81−160   161−320   321−640    >641   
  21−40  
Number of Observed Ratings

0
   1−5   

   6−10  

  11−20  
  41−80     81−160   161−320   321−640    >641   
  21−40  
Number of Observed Ratings

0.9
0

5

10

15

20

25

30
Epochs

35

40

45

50

55

60

Figure 4: Left panel: Performance of constrained PMF, PMF, and the movie average algorithm that always
predicts the average rating of each movie. The users were grouped by the number of observed rating in the train-
ing data, with the x-axis showing those groups, and the y-axis displaying RMSE on the full Net ﬂix validation
data for each such group. Middle panel: Distribution of users in the training dataset. Right panel: Performance
of constrained PMF and constrained PMF that makes use of an additional rated/unrated information obtained
from the test dataset.

Performance results on the full Netﬂix dataset are similar t o the results on the toy dataset. For both
the PMF and constrained PMF models the regularization parameters were set to λU = λY = λV =
λW = 0.001. Figure 2 (right panel) shows that constrained PMF signiﬁca ntly outperforms the
unconstrained PMF model, achieving a RMSE of 0.9016. A simple SVD achieves a RMSE of about
0.9280 and after about 10 epochs begins to over ﬁt. Figure 4 (l eft panel) shows that the constrained
PMF model is able to generalize considerably better for users with very few ratings. Note that over
10% of users in the training dataset have fewer than 20 ratings. As the number of ratings increases,
the effect from the offset in Eq. 7 diminishes, and both PMF and constrained PMF achieve similar
performance.

There is a more subtle source of information in the Netﬂix dat aset. Netﬂix tells us in advance which
user/movie pairs occur in the test set, so we have an additional category: movies that were viewed
but for which the rating is unknown. This is a valuable source of information about users who occur
several times in the test set, especially if they have only a small number of ratings in the training set.
The constrained PMF model can easily take this information into account. Figure 4 (right panel)
shows that this additional source of information further improves model performance.

When we linearly combine the predictions of PMF, PMF with a learnable prior, and constrained
PMF, we achieve an error rate of 0.8970 on the test set. When the predictions of multiple PMF
models are linearly combined with the predictions of multiple RBM models, recently introduced
by [8], we achieve an error rate of 0.8861, that is nearly 7% better than the score of Netﬂix’s own
system.

7

6 Summary and Discussion

In this paper we presented Probabilistic Matrix Factorization (PMF) and its two derivatives: PMF
with a learnable prior and constrained PMF. We also demonstrated that these models can be efﬁ-
ciently trained and successfully applied to a large dataset containing over 100 million movie ratings.

Efﬁciency in training PMF models comes from ﬁnding only poin
t estimates of model parameters
and hyperparameters, instead of inferring the full posterior distribution over them. If we were to
take a fully Bayesian approach, we would put hyperpriors over the hyperparameters and resort to
MCMC methods [5] to perform inference. While this approach is computationally more expensive,
preliminary results strongly suggest that a fully Bayesian treatment of the presented PMF models
would lead to a signiﬁcant increase in predictive accuracy.

Acknowledgments

We thank Vinod Nair and Geoffrey Hinton for many helpful discussions. This research was sup-
ported by NSERC.

References

[1] Delbert Dueck and Brendan Frey. Probabilistic sparse matrix factorization. Technical Report PSI TR
2004-023, Dept. of Computer Science, University of Toronto, 2004.
[2] Thomas Hofmann. Probabilistic latent semantic analysis.
In Proceedings of the 15th Conference on
Uncertainty in AI, pages 289–296, San Fransisco, California, 1999. Morgan Ka ufmann.
[3] Benjamin Marlin. Modeling user rating proﬁles for colla borative ﬁltering.
In Sebastian Thrun,
Lawrence K. Saul, and Bernhard Sch ¨olkopf, editors, NIPS. MIT Press, 2003.
[4] Benjamin Marlin and Richard S. Zemel. The multiple multiplicative factor model for collaborative ﬁlter-
ing. In Machine Learning, Proceedings of the Twenty- ﬁrst Internat ional Conference (ICML 2004), Banff,
Alberta, Canada, July 4-8, 2004. ACM, 2004.
[5] Radford M. Neal. Probabilistic inference using Markov chain Monte Carlo methods. Technical Report
CRG-TR-93-1, Department of Computer Science, University of Toronto, September 1993.
[6] S. J. Nowlan and G. E. Hinton. Simplifying neural networks by soft weight-sharing. Neural Computation,
4:473–493, 1992.
[7] Jason D. M. Rennie and Nathan Srebro. Fast maximum margin matrix factorization for collaborative
prediction. In Luc De Raedt and Stefan Wrobel, editors, Machine Learning, Proceedings of the Twenty-
Second International Conference (ICML 2005), Bonn, Germany, August 7-11, 2005, pages 713–719.
ACM, 2005.
[8] Ruslan Salakhutdinov, Andriy Mnih, and Geoffrey Hinton. Restricted Boltzmann machines for collabo-
rative ﬁltering. In Machine Learning, Proceedings of the Twenty-fourth International Conference (ICML
2004). ACM, 2007.
[9] Nathan Srebro and Tommi Jaakkola. Weighted low-rank approximations.
In Tom Fawcett and Nina
Mishra, editors, Machine Learning, Proceedings of the Twentieth International Conference (ICML 2003),
August 21-24, 2003, Washington, DC, USA, pages 720–727. AAAI Press, 2003.
[10] Nathan Srebro, Jason D. M. Rennie, and Tommi Jaakkola. Maximum-margin matrix factorization. In
Advances in Neural Information Processing Systems, 2004.
[11] Michael E. Tipping and Christopher M. Bishop. Probabilistic principal component analysis. Technical
Report NCRG/97/010, Neural Computing Research Group, Aston University, September 1997.
[12] Max Welling, Michal Rosen-Zvi, and Geoffrey Hinton. Exponential family harmoniums with an applica-
tion to information retrieval. In NIPS 17, pages 1481–1488, Cambridge, MA, 2005. MIT Press.

8

